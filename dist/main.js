(()=>{"use strict";const e=e=>{let t={};return t.length=e,t.hitCount=0,t.sunk=!1,t.orientation="horizontal",t.comp=[],t.hitCoor=[],{getShip:()=>t,hit:()=>{t.hitCount+=1,t.hitCount===t.length&&(t.sunk=!0)},isSunk:()=>!0===t.sunk}},t=()=>{let t=[],r=[],o={l_ship:e(4),m_ship_I:e(3),m_ship_II:e(3),s_ship_I:e(2),s_ship_II:e(2),s_ship_III:e(2),xs_ship_I:e(1),xs_ship_II:e(1),xs_ship_III:e(1),xs_ship_IV:e(1)};const n=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],n=e[1],null!==t[o][n]))return r=!1;var o,n})),r},l=(e,t,r)=>{const o=r.getShip().length;let n=[],l=e,a=t;if("horizontal"===r.getShip().orientation)for(;a!==t+o;)n.push([e,a]),a+=1;else for(;l!==e+o;)n.push([l,t]),l+=1;return n},a=(e,r,o)=>{let a=[],s=!0;return r+length-1>9||e>9||e+length-1>9||r>9?console.log("error"):(a=l(e,r,o),s=n(a),!1===s?(s=!0,a=[],console.log("not empty")):(o.getShip().comp=a,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:a,getBoard:()=>t,getShips:()=>o,receiveAttack:(e,o)=>(null===t[e][o]?r.push([e,o]):(t[e][o].hit(),t[e][o].getShip().hitCoor.push([e,o])),t),getMisses:()=>r,isAllSunk:()=>{const e=Object.values(o);let t=!1;return e.forEach((e=>{if(!1===e.getShip().sunk)return t=!1;t=!0})),t},populateBd:()=>{const e=Object.keys(o),r=["horizontal","vertical"];return e.forEach((e=>{const t=o[e],s=t.getShip().length;let c=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),i=Math.floor(2*Math.random());t.getShip().orientation=r[i];let d=l(c,u,t),h=n(d);for(;u+s-1>9||c+s-1>9||!1===h;)c=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),i=Math.floor(2*Math.random()),t.getShip().orientation=r[i],d=l(c,u,t),h=n(d);a(c,u,t)})),t}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,n)=>{const l=e.board.getMisses();null===t?l.find((e=>e[0]===o&&e[1]===n))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===n))&&r.setAttribute("style","background-color: red;")},n=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const n=o[0][0],l=o[0][1];e.board.placeShip(n,l,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let n=document.getElementById(`board${r}`);for(;n.lastElementChild;)n.removeChild(n.lastElementChild);for(let e=0;e<t.length;e++)for(let l=0;l<t.length;l++){const a=document.createElement("div");a.classList.add(`${r}-square`),a.setAttribute("data-x",`${e}`),a.setAttribute("data-y",`${l}`),o(t[e][l],a),n.appendChild(a)}return n},l=e=>{const t=e.board.getShips(),r=Object.keys(t),o=document.querySelector(`#player${e.number}-ships`);return r.forEach((e=>{const t=document.createElement("option");t.textContent=e,o.appendChild(t)})),o},a=e=>{document.querySelector(`#placeShipBtn-${e.number}`).addEventListener("click",(t=>{t.preventDefault();const r=parseInt(document.querySelector(`#player${e.number}-y`).value),o=parseInt(document.querySelector(`#player${e.number}-x`).value),l=document.querySelector(`#player${e.number}-ships`).value,a=document.querySelector(`#player${e.number}-orient`).value,s=e.board.getShips()[l];s.getShip().orientation=a,console.log(a),e.board.placeShip(r,o,s),n(e)}))},s=e=>{const t=document.querySelector("main"),r=document.querySelector(`#player${e.number}-finBtn`),o=document.querySelector(`#player${e.number}-form`),n=e.board.getShips(),l=Object.values(n);let a=!1;r.addEventListener("click",(r=>{r.preventDefault();const n=t.getAttribute("class");l.forEach((e=>{const t=e.getShip().comp;return a=0!==t.length})),a?o.setAttribute("style","display: none;"):console.log("Please place all the ships first"),c(e),("pvc"===n||"Two"===e.number)&&document.querySelector(".dialog").showModal()}))},c=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},u=(e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),l=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(a=>{a.preventDefault();let s=l.getAttribute("data-id");if("player-Two"===s)return n(e),i(t),l.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===s){const a=r.getAttribute("class");return l.setAttribute("data-id",`player-${t.number}`),console.log(a),"pvc"===a?(h(e,t),o.close()):(n(t),i(e),o.close())}}))},i=e=>{const t=e.board.getBoard(),r=e.board.getMisses(),o=document.querySelector(`#board${e.number}`);for(;o.lastElementChild;)o.removeChild(o.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const a=t[n][l],s=document.createElement("button");s.classList.add(`${e.number}-square`),s.setAttribute("data-x",`${n}`),s.setAttribute("data-y",`${l}`),d(e,s),null!==a&&a.getShip().hitCount>0&&a.getShip().hitCoor.find((e=>e[0]===n&&e[1]===l))&&(s.setAttribute("style","background-color: red;"),s.setAttribute("disabled","")),r.find((e=>e[0]===n&&e[1]===l))&&(s.setAttribute("style","background-color: green;"),s.setAttribute("disabled","")),o.appendChild(s)}},d=(e,t)=>{const r=e.board,o=r.getBoard(),n=document.querySelector(".dialog"),l=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));t.addEventListener("click",(s=>{s.preventDefault(),r.receiveAttack(l,a),null===o[l][a]?(c(e),t.setAttribute("style","background-color: red;"),n.showModal()):t.setAttribute("style","background-color: green;")}))},h=(e,t)=>{const r=e.board,o=r.getBoard(),l=document.querySelector("#play-window");let a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),c=!0;for(;!0===c;)r.receiveAttack(a,s),null===o[a][s]?(l.setAttribute("data-id",`player-${e.number}`),n(e),i(t),c=!1):(console.log("continuing"),a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()))},p=document.querySelector(".game_mode"),m=document.querySelector("#pvp"),b=document.querySelector("#pvc"),g=r("One"),y=r("Two");m.addEventListener("click",(e=>(e.preventDefault(),n(g),n(y),l(g),l(y),a(g),a(y),s(g),s(y),u(g,y),p.close()))),b.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#playerTwo-form");var o;return n(g),n(y),l(g),a(g),s(g),s(y),u(g,y),(o=y).board.populateBd(),n(o),r.setAttribute("style","display: none;"),t.classList.add("pvc"),p.close()})),document.addEventListener("onload",p.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c0MsRUFBWWxFLEVBQU8sT0FDbkJtRSxFQUFZbkUsRUFBTyxPQUV6QmdFLEVBQU9oQyxpQkFBaUIsU0FBVUMsSUFDaENBLEVBQUVDLGlCQUNGeEIsRUFBWXdELEdBQ1p4RCxFQUFZeUQsR0FFWnpDLEVBQWdCd0MsR0FDaEJ4QyxFQUFnQnlDLEdBRWhCcEMsRUFBY21DLEdBQ2RuQyxFQUFjb0MsR0FFZDVCLEVBQWEyQixHQUNiM0IsRUFBYTRCLEdBRWJsQixFQUFZaUIsRUFBV0MsR0FFaEJKLEVBQVNSLFdBR2xCVSxFQUFPakMsaUJBQWlCLFNBQVVDLElBQ2hDQSxFQUFFQyxpQkFFRixNQUFNTSxFQUFPdkIsU0FBU1csY0FBYyxRQUM5QmMsRUFBT3pCLFNBQVNXLGNBQWMsbUJEb05yQixJQUFDdkIsRUNyTWhCLE9BYkFLLEVBQVl3RCxHQUNaeEQsRUFBWXlELEdBQ1p6QyxFQUFnQndDLEdBQ2hCbkMsRUFBY21DLEdBQ2QzQixFQUFhMkIsR0FDYjNCLEVBQWE0QixHQUNibEIsRUFBWWlCLEVBQVdDLElENE1QOUQsRUMxTVA4RCxHRDJNRnZILE1BQU0yQyxhQUNibUIsRUFBWUwsR0MxTVpxQyxFQUFLakMsYUFBYSxRQUFTLGtCQUMzQitCLEVBQUtqQixVQUFVQyxJQUFJLE9BRVp1QyxFQUFTUixPQUFPLElBR3pCdEMsU0FBU2UsaUJBQWlCLFNBQVUrQixFQUFTaEIsWSIsInNvdXJjZXMiOlsid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9ET00uanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IChuKSA9PiB7XG4gIGxldCBzaGlwT2JqID0ge307XG5cbiAgc2hpcE9ialtcImxlbmd0aFwiXSA9IG47XG4gIHNoaXBPYmpbXCJoaXRDb3VudFwiXSA9IDA7XG4gIHNoaXBPYmpbXCJzdW5rXCJdID0gZmFsc2U7XG4gIHNoaXBPYmpbXCJvcmllbnRhdGlvblwiXSA9IFwiaG9yaXpvbnRhbFwiO1xuICBzaGlwT2JqW1wiY29tcFwiXSA9IFtdO1xuICBzaGlwT2JqW1wiaGl0Q29vclwiXSA9IFtdO1xuXG4gIGNvbnN0IGdldFNoaXAgPSAoKSA9PiBzaGlwT2JqO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBzaGlwT2JqLmhpdENvdW50ICs9IDE7XG4gICAgaWYgKHNoaXBPYmouaGl0Q291bnQgPT09IHNoaXBPYmoubGVuZ3RoKSBzaGlwT2JqLnN1bmsgPSB0cnVlO1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gc2hpcE9iai5zdW5rID09PSB0cnVlID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgZ2V0U2hpcCxcbiAgICBoaXQsXG4gICAgaXNTdW5rLFxuICB9O1xufTtcblxuZXhwb3J0IHsgU2hpcCB9O1xuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcblxuY29uc3QgR2FtZWJvYXJkID0gKCkgPT4ge1xuICBsZXQgYm9hcmQgPSBbXTtcbiAgbGV0IG1pc3NlcyA9IFtdO1xuXG4gIGxldCBhbGxTaGlwcyA9IHtcbiAgICBsX3NoaXA6IFNoaXAoNCksXG4gICAgbV9zaGlwX0k6IFNoaXAoMyksXG4gICAgbV9zaGlwX0lJOiBTaGlwKDMpLFxuICAgIHNfc2hpcF9JOiBTaGlwKDIpLFxuICAgIHNfc2hpcF9JSTogU2hpcCgyKSxcbiAgICBzX3NoaXBfSUlJOiBTaGlwKDIpLFxuICAgIHhzX3NoaXBfSTogU2hpcCgxKSxcbiAgICB4c19zaGlwX0lJOiBTaGlwKDEpLFxuICAgIHhzX3NoaXBfSUlJOiBTaGlwKDEpLFxuICAgIHhzX3NoaXBfSVY6IFNoaXAoMSksXG4gIH07XG5cbiAgY29uc3QgZ2V0Qm9hcmQgPSAoKSA9PiBib2FyZDtcbiAgY29uc3QgZ2V0TWlzc2VzID0gKCkgPT4gbWlzc2VzO1xuICBjb25zdCBnZXRTaGlwcyA9ICgpID0+IGFsbFNoaXBzO1xuXG4gIGNvbnN0IGNyZWF0ZUJvYXJkID0gKCkgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgYm9hcmRbaV0gPSBbXTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBib2FyZFtpXVtqXSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IGlzRW1wdHkgPSAoeCwgeSkgPT4ge1xuICAgIHJldHVybiBib2FyZFt4XVt5XSA9PT0gbnVsbCA/IHRydWUgOiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBpc0ZpdCA9IChhcnIpID0+IHtcbiAgICBsZXQgc3RhdHVzID0gdHJ1ZTtcblxuICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpZiAoaXRlbVswXSA+IDkgfHwgaXRlbVsxXSA+IDkgfHwgIWlzRW1wdHkoaXRlbVswXSwgaXRlbVsxXSkpXG4gICAgICAgIHJldHVybiAoc3RhdHVzID0gZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXR1cztcbiAgfTtcblxuICBjb25zdCBjcmVhdGVDb21wID0gKHgsIHksIHNoaXApID0+IHtcbiAgICBjb25zdCBsZW5ndGggPSBzaGlwLmdldFNoaXAoKS5sZW5ndGg7XG4gICAgY29uc3Qgb3JpZW50YXRpb24gPSBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbjtcbiAgICBsZXQgdGVtcCA9IFtdO1xuICAgIGxldCBhID0geDtcbiAgICBsZXQgYiA9IHk7XG5cbiAgICBpZiAob3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICB3aGlsZSAoYiAhPT0geSArIGxlbmd0aCkge1xuICAgICAgICB0ZW1wLnB1c2goW3gsIGJdKTtcbiAgICAgICAgYiArPSAxO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB3aGlsZSAoYSAhPT0geCArIGxlbmd0aCkge1xuICAgICAgICB0ZW1wLnB1c2goW2EsIHldKTtcbiAgICAgICAgYSArPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0ZW1wO1xuICB9O1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9ICh4LCB5LCBzaGlwKSA9PiB7XG4gICAgbGV0IHRlbXAgPSBbXTtcbiAgICBsZXQgc3RhdHVzID0gdHJ1ZTtcblxuICAgIGlmICh5ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeCA+IDkgfHwgeCArIGxlbmd0aCAtIDEgPiA5IHx8IHkgPiA5KSB7XG4gICAgICByZXR1cm4gY29uc29sZS5sb2coXCJlcnJvclwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICBzdGF0dXMgPSBpc0ZpdCh0ZW1wKTtcbiAgICB9XG5cbiAgICBpZiAoc3RhdHVzID09PSBmYWxzZSkge1xuICAgICAgc3RhdHVzID0gdHJ1ZTtcbiAgICAgIHRlbXAgPSBbXTtcbiAgICAgIHJldHVybiBjb25zb2xlLmxvZyhcIm5vdCBlbXB0eVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hpcC5nZXRTaGlwKCkuY29tcCA9IHRlbXA7XG5cbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBib2FyZFtpdGVtWzBdXVtpdGVtWzFdXSA9IHNoaXA7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgcG9wdWxhdGVCZCA9ICgpID0+IHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoYWxsU2hpcHMpO1xuICAgIGNvbnN0IGRpcmVjdGlvbnMgPSBbXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIl07XG5cbiAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgY29uc3Qgc2hpcCA9IGFsbFNoaXBzW2tleV07XG4gICAgICBjb25zdCBsZW5ndGggPSBzaGlwLmdldFNoaXAoKS5sZW5ndGg7XG5cbiAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBsZXQgeiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICBsZXQgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICBsZXQgZml0ID0gaXNGaXQodGVtcCk7XG5cbiAgICAgIHdoaWxlICh5ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeCArIGxlbmd0aCAtIDEgPiA5IHx8IGZpdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gZGlyZWN0aW9uc1t6XTtcbiAgICAgICAgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICAgIGZpdCA9IGlzRml0KHRlbXApO1xuICAgICAgfVxuXG4gICAgICBwbGFjZVNoaXAoeCwgeSwgc2hpcCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9ICh4LCB5KSA9PiB7XG4gICAgaWYgKGJvYXJkW3hdW3ldID09PSBudWxsKSBtaXNzZXMucHVzaChbeCwgeV0pO1xuICAgIGVsc2Uge1xuICAgICAgYm9hcmRbeF1beV0uaGl0KCk7XG4gICAgICBib2FyZFt4XVt5XS5nZXRTaGlwKCkuaGl0Q29vci5wdXNoKFt4LCB5XSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IGlzQWxsU3VuayA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoYWxsU2hpcHMpO1xuICAgIGxldCBzdGF0dXMgPSBmYWxzZTtcblxuICAgIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGlmIChzaGlwLmdldFNoaXAoKS5zdW5rID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICAgIH0gZWxzZSBzdGF0dXMgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXR1cztcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGNyZWF0ZUJvYXJkLFxuICAgIHBsYWNlU2hpcCxcbiAgICBnZXRCb2FyZCxcbiAgICBnZXRTaGlwcyxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGdldE1pc3NlcyxcbiAgICBpc0FsbFN1bmssXG4gICAgcG9wdWxhdGVCZCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWVib2FyZCB9O1xuIiwiaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmNvbnN0IFBsYXllciA9IChudW1iZXIpID0+IHtcbiAgbGV0IHdpbiA9IGZhbHNlO1xuICBsZXQgYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgbGV0IGlzQ29tcCA9IGZhbHNlO1xuXG4gIHJldHVybiB7XG4gICAgbnVtYmVyLFxuICAgIHdpbixcbiAgICBib2FyZCxcbiAgICBpc0NvbXAsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImNvbnN0IGZpbGxTcXIgPSAocGxheWVyLCBzcXIsIHRhZywgeCwgeSkgPT4ge1xuICBjb25zdCBtaXNzZXMgPSBwbGF5ZXIuYm9hcmQuZ2V0TWlzc2VzKCk7XG5cbiAgaWYgKHNxciA9PT0gbnVsbCkge1xuICAgIGlmIChcbiAgICAgIG1pc3Nlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KVxuICAgICkge1xuICAgICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogeWVsbG93O1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogYmx1ZTtcIik7XG4gICAgfVxuICB9IGVsc2UgaWYgKFxuICAgIHNxci5nZXRTaGlwKCkuaGl0Q29vci5maW5kKChpdGVtKSA9PiB7XG4gICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgIH0pXG4gICkge1xuICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG4gIH1cbn07XG5cbmNvbnN0IHJlbmRlclNoaXAgPSAocGxheWVyKSA9PiB7XG4gIGxldCBib2FyZCA9IHBsYXllci5ib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBzaGlwc09iaiA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpO1xuICBjb25zdCBzaGlwc0xpc3QgPSBPYmplY3Qua2V5cyhzaGlwc09iaik7XG5cbiAgc2hpcHNMaXN0LmZvckVhY2goKHNoaXApID0+IHtcbiAgICBjb25zdCBjb21wID0gc2hpcHNPYmpbc2hpcF0uZ2V0U2hpcCgpLmNvbXA7XG5cbiAgICBpZiAoY29tcC5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnN0IHhDb29yID0gY29tcFswXVswXTtcbiAgICAgIGNvbnN0IHlDb29yID0gY29tcFswXVsxXTtcbiAgICAgIHBsYXllci5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwc09ialtzaGlwXSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gYm9hcmQ7XG59O1xuXG5jb25zdCByZW5kZXJCb2FyZCA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLmNyZWF0ZUJvYXJkKCk7XG5cbiAgcmVuZGVyU2hpcChwbGF5ZXIpO1xuXG4gIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHBsYXllck51bSA9IHBsYXllci5udW1iZXI7XG4gIGxldCBjdXJyZW50Qm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgYm9hcmQke3BsYXllck51bX1gKTtcblxuICB3aGlsZSAoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpXG4gICAgY3VycmVudEJvYXJkLnJlbW92ZUNoaWxkKGN1cnJlbnRCb2FyZC5sYXN0RWxlbWVudENoaWxkKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBib2FyZC5sZW5ndGg7IGorKykge1xuICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BsYXllck51bX0tc3F1YXJlYCk7XG5cbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIiwgYCR7aX1gKTtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIiwgYCR7an1gKTtcblxuICAgICAgZmlsbFNxcihib2FyZFtpXVtqXSwgc3F1YXJlKTtcblxuICAgICAgY3VycmVudEJvYXJkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRCb2FyZDtcbn07XG5cbmNvbnN0IGdyYWJQbGF5ZXJTaGlwcyA9IChwbGF5ZXIpID0+IHtcbiAgY29uc3Qgc2hpcHNPYmogPSBwbGF5ZXIuYm9hcmQuZ2V0U2hpcHMoKTtcbiAgY29uc3Qgc2hpcHMgPSBPYmplY3Qua2V5cyhzaGlwc09iaik7XG4gIGNvbnN0IHNlbGVjdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXNoaXBzYCk7XG5cbiAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gICAgb3B0aW9uLnRleHRDb250ZW50ID0gc2hpcDtcbiAgICBzZWxlY3Rpb24uYXBwZW5kQ2hpbGQob3B0aW9uKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHNlbGVjdGlvbjtcbn07XG5cbmNvbnN0IGluaXRQbGFjZVNoaXAgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGFjZVNoaXBCdG4tJHtwbGF5ZXIubnVtYmVyfWApO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCB4Q29vciA9IHBhcnNlSW50KFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllciR7cGxheWVyLm51bWJlcn0teWApLnZhbHVlXG4gICAgKTtcbiAgICBjb25zdCB5Q29vciA9IHBhcnNlSW50KFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllciR7cGxheWVyLm51bWJlcn0teGApLnZhbHVlXG4gICAgKTtcbiAgICBjb25zdCBzaGlwTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgI3BsYXllciR7cGxheWVyLm51bWJlcn0tc2hpcHNgXG4gICAgKS52YWx1ZTtcblxuICAgIGNvbnN0IG9yaWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgI3BsYXllciR7cGxheWVyLm51bWJlcn0tb3JpZW50YFxuICAgICkudmFsdWU7XG5cbiAgICBjb25zdCBzaGlwID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKClbc2hpcE5hbWVdO1xuXG4gICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBvcmllbnQ7XG4gICAgY29uc29sZS5sb2cob3JpZW50KTtcblxuICAgIHBsYXllci5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwKTtcbiAgICByZW5kZXJCb2FyZChwbGF5ZXIpO1xuICB9KTtcbn07XG5cbmNvbnN0IGluaXRGaW5TZXR1cCA9IChwbGF5ZXIpID0+IHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS1maW5CdG5gKTtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LWZvcm1gKTtcbiAgY29uc3Qgc2hpcHNPYmogPSBwbGF5ZXIuYm9hcmQuZ2V0U2hpcHMoKTtcbiAgY29uc3Qgc2hpcHMgPSBPYmplY3QudmFsdWVzKHNoaXBzT2JqKTtcbiAgbGV0IGlzQWxsUGxhY2VkID0gZmFsc2U7XG5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuXG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgY29uc3QgY29tcCA9IHNoaXAuZ2V0U2hpcCgpLmNvbXA7XG4gICAgICBpZiAoY29tcC5sZW5ndGggPT09IDApIHJldHVybiAoaXNBbGxQbGFjZWQgPSBmYWxzZSk7XG4gICAgICBlbHNlIHJldHVybiAoaXNBbGxQbGFjZWQgPSB0cnVlKTtcbiAgICB9KTtcblxuICAgIGlzQWxsUGxhY2VkXG4gICAgICA/IGZvcm0uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lO1wiKVxuICAgICAgOiBjb25zb2xlLmxvZyhcIlBsZWFzZSBwbGFjZSBhbGwgdGhlIHNoaXBzIGZpcnN0XCIpO1xuXG4gICAgaGlkZUJvYXJkKHBsYXllcik7XG5cbiAgICBpZiAobW9kZSA9PT0gXCJwdmNcIiB8fCBwbGF5ZXIubnVtYmVyID09PSBcIlR3b1wiKSB7XG4gICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgaGlkZUJvYXJkID0gKHBsYXllcikgPT4ge1xuICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke3BsYXllci5udW1iZXJ9LXNxdWFyZWApO1xuXG4gIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyYXk7XCIpO1xuICB9KTtcbn07XG5cbmNvbnN0IGluaXRwbGF5QnRuID0gKFBPbmUsIFBUd28pID0+IHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXlcIik7XG5cbiAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IHBsYXllciA9IHBsYXlXaW5kb3cuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcblxuICAgIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgICByZW5kZXJCb2FyZChQT25lKTtcbiAgICAgIHJlbmRlclBsYXlCZChQVHdvKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UE9uZS5udW1iZXJ9YCk7XG4gICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgfSBlbHNlIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UFR3by5udW1iZXJ9YCk7XG4gICAgICBjb25zb2xlLmxvZyhtb2RlKTtcbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICAgIGF1dG9BdGsoUE9uZSwgUFR3byk7XG4gICAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbmRlckJvYXJkKFBUd28pO1xuICAgICAgICByZW5kZXJQbGF5QmQoUE9uZSk7XG4gICAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgcmVuZGVyUGxheUJkID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBib2FyZCA9IHBsYXllci5ib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBtaXNzZXMgPSBwbGF5ZXIuYm9hcmQuZ2V0TWlzc2VzKCk7XG4gIGNvbnN0IGN1cnJCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNib2FyZCR7cGxheWVyLm51bWJlcn1gKTtcblxuICB3aGlsZSAoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpXG4gICAgY3VyckJvYXJkLnJlbW92ZUNoaWxkKGN1cnJCb2FyZC5sYXN0RWxlbWVudENoaWxkKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBib2FyZC5sZW5ndGg7IGorKykge1xuICAgICAgY29uc3QgaXRlbSA9IGJvYXJkW2ldW2pdO1xuXG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyLm51bWJlcn0tc3F1YXJlYCk7XG5cbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIiwgYCR7aX1gKTtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIiwgYCR7an1gKTtcblxuICAgICAgaW5pdFNxckJ0bihwbGF5ZXIsIHNxdWFyZSk7XG5cbiAgICAgIGlmIChcbiAgICAgICAgaXRlbSAhPT0gbnVsbCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb3VudCA+IDAgJiZcbiAgICAgICAgaXRlbS5nZXRTaGlwKCkuaGl0Q29vci5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IGkgJiYgaXRlbVsxXSA9PT0gajtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyZWVuO1wiKTtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgICAgfVxuXG4gICAgICBjdXJyQm9hcmQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGluaXRTcXJCdG4gPSAocGxheWVyLCBzcXVhcmUpID0+IHtcbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXIuYm9hcmQ7XG4gIGNvbnN0IGJvYXJkTGlzdCA9IGJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICBjb25zdCB4ID0gcGFyc2VJbnQoc3F1YXJlLmdldEF0dHJpYnV0ZShcImRhdGEteFwiKSk7XG4gIGNvbnN0IHkgPSBwYXJzZUludChzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS15XCIpKTtcblxuICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICBpZiAoYm9hcmRMaXN0W3hdW3ldID09PSBudWxsKSB7XG4gICAgICBoaWRlQm9hcmQocGxheWVyKTtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG4gICAgICBkaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyZWVuO1wiKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgY29tcE1vZGUgPSAocGxheWVyKSA9PiB7XG4gIHBsYXllci5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gIHJlbmRlckJvYXJkKHBsYXllcik7XG59O1xuXG5jb25zdCBhdXRvQXRrID0gKHBsYXlPbmUsIHBsYXlUd28pID0+IHtcbiAgY29uc3QgYm9hcmQgPSBwbGF5T25lLmJvYXJkO1xuICBjb25zdCBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBwbGF5V2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICBsZXQgY29udCA9IHRydWU7XG5cbiAgd2hpbGUgKGNvbnQgPT09IHRydWUpIHtcbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuXG4gICAgaWYgKGJvYXJkTGlzdFt4XVt5XSA9PT0gbnVsbCkge1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtwbGF5T25lLm51bWJlcn1gKTtcbiAgICAgIHJlbmRlckJvYXJkKHBsYXlPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKHBsYXlUd28pO1xuICAgICAgY29udCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcImNvbnRpbnVpbmdcIik7XG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCB7XG4gIHJlbmRlckJvYXJkLFxuICBncmFiUGxheWVyU2hpcHMsXG4gIGluaXRQbGFjZVNoaXAsXG4gIGluaXRGaW5TZXR1cCxcbiAgaW5pdHBsYXlCdG4sXG4gIGNvbXBNb2RlLFxufTtcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IHtcbiAgcmVuZGVyQm9hcmQsXG4gIGdyYWJQbGF5ZXJTaGlwcyxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG59IGZyb20gXCIuL0RPTVwiO1xuXG5jb25zdCBnYW1lTW9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FtZV9tb2RlXCIpO1xuY29uc3QgcHZwQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwdnBcIik7XG5jb25zdCBwdmNCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3B2Y1wiKTtcbmNvbnN0IHBsYXllck9uZSA9IFBsYXllcihcIk9uZVwiKTtcbmNvbnN0IHBsYXllclR3byA9IFBsYXllcihcIlR3b1wiKTtcblxucHZwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gIHJlbmRlckJvYXJkKHBsYXllclR3byk7XG5cbiAgZ3JhYlBsYXllclNoaXBzKHBsYXllck9uZSk7XG4gIGdyYWJQbGF5ZXJTaGlwcyhwbGF5ZXJUd28pO1xuXG4gIGluaXRQbGFjZVNoaXAocGxheWVyT25lKTtcbiAgaW5pdFBsYWNlU2hpcChwbGF5ZXJUd28pO1xuXG4gIGluaXRGaW5TZXR1cChwbGF5ZXJPbmUpO1xuICBpbml0RmluU2V0dXAocGxheWVyVHdvKTtcblxuICBpbml0cGxheUJ0bihwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5cbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucHZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5ZXJUd28tZm9ybVwiKTtcblxuICByZW5kZXJCb2FyZChwbGF5ZXJPbmUpO1xuICByZW5kZXJCb2FyZChwbGF5ZXJUd28pO1xuICBncmFiUGxheWVyU2hpcHMocGxheWVyT25lKTtcbiAgaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUpO1xuICBpbml0RmluU2V0dXAocGxheWVyT25lKTtcbiAgaW5pdEZpblNldHVwKHBsYXllclR3byk7XG4gIGluaXRwbGF5QnRuKHBsYXllck9uZSwgcGxheWVyVHdvKTtcblxuICBjb21wTW9kZShwbGF5ZXJUd28pO1xuXG4gIGZvcm0uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lO1wiKTtcbiAgbWFpbi5jbGFzc0xpc3QuYWRkKFwicHZjXCIpO1xuXG4gIHJldHVybiBnYW1lTW9kZS5jbG9zZSgpO1xufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxvYWRcIiwgZ2FtZU1vZGUuc2hvd01vZGFsKCkpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJuIiwic2hpcE9iaiIsImdldFNoaXAiLCJoaXQiLCJoaXRDb3VudCIsImxlbmd0aCIsInN1bmsiLCJpc1N1bmsiLCJHYW1lYm9hcmQiLCJib2FyZCIsIm1pc3NlcyIsImFsbFNoaXBzIiwibF9zaGlwIiwibV9zaGlwX0kiLCJtX3NoaXBfSUkiLCJzX3NoaXBfSSIsInNfc2hpcF9JSSIsInNfc2hpcF9JSUkiLCJ4c19zaGlwX0kiLCJ4c19zaGlwX0lJIiwieHNfc2hpcF9JSUkiLCJ4c19zaGlwX0lWIiwiaXNGaXQiLCJhcnIiLCJzdGF0dXMiLCJmb3JFYWNoIiwiaXRlbSIsIngiLCJ5IiwiY3JlYXRlQ29tcCIsInNoaXAiLCJ0ZW1wIiwiYSIsImIiLCJvcmllbnRhdGlvbiIsInB1c2giLCJwbGFjZVNoaXAiLCJjb25zb2xlIiwibG9nIiwiY29tcCIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJnZXRCb2FyZCIsImdldFNoaXBzIiwicmVjZWl2ZUF0dGFjayIsImhpdENvb3IiLCJnZXRNaXNzZXMiLCJpc0FsbFN1bmsiLCJzaGlwcyIsIk9iamVjdCIsInZhbHVlcyIsInBvcHVsYXRlQmQiLCJrZXlzIiwiZGlyZWN0aW9ucyIsImtleSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInoiLCJmaXQiLCJQbGF5ZXIiLCJudW1iZXIiLCJ3aW4iLCJpc0NvbXAiLCJmaWxsU3FyIiwicGxheWVyIiwic3FyIiwidGFnIiwiZmluZCIsInNldEF0dHJpYnV0ZSIsInJlbmRlckJvYXJkIiwic2hpcHNPYmoiLCJ4Q29vciIsInlDb29yIiwicmVuZGVyU2hpcCIsInBsYXllck51bSIsImN1cnJlbnRCb2FyZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJsYXN0RWxlbWVudENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJzcXVhcmUiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJncmFiUGxheWVyU2hpcHMiLCJzZWxlY3Rpb24iLCJxdWVyeVNlbGVjdG9yIiwib3B0aW9uIiwidGV4dENvbnRlbnQiLCJpbml0UGxhY2VTaGlwIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInBhcnNlSW50IiwidmFsdWUiLCJzaGlwTmFtZSIsIm9yaWVudCIsImluaXRGaW5TZXR1cCIsIm1haW4iLCJidXR0b24iLCJmb3JtIiwiaXNBbGxQbGFjZWQiLCJtb2RlIiwiZ2V0QXR0cmlidXRlIiwiaGlkZUJvYXJkIiwic2hvd01vZGFsIiwicXVlcnlTZWxlY3RvckFsbCIsImluaXRwbGF5QnRuIiwiUE9uZSIsIlBUd28iLCJkaWFsb2ciLCJwbGF5V2luZG93IiwicmVuZGVyUGxheUJkIiwiY2xvc2UiLCJhdXRvQXRrIiwiY3VyckJvYXJkIiwiaW5pdFNxckJ0biIsImJvYXJkTGlzdCIsInBsYXlPbmUiLCJwbGF5VHdvIiwiY29udCIsImdhbWVNb2RlIiwicHZwQnRuIiwicHZjQnRuIiwicGxheWVyT25lIiwicGxheWVyVHdvIl0sInNvdXJjZVJvb3QiOiIifQ==