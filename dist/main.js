(()=>{"use strict";const e=e=>{let t={};return t.length=e,t.hitCount=0,t.sunk=!1,t.orientation="horizontal",t.comp=[],t.hitCoor=[],{getShip:()=>t,hit:()=>{t.hitCount+=1,t.hitCount===t.length&&(t.sunk=!0)},isSunk:()=>!0===t.sunk}},t=()=>{let t=[],r=[],o={l_ship:e(4),m_ship_I:e(3),m_ship_II:e(3),s_ship_I:e(2),s_ship_II:e(2),s_ship_III:e(2),xs_ship_I:e(1),xs_ship_II:e(1),xs_ship_III:e(1),xs_ship_IV:e(1)};const n=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],n=e[1],null!==t[o][n]))return r=!1;var o,n})),r},l=(e,t,r)=>{const o=r.getShip().length;let n=[],l=e,a=t;if("horizontal"===r.getShip().orientation)for(;a!==t+o;)n.push([e,a]),a+=1;else for(;l!==e+o;)n.push([l,t]),l+=1;return n},a=(e,r,o)=>{let a=[],s=!0;return r+length-1>9||e>9||e+length-1>9||r>9?console.log("error"):(a=l(e,r,o),s=n(a),!1===s?(s=!0,a=[],console.log("not empty")):(o.getShip().comp=a,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:a,getBoard:()=>t,getShips:()=>o,receiveAttack:(e,o)=>(null===t[e][o]?r.push([e,o]):(t[e][o].hit(),t[e][o].getShip().hitCoor.push([e,o])),t),getMisses:()=>r,isAllSunk:()=>{const e=Object.values(o);let t=!1;return e.forEach((e=>{if(!1===e.getShip().sunk)return t=!1;t=!0})),t},populateBd:()=>{const e=Object.keys(o),r=["horizontal","vertical"];return e.forEach((e=>{const t=o[e],s=t.getShip().length;let c=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),i=Math.floor(2*Math.random());t.getShip().orientation=r[i];let d=l(c,u,t),h=n(d);for(;u+s-1>9||c+s-1>9||!1===h;)c=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),i=Math.floor(2*Math.random()),t.getShip().orientation=r[i],d=l(c,u,t),h=n(d);a(c,u,t)})),t}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,n)=>{const l=e.board.getMisses();null===t?l.find((e=>e[0]===o&&e[1]===n))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===n))&&r.setAttribute("style","background-color: red;")},n=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const n=o[0][0],l=o[0][1];e.board.placeShip(n,l,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let n=document.getElementById(`board${r}`);for(;n.lastElementChild;)n.removeChild(n.lastElementChild);for(let e=0;e<t.length;e++)for(let l=0;l<t.length;l++){const a=document.createElement("div");a.classList.add(`${r}-square`),a.setAttribute("data-x",`${e}`),a.setAttribute("data-y",`${l}`),o(t[e][l],a),n.appendChild(a)}return n},l=e=>{const t=e.board.getShips(),r=Object.keys(t),o=document.querySelector(`#player${e.number}-ships`);return r.forEach((e=>{const t=document.createElement("option");t.textContent=e,o.appendChild(t)})),o},a=e=>{document.querySelector(`#placeShipBtn-${e.number}`).addEventListener("click",(t=>{t.preventDefault();const r=parseInt(document.querySelector(`#player${e.number}-y`).value),o=parseInt(document.querySelector(`#player${e.number}-x`).value),l=document.querySelector(`#player${e.number}-ships`).value,a=document.querySelector(`#player${e.number}-orient`).value,s=e.board.getShips()[l];s.getShip().orientation=a,console.log(a),e.board.placeShip(r,o,s),n(e)}))},s=e=>{const t=document.querySelector("main"),r=document.querySelector(`#player${e.number}-finBtn`),o=document.querySelector(`#player${e.number}-form`),n=e.board.getShips(),l=Object.values(n);let a=!1;r.addEventListener("click",(r=>{r.preventDefault();const n=t.getAttribute("class");l.forEach((e=>{const t=e.getShip().comp;return a=0!==t.length})),a?o.setAttribute("style","display: none;"):console.log("Please place all the ships first"),c(e),"pvc"===n&&document.querySelector(".dialog").showModal()}))},c=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},u=(e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),l=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(a=>{a.preventDefault();let s=l.getAttribute("data-id");if("player-Two"===s)return n(e),i(t),l.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===s){const a=r.getAttribute("class");return l.setAttribute("data-id",`player-${t.number}`),console.log(a),"pvc"===a?(h(e,t),o.close()):(n(t),i(e),o.close())}}))},i=e=>{const t=e.board.getBoard(),r=e.board.getMisses(),o=document.querySelector(`#board${e.number}`);for(;o.lastElementChild;)o.removeChild(o.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const a=t[n][l],s=document.createElement("button");s.classList.add(`${e.number}-square`),s.setAttribute("data-x",`${n}`),s.setAttribute("data-y",`${l}`),d(e,s),null!==a&&a.getShip().hitCount>0&&a.getShip().hitCoor.find((e=>e[0]===n&&e[1]===l))&&(s.setAttribute("style","background-color: red;"),s.setAttribute("disabled","")),r.find((e=>e[0]===n&&e[1]===l))&&(s.setAttribute("style","background-color: green;"),s.setAttribute("disabled","")),o.appendChild(s)}},d=(e,t)=>{const r=e.board,o=r.getBoard(),n=document.querySelector(".dialog"),l=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));t.addEventListener("click",(s=>{s.preventDefault(),r.receiveAttack(l,a),null===o[l][a]?(c(e),t.setAttribute("style","background-color: red;"),n.showModal()):t.setAttribute("style","background-color: green;")}))},h=(e,t)=>{const r=e.board,o=r.getBoard(),l=document.querySelector("#play-window");let a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),c=!0;for(;!0===c;)r.receiveAttack(a,s),null===o[a][s]?(l.setAttribute("data-id",`player-${e.number}`),n(e),i(t),c=!1):(console.log("continuing"),a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()))},p=document.querySelector(".game_mode"),m=document.querySelector("#pvp"),b=document.querySelector("#pvc"),g=r("One"),y=r("Two");m.addEventListener("click",(e=>(e.preventDefault(),n(g),n(y),l(g),l(y),a(g),a(y),s(g),s(y),u(g,y),p.close()))),b.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#playerTwo-form");var o;return n(g),n(y),l(g),a(g),s(g),s(y),u(g,y),(o=y).board.populateBd(),n(o),r.setAttribute("style","display: none;"),t.classList.add("pvc"),p.close()})),document.addEventListener("onload",p.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFBTUEsRUFBUUMsSUFDWixJQUFJQyxFQUFVLENBQUMsRUFvQmYsT0FsQkFBLEVBQWdCLE9BQUlELEVBQ3BCQyxFQUFrQixTQUFJLEVBQ3RCQSxFQUFjLE1BQUksRUFDbEJBLEVBQXFCLFlBQUksYUFDekJBLEVBQWMsS0FBSSxHQUNsQkEsRUFBaUIsUUFBSSxHQWFkLENBQ0xDLFFBWmMsSUFBTUQsRUFhcEJFLElBWFUsS0FDVkYsRUFBUUcsVUFBWSxFQUNoQkgsRUFBUUcsV0FBYUgsRUFBUUksU0FBUUosRUFBUUssTUFBTyxFQUFJLEVBVTVEQyxPQVBhLEtBQ1csSUFBakJOLEVBQVFLLEtBT2hCLEVDdkJHRSxFQUFZLEtBQ2hCLElBQUlDLEVBQVEsR0FDUkMsRUFBUyxHQUVUQyxFQUFXLENBQ2JDLE9BQVFiLEVBQUssR0FDYmMsU0FBVWQsRUFBSyxHQUNmZSxVQUFXZixFQUFLLEdBQ2hCZ0IsU0FBVWhCLEVBQUssR0FDZmlCLFVBQVdqQixFQUFLLEdBQ2hCa0IsV0FBWWxCLEVBQUssR0FDakJtQixVQUFXbkIsRUFBSyxHQUNoQm9CLFdBQVlwQixFQUFLLEdBQ2pCcUIsWUFBYXJCLEVBQUssR0FDbEJzQixXQUFZdEIsRUFBSyxJQUduQixNQW1CTXVCLEVBQVNDLElBQ2IsSUFBSUMsR0FBUyxFQU9iLE9BTEFELEVBQUlFLFNBQVNDLElBQ1gsR0FBSUEsRUFBSyxHQUFLLEdBQUtBLEVBQUssR0FBSyxJQVJoQkMsRUFROEJELEVBQUssR0FSaENFLEVBUW9DRixFQUFLLEdBUHBDLE9BQWhCakIsRUFBTWtCLEdBQUdDLElBUVosT0FBUUosR0FBUyxFQVRQLElBQUNHLEVBQUdDLENBU1MsSUFHcEJKLENBQU0sRUFHVEssRUFBYSxDQUFDRixFQUFHQyxFQUFHRSxLQUN4QixNQUFNekIsRUFBU3lCLEVBQUs1QixVQUFVRyxPQUU5QixJQUFJMEIsRUFBTyxHQUNQQyxFQUFJTCxFQUNKTSxFQUFJTCxFQUVSLEdBQW9CLGVBTEFFLEVBQUs1QixVQUFVZ0MsWUFNakMsS0FBT0QsSUFBTUwsRUFBSXZCLEdBQ2YwQixFQUFLSSxLQUFLLENBQUNSLEVBQUdNLElBQ2RBLEdBQUssT0FHUCxLQUFPRCxJQUFNTCxFQUFJdEIsR0FDZjBCLEVBQUtJLEtBQUssQ0FBQ0gsRUFBR0osSUFDZEksR0FBSyxFQUlULE9BQU9ELENBQUksRUFHUEssRUFBWSxDQUFDVCxFQUFHQyxFQUFHRSxLQUN2QixJQUFJQyxFQUFPLEdBQ1BQLEdBQVMsRUFFYixPQUFJSSxFQUFJdkIsT0FBUyxFQUFJLEdBQUtzQixFQUFJLEdBQUtBLEVBQUl0QixPQUFTLEVBQUksR0FBS3VCLEVBQUksRUFDcERTLFFBQVFDLElBQUksVUFFbkJQLEVBQU9GLEVBQVdGLEVBQUdDLEVBQUdFLEdBQ3hCTixFQUFTRixFQUFNUyxJQUdGLElBQVhQLEdBQ0ZBLEdBQVMsRUFDVE8sRUFBTyxHQUNBTSxRQUFRQyxJQUFJLGVBRW5CUixFQUFLNUIsVUFBVXFDLEtBQU9SLEVBRXRCRCxFQUFLNUIsVUFBVXFDLEtBQUtkLFNBQVNDLElBQzNCakIsRUFBTWlCLEVBQUssSUFBSUEsRUFBSyxJQUFNSSxDQUFJLElBSTNCckIsR0FBSyxFQTBEZCxNQUFPLENBQ0wrQixZQWxJa0IsS0FDbEIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFBSyxDQUMzQmhDLEVBQU1nQyxHQUFLLEdBQ1gsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUksR0FBSUEsSUFDdEJqQyxFQUFNZ0MsR0FBR0MsR0FBSyxJQUVsQixDQUVBLE9BQU9qQyxDQUFLLEVBMkhaMkIsWUFDQU8sU0F4SWUsSUFBTWxDLEVBeUlyQm1DLFNBdkllLElBQU1qQyxFQXdJckJrQyxjQTVCb0IsQ0FBQ2xCLEVBQUdDLEtBQ0osT0FBaEJuQixFQUFNa0IsR0FBR0MsR0FBYWxCLEVBQU95QixLQUFLLENBQUNSLEVBQUdDLEtBRXhDbkIsRUFBTWtCLEdBQUdDLEdBQUd6QixNQUNaTSxFQUFNa0IsR0FBR0MsR0FBRzFCLFVBQVU0QyxRQUFRWCxLQUFLLENBQUNSLEVBQUdDLEtBR2xDbkIsR0FzQlBzQyxVQTFJZ0IsSUFBTXJDLEVBMkl0QnNDLFVBcEJnQixLQUNoQixNQUFNQyxFQUFRQyxPQUFPQyxPQUFPeEMsR0FDNUIsSUFBSWEsR0FBUyxFQVFiLE9BTkF5QixFQUFNeEIsU0FBU0ssSUFDYixJQUE0QixJQUF4QkEsRUFBSzVCLFVBQVVJLEtBQ2pCLE9BQVFrQixHQUFTLEVBQ1pBLEdBQVMsQ0FBSSxJQUdmQSxDQUFNLEVBV2I0QixXQS9EaUIsS0FDakIsTUFBTUMsRUFBT0gsT0FBT0csS0FBSzFDLEdBQ25CMkMsRUFBYSxDQUFDLGFBQWMsWUEyQmxDLE9BekJBRCxFQUFLNUIsU0FBUzhCLElBQ1osTUFBTXpCLEVBQU9uQixFQUFTNEMsR0FDaEJsRCxFQUFTeUIsRUFBSzVCLFVBQVVHLE9BRTlCLElBQUlzQixFQUFJNkIsS0FBS0MsTUFBc0IsR0FBaEJELEtBQUtFLFVBQ3BCOUIsRUFBSTRCLEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQUNwQkMsRUFBSUgsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBRXhCNUIsRUFBSzVCLFVBQVVnQyxZQUFjb0IsRUFBV0ssR0FDeEMsSUFBSTVCLEVBQU9GLEVBQVdGLEVBQUdDLEVBQUdFLEdBQ3hCOEIsRUFBTXRDLEVBQU1TLEdBRWhCLEtBQU9ILEVBQUl2QixFQUFTLEVBQUksR0FBS3NCLEVBQUl0QixFQUFTLEVBQUksSUFBYSxJQUFSdUQsR0FDakRqQyxFQUFJNkIsS0FBS0MsTUFBc0IsR0FBaEJELEtBQUtFLFVBQ3BCOUIsRUFBSTRCLEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQUNwQkMsRUFBSUgsS0FBS0MsTUFBc0IsRUFBaEJELEtBQUtFLFVBRXBCNUIsRUFBSzVCLFVBQVVnQyxZQUFjb0IsRUFBV0ssR0FDeEM1QixFQUFPRixFQUFXRixFQUFHQyxFQUFHRSxHQUN4QjhCLEVBQU10QyxFQUFNUyxHQUdkSyxFQUFVVCxFQUFHQyxFQUFHRSxFQUFLLElBR2hCckIsQ0FBSyxFQW1DYixFQy9KR29ELEVBQVVDLElBS1AsQ0FDTEEsU0FDQUMsS0FOUSxFQU9SdEQsTUFOVUQsSUFPVndELFFBTlcsSUNMVEMsRUFBVSxDQUFDQyxFQUFRQyxFQUFLQyxFQUFLekMsRUFBR0MsS0FDcEMsTUFBTWxCLEVBQVN3RCxFQUFPekQsTUFBTXNDLFlBRWhCLE9BQVJvQixFQUVBekQsRUFBTzJELE1BQU0zQyxHQUNKQSxFQUFLLEtBQU9DLEdBQUtELEVBQUssS0FBT0UsSUFHdEN3QyxFQUFJRSxhQUFhLFFBQVMsNkJBRTFCRixFQUFJRSxhQUFhLFFBQVMsMkJBRzVCSCxFQUFJakUsVUFBVTRDLFFBQVF1QixNQUFNM0MsR0FDbkJBLEVBQUssS0FBT0MsR0FBS0QsRUFBSyxLQUFPRSxLQUd0Q3dDLEVBQUlFLGFBQWEsUUFBUyx5QkFDNUIsRUFxQklDLEVBQWVMLElBQ25CQSxFQUFPekQsTUFBTStCLGNBbkJJLENBQUMwQixJQUNOQSxFQUFPekQsTUFBTWtDLFdBQ3pCLE1BQU02QixFQUFXTixFQUFPekQsTUFBTW1DLFdBQ1pNLE9BQU9HLEtBQUttQixHQUVwQi9DLFNBQVNLLElBQ2pCLE1BQU1TLEVBQU9pQyxFQUFTMUMsR0FBTTVCLFVBQVVxQyxLQUV0QyxHQUFvQixJQUFoQkEsRUFBS2xDLE9BQWMsQ0FDckIsTUFBTW9FLEVBQVFsQyxFQUFLLEdBQUcsR0FDaEJtQyxFQUFRbkMsRUFBSyxHQUFHLEdBQ3RCMkIsRUFBT3pELE1BQU0yQixVQUFVcUMsRUFBT0MsRUFBT0YsRUFBUzFDLEdBQ2hELElBR1UsRUFNWjZDLENBQVdULEdBRVgsTUFBTXpELEVBQVF5RCxFQUFPekQsTUFBTWtDLFdBQ3JCaUMsRUFBWVYsRUFBT0osT0FDekIsSUFBSWUsRUFBZUMsU0FBU0MsZUFBZSxRQUFRSCxLQUVuRCxLQUFPQyxFQUFhRyxrQkFDbEJILEVBQWFJLFlBQVlKLEVBQWFHLGtCQUV4QyxJQUFLLElBQUl2QyxFQUFJLEVBQUdBLEVBQUloQyxFQUFNSixPQUFRb0MsSUFDaEMsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlqQyxFQUFNSixPQUFRcUMsSUFBSyxDQUNyQyxNQUFNd0MsRUFBU0osU0FBU0ssY0FBYyxPQUN0Q0QsRUFBT0UsVUFBVUMsSUFBSSxHQUFHVCxZQUV4Qk0sRUFBT1osYUFBYSxTQUFVLEdBQUc3QixLQUNqQ3lDLEVBQU9aLGFBQWEsU0FBVSxHQUFHNUIsS0FFakN1QixFQUFReEQsRUFBTWdDLEdBQUdDLEdBQUl3QyxHQUVyQkwsRUFBYVMsWUFBWUosRUFDM0IsQ0FHRixPQUFPTCxDQUFZLEVBR2ZVLEVBQW1CckIsSUFDdkIsTUFBTU0sRUFBV04sRUFBT3pELE1BQU1tQyxXQUN4QkssRUFBUUMsT0FBT0csS0FBS21CLEdBQ3BCZ0IsRUFBWVYsU0FBU1csY0FBYyxVQUFVdkIsRUFBT0osZ0JBUTFELE9BTkFiLEVBQU14QixTQUFTSyxJQUNiLE1BQU00RCxFQUFTWixTQUFTSyxjQUFjLFVBQ3RDTyxFQUFPQyxZQUFjN0QsRUFDckIwRCxFQUFVRixZQUFZSSxFQUFPLElBR3hCRixDQUFTLEVBR1pJLEVBQWlCMUIsSUFDTlksU0FBU1csY0FBYyxpQkFBaUJ2QixFQUFPSixVQUV2RCtCLGlCQUFpQixTQUFVQyxJQUNoQ0EsRUFBRUMsaUJBRUYsTUFBTXRCLEVBQVF1QixTQUNabEIsU0FBU1csY0FBYyxVQUFVdkIsRUFBT0osWUFBWW1DLE9BRWhEdkIsRUFBUXNCLFNBQ1psQixTQUFTVyxjQUFjLFVBQVV2QixFQUFPSixZQUFZbUMsT0FFaERDLEVBQVdwQixTQUFTVyxjQUN4QixVQUFVdkIsRUFBT0osZ0JBQ2pCbUMsTUFFSUUsRUFBU3JCLFNBQVNXLGNBQ3RCLFVBQVV2QixFQUFPSixpQkFDakJtQyxNQUVJbkUsRUFBT29DLEVBQU96RCxNQUFNbUMsV0FBV3NELEdBRXJDcEUsRUFBSzVCLFVBQVVnQyxZQUFjaUUsRUFDN0I5RCxRQUFRQyxJQUFJNkQsR0FFWmpDLEVBQU96RCxNQUFNMkIsVUFBVXFDLEVBQU9DLEVBQU81QyxHQUNyQ3lDLEVBQVlMLEVBQU8sR0FDbkIsRUFHRWtDLEVBQWdCbEMsSUFDcEIsTUFBTW1DLEVBQU92QixTQUFTVyxjQUFjLFFBQzlCYSxFQUFTeEIsU0FBU1csY0FBYyxVQUFVdkIsRUFBT0osaUJBQ2pEeUMsRUFBT3pCLFNBQVNXLGNBQWMsVUFBVXZCLEVBQU9KLGVBQy9DVSxFQUFXTixFQUFPekQsTUFBTW1DLFdBQ3hCSyxFQUFRQyxPQUFPQyxPQUFPcUIsR0FDNUIsSUFBSWdDLEdBQWMsRUFFbEJGLEVBQU9ULGlCQUFpQixTQUFVQyxJQUNoQ0EsRUFBRUMsaUJBRUYsTUFBTVUsRUFBT0osRUFBS0ssYUFBYSxTQUUvQnpELEVBQU14QixTQUFTSyxJQUNiLE1BQU1TLEVBQU9ULEVBQUs1QixVQUFVcUMsS0FDNUIsT0FBK0JpRSxFQUFYLElBQWhCakUsRUFBS2xDLE1BQ3VCLElBR2xDbUcsRUFDSUQsRUFBS2pDLGFBQWEsUUFBUyxrQkFDM0JqQyxRQUFRQyxJQUFJLG9DQUVoQnFFLEVBQVV6QyxHQUVHLFFBQVR1QyxHQUNhM0IsU0FBU1csY0FBYyxXQUMvQm1CLFdBQ1QsR0FDQSxFQUdFRCxFQUFhekMsSUFDSFksU0FBUytCLGlCQUFpQixJQUFJM0MsRUFBT0osaUJBRTNDckMsU0FBU3lELElBQ2ZBLEVBQU9aLGFBQWEsV0FBWSxJQUNoQ1ksRUFBT1osYUFBYSxRQUFTLDBCQUEwQixHQUN2RCxFQUdFd0MsRUFBYyxDQUFDQyxFQUFNQyxLQUN6QixNQUFNWCxFQUFPdkIsU0FBU1csY0FBYyxRQUM5QndCLEVBQVNuQyxTQUFTVyxjQUFjLFdBQ2hDeUIsRUFBYXBDLFNBQVNXLGNBQWMsZ0JBQzFCWCxTQUFTVyxjQUFjLFNBRS9CSSxpQkFBaUIsU0FBVUMsSUFDakNBLEVBQUVDLGlCQUNGLElBQUk3QixFQUFTZ0QsRUFBV1IsYUFBYSxXQUVyQyxHQUFlLGVBQVh4QyxFQUlGLE9BSEFLLEVBQVl3QyxHQUNaSSxFQUFhSCxHQUNiRSxFQUFXNUMsYUFBYSxVQUFXLFVBQVV5QyxFQUFLakQsVUFDM0NtRCxFQUFPRyxRQUNULEdBQWUsZUFBWGxELEVBQXlCLENBQ2xDLE1BQU11QyxFQUFPSixFQUFLSyxhQUFhLFNBRy9CLE9BRkFRLEVBQVc1QyxhQUFhLFVBQVcsVUFBVTBDLEVBQUtsRCxVQUNsRHpCLFFBQVFDLElBQUltRSxHQUNDLFFBQVRBLEdBQ0ZZLEVBQVFOLEVBQU1DLEdBQ1BDLEVBQU9HLFVBRWQ3QyxFQUFZeUMsR0FDWkcsRUFBYUosR0FDTkUsRUFBT0csUUFFbEIsSUFDQSxFQUdFRCxFQUFnQmpELElBQ3BCLE1BQU16RCxFQUFReUQsRUFBT3pELE1BQU1rQyxXQUNyQmpDLEVBQVN3RCxFQUFPekQsTUFBTXNDLFlBQ3RCdUUsRUFBWXhDLFNBQVNXLGNBQWMsU0FBU3ZCLEVBQU9KLFVBRXpELEtBQU93RCxFQUFVdEMsa0JBQ2ZzQyxFQUFVckMsWUFBWXFDLEVBQVV0QyxrQkFFbEMsSUFBSyxJQUFJdkMsRUFBSSxFQUFHQSxFQUFJaEMsRUFBTUosT0FBUW9DLElBQ2hDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJakMsRUFBTUosT0FBUXFDLElBQUssQ0FDckMsTUFBTWhCLEVBQU9qQixFQUFNZ0MsR0FBR0MsR0FFaEJ3QyxFQUFTSixTQUFTSyxjQUFjLFVBQ3RDRCxFQUFPRSxVQUFVQyxJQUFJLEdBQUduQixFQUFPSixpQkFFL0JvQixFQUFPWixhQUFhLFNBQVUsR0FBRzdCLEtBQ2pDeUMsRUFBT1osYUFBYSxTQUFVLEdBQUc1QixLQUVqQzZFLEVBQVdyRCxFQUFRZ0IsR0FHUixPQUFUeEQsR0FDQUEsRUFBS3hCLFVBQVVFLFNBQVcsR0FDMUJzQixFQUFLeEIsVUFBVTRDLFFBQVF1QixNQUFNM0MsR0FDcEJBLEVBQUssS0FBT2UsR0FBS2YsRUFBSyxLQUFPZ0IsTUFHdEN3QyxFQUFPWixhQUFhLFFBQVMsMEJBQzdCWSxFQUFPWixhQUFhLFdBQVksS0FJaEM1RCxFQUFPMkQsTUFBTTNDLEdBQ0pBLEVBQUssS0FBT2UsR0FBS2YsRUFBSyxLQUFPZ0IsTUFHdEN3QyxFQUFPWixhQUFhLFFBQVMsNEJBQzdCWSxFQUFPWixhQUFhLFdBQVksS0FHbENnRCxFQUFVaEMsWUFBWUosRUFDeEIsQ0FDRixFQUdJcUMsRUFBYSxDQUFDckQsRUFBUWdCLEtBQzFCLE1BQU16RSxFQUFReUQsRUFBT3pELE1BQ2YrRyxFQUFZL0csRUFBTWtDLFdBQ2xCc0UsRUFBU25DLFNBQVNXLGNBQWMsV0FDaEM5RCxFQUFJcUUsU0FBU2QsRUFBT3dCLGFBQWEsV0FDakM5RSxFQUFJb0UsU0FBU2QsRUFBT3dCLGFBQWEsV0FFdkN4QixFQUFPVyxpQkFBaUIsU0FBVUMsSUFDaENBLEVBQUVDLGlCQUVGdEYsRUFBTW9DLGNBQWNsQixFQUFHQyxHQUNDLE9BQXBCNEYsRUFBVTdGLEdBQUdDLElBQ2YrRSxFQUFVekMsR0FDVmdCLEVBQU9aLGFBQWEsUUFBUywwQkFDN0IyQyxFQUFPTCxhQUVQMUIsRUFBT1osYUFBYSxRQUFTLDJCQUMvQixHQUNBLEVBUUUrQyxFQUFVLENBQUNJLEVBQVNDLEtBQ3hCLE1BQU1qSCxFQUFRZ0gsRUFBUWhILE1BQ2hCK0csRUFBWS9HLEVBQU1rQyxXQUNsQnVFLEVBQWFwQyxTQUFTVyxjQUFjLGdCQUMxQyxJQUFJOUQsRUFBSTZCLEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQUNwQjlCLEVBQUk0QixLQUFLQyxNQUFzQixHQUFoQkQsS0FBS0UsVUFDcEJpRSxHQUFPLEVBRVgsTUFBZ0IsSUFBVEEsR0FDTGxILEVBQU1vQyxjQUFjbEIsRUFBR0MsR0FFQyxPQUFwQjRGLEVBQVU3RixHQUFHQyxJQUNmc0YsRUFBVzVDLGFBQWEsVUFBVyxVQUFVbUQsRUFBUTNELFVBQ3JEUyxFQUFZa0QsR0FDWk4sRUFBYU8sR0FDYkMsR0FBTyxJQUVQdEYsUUFBUUMsSUFBSSxjQUNaWCxFQUFJNkIsS0FBS0MsTUFBc0IsR0FBaEJELEtBQUtFLFVBQ3BCOUIsRUFBSTRCLEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQUV4QixFQzNRSWtFLEVBQVc5QyxTQUFTVyxjQUFjLGNBQ2xDb0MsRUFBUy9DLFNBQVNXLGNBQWMsUUFDaENxQyxFQUFTaEQsU0FBU1csY0FBYyxRQUNoQ3NDLEVBQVlsRSxFQUFPLE9BQ25CbUUsRUFBWW5FLEVBQU8sT0FFekJnRSxFQUFPaEMsaUJBQWlCLFNBQVVDLElBQ2hDQSxFQUFFQyxpQkFDRnhCLEVBQVl3RCxHQUNaeEQsRUFBWXlELEdBRVp6QyxFQUFnQndDLEdBQ2hCeEMsRUFBZ0J5QyxHQUVoQnBDLEVBQWNtQyxHQUNkbkMsRUFBY29DLEdBRWQ1QixFQUFhMkIsR0FDYjNCLEVBQWE0QixHQUVibEIsRUFBWWlCLEVBQVdDLEdBRWhCSixFQUFTUixXQUdsQlUsRUFBT2pDLGlCQUFpQixTQUFVQyxJQUNoQ0EsRUFBRUMsaUJBRUYsTUFBTU0sRUFBT3ZCLFNBQVNXLGNBQWMsUUFDOUJjLEVBQU96QixTQUFTVyxjQUFjLG1CRG9OckIsSUFBQ3ZCLEVDck1oQixPQWJBSyxFQUFZd0QsR0FDWnhELEVBQVl5RCxHQUNaekMsRUFBZ0J3QyxHQUNoQm5DLEVBQWNtQyxHQUNkM0IsRUFBYTJCLEdBQ2IzQixFQUFhNEIsR0FDYmxCLEVBQVlpQixFQUFXQyxJRDRNUDlELEVDMU1QOEQsR0QyTUZ2SCxNQUFNMkMsYUFDYm1CLEVBQVlMLEdDMU1acUMsRUFBS2pDLGFBQWEsUUFBUyxrQkFDM0IrQixFQUFLakIsVUFBVUMsSUFBSSxPQUVadUMsRUFBU1IsT0FBTyxJQUd6QnRDLFNBQVNlLGlCQUFpQixTQUFVK0IsRUFBU2hCLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvRE9NLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNoaXAgPSAobikgPT4ge1xuICBsZXQgc2hpcE9iaiA9IHt9O1xuXG4gIHNoaXBPYmpbXCJsZW5ndGhcIl0gPSBuO1xuICBzaGlwT2JqW1wiaGl0Q291bnRcIl0gPSAwO1xuICBzaGlwT2JqW1wic3Vua1wiXSA9IGZhbHNlO1xuICBzaGlwT2JqW1wib3JpZW50YXRpb25cIl0gPSBcImhvcml6b250YWxcIjtcbiAgc2hpcE9ialtcImNvbXBcIl0gPSBbXTtcbiAgc2hpcE9ialtcImhpdENvb3JcIl0gPSBbXTtcblxuICBjb25zdCBnZXRTaGlwID0gKCkgPT4gc2hpcE9iajtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5oaXRDb3VudCArPSAxO1xuICAgIGlmIChzaGlwT2JqLmhpdENvdW50ID09PSBzaGlwT2JqLmxlbmd0aCkgc2hpcE9iai5zdW5rID0gdHJ1ZTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHNoaXBPYmouc3VuayA9PT0gdHJ1ZSA/IHRydWUgOiBmYWxzZTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGdldFNoaXAsXG4gICAgaGl0LFxuICAgIGlzU3VuayxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFNoaXAgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5cbmNvbnN0IEdhbWVib2FyZCA9ICgpID0+IHtcbiAgbGV0IGJvYXJkID0gW107XG4gIGxldCBtaXNzZXMgPSBbXTtcblxuICBsZXQgYWxsU2hpcHMgPSB7XG4gICAgbF9zaGlwOiBTaGlwKDQpLFxuICAgIG1fc2hpcF9JOiBTaGlwKDMpLFxuICAgIG1fc2hpcF9JSTogU2hpcCgzKSxcbiAgICBzX3NoaXBfSTogU2hpcCgyKSxcbiAgICBzX3NoaXBfSUk6IFNoaXAoMiksXG4gICAgc19zaGlwX0lJSTogU2hpcCgyKSxcbiAgICB4c19zaGlwX0k6IFNoaXAoMSksXG4gICAgeHNfc2hpcF9JSTogU2hpcCgxKSxcbiAgICB4c19zaGlwX0lJSTogU2hpcCgxKSxcbiAgICB4c19zaGlwX0lWOiBTaGlwKDEpLFxuICB9O1xuXG4gIGNvbnN0IGdldEJvYXJkID0gKCkgPT4gYm9hcmQ7XG4gIGNvbnN0IGdldE1pc3NlcyA9ICgpID0+IG1pc3NlcztcbiAgY29uc3QgZ2V0U2hpcHMgPSAoKSA9PiBhbGxTaGlwcztcblxuICBjb25zdCBjcmVhdGVCb2FyZCA9ICgpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGJvYXJkW2ldID0gW107XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgYm9hcmRbaV1bal0gPSBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBpc0VtcHR5ID0gKHgsIHkpID0+IHtcbiAgICByZXR1cm4gYm9hcmRbeF1beV0gPT09IG51bGwgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgaXNGaXQgPSAoYXJyKSA9PiB7XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaWYgKGl0ZW1bMF0gPiA5IHx8IGl0ZW1bMV0gPiA5IHx8ICFpc0VtcHR5KGl0ZW1bMF0sIGl0ZW1bMV0pKVxuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0dXM7XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlQ29tcCA9ICh4LCB5LCBzaGlwKSA9PiB7XG4gICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb247XG4gICAgbGV0IHRlbXAgPSBbXTtcbiAgICBsZXQgYSA9IHg7XG4gICAgbGV0IGIgPSB5O1xuXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgd2hpbGUgKGIgIT09IHkgKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFt4LCBiXSk7XG4gICAgICAgIGIgKz0gMTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGEgIT09IHggKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFthLCB5XSk7XG4gICAgICAgIGEgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGVtcDtcbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBpZiAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCB5ID4gOSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgc3RhdHVzID0gaXNGaXQodGVtcCk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gZmFsc2UpIHtcbiAgICAgIHN0YXR1cyA9IHRydWU7XG4gICAgICB0ZW1wID0gW107XG4gICAgICByZXR1cm4gY29uc29sZS5sb2coXCJub3QgZW1wdHlcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAgPSB0ZW1wO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5jb21wLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgYm9hcmRbaXRlbVswXV1baXRlbVsxXV0gPSBzaGlwO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHBvcHVsYXRlQmQgPSAoKSA9PiB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFsbFNoaXBzKTtcbiAgICBjb25zdCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xuXG4gICAga2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IHNoaXAgPSBhbGxTaGlwc1trZXldO1xuICAgICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuXG4gICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBkaXJlY3Rpb25zW3pdO1xuICAgICAgbGV0IHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgbGV0IGZpdCA9IGlzRml0KHRlbXApO1xuXG4gICAgICB3aGlsZSAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCBmaXQgPT09IGZhbHNlKSB7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgICBmaXQgPSBpc0ZpdCh0ZW1wKTtcbiAgICAgIH1cblxuICAgICAgcGxhY2VTaGlwKHgsIHksIHNoaXApO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoeCwgeSkgPT4ge1xuICAgIGlmIChib2FyZFt4XVt5XSA9PT0gbnVsbCkgbWlzc2VzLnB1c2goW3gsIHldKTtcbiAgICBlbHNlIHtcbiAgICAgIGJvYXJkW3hdW3ldLmhpdCgpO1xuICAgICAgYm9hcmRbeF1beV0uZ2V0U2hpcCgpLmhpdENvb3IucHVzaChbeCwgeV0pO1xuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBpc0FsbFN1bmsgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2hpcHMgPSBPYmplY3QudmFsdWVzKGFsbFNoaXBzKTtcbiAgICBsZXQgc3RhdHVzID0gZmFsc2U7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBpZiAoc2hpcC5nZXRTaGlwKCkuc3VuayA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIChzdGF0dXMgPSBmYWxzZSk7XG4gICAgICB9IGVsc2Ugc3RhdHVzID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0dXM7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVCb2FyZCxcbiAgICBwbGFjZVNoaXAsXG4gICAgZ2V0Qm9hcmQsXG4gICAgZ2V0U2hpcHMsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBnZXRNaXNzZXMsXG4gICAgaXNBbGxTdW5rLFxuICAgIHBvcHVsYXRlQmQsXG4gIH07XG59O1xuXG5leHBvcnQgeyBHYW1lYm9hcmQgfTtcbiIsImltcG9ydCB7IEdhbWVib2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xuXG5jb25zdCBQbGF5ZXIgPSAobnVtYmVyKSA9PiB7XG4gIGxldCB3aW4gPSBmYWxzZTtcbiAgbGV0IGJvYXJkID0gR2FtZWJvYXJkKCk7XG4gIGxldCBpc0NvbXAgPSBmYWxzZTtcblxuICByZXR1cm4ge1xuICAgIG51bWJlcixcbiAgICB3aW4sXG4gICAgYm9hcmQsXG4gICAgaXNDb21wLFxuICB9O1xufTtcblxuZXhwb3J0IHsgUGxheWVyIH07XG4iLCJjb25zdCBmaWxsU3FyID0gKHBsYXllciwgc3FyLCB0YWcsIHgsIHkpID0+IHtcbiAgY29uc3QgbWlzc2VzID0gcGxheWVyLmJvYXJkLmdldE1pc3NlcygpO1xuXG4gIGlmIChzcXIgPT09IG51bGwpIHtcbiAgICBpZiAoXG4gICAgICBtaXNzZXMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgICAgfSlcbiAgICApIHtcbiAgICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHllbGxvdztcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGJsdWU7XCIpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChcbiAgICBzcXIuZ2V0U2hpcCgpLmhpdENvb3IuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICB9KVxuICApIHtcbiAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICB9XG59O1xuXG5jb25zdCByZW5kZXJTaGlwID0gKHBsYXllcikgPT4ge1xuICBsZXQgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3Qgc2hpcHNPYmogPSBwbGF5ZXIuYm9hcmQuZ2V0U2hpcHMoKTtcbiAgY29uc3Qgc2hpcHNMaXN0ID0gT2JqZWN0LmtleXMoc2hpcHNPYmopO1xuXG4gIHNoaXBzTGlzdC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgY29uc3QgY29tcCA9IHNoaXBzT2JqW3NoaXBdLmdldFNoaXAoKS5jb21wO1xuXG4gICAgaWYgKGNvbXAubGVuZ3RoICE9PSAwKSB7XG4gICAgICBjb25zdCB4Q29vciA9IGNvbXBbMF1bMF07XG4gICAgICBjb25zdCB5Q29vciA9IGNvbXBbMF1bMV07XG4gICAgICBwbGF5ZXIuYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcHNPYmpbc2hpcF0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGJvYXJkO1xufTtcblxuY29uc3QgcmVuZGVyQm9hcmQgPSAocGxheWVyKSA9PiB7XG4gIHBsYXllci5ib2FyZC5jcmVhdGVCb2FyZCgpO1xuXG4gIHJlbmRlclNoaXAocGxheWVyKTtcblxuICBjb25zdCBib2FyZCA9IHBsYXllci5ib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBwbGF5ZXJOdW0gPSBwbGF5ZXIubnVtYmVyO1xuICBsZXQgY3VycmVudEJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGJvYXJkJHtwbGF5ZXJOdW19YCk7XG5cbiAgd2hpbGUgKGN1cnJlbnRCb2FyZC5sYXN0RWxlbWVudENoaWxkKVxuICAgIGN1cnJlbnRCb2FyZC5yZW1vdmVDaGlsZChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmQubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwbGF5ZXJOdW19LXNxdWFyZWApO1xuXG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGF0YS14XCIsIGAke2l9YCk7XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGF0YS15XCIsIGAke2p9YCk7XG5cbiAgICAgIGZpbGxTcXIoYm9hcmRbaV1bal0sIHNxdWFyZSk7XG5cbiAgICAgIGN1cnJlbnRCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50Qm9hcmQ7XG59O1xuXG5jb25zdCBncmFiUGxheWVyU2hpcHMgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzID0gT2JqZWN0LmtleXMoc2hpcHNPYmopO1xuICBjb25zdCBzZWxlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS1zaGlwc2ApO1xuXG4gIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IHNoaXA7XG4gICAgc2VsZWN0aW9uLmFwcGVuZENoaWxkKG9wdGlvbik7XG4gIH0pO1xuXG4gIHJldHVybiBzZWxlY3Rpb247XG59O1xuXG5jb25zdCBpbml0UGxhY2VTaGlwID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxhY2VTaGlwQnRuLSR7cGxheWVyLm51bWJlcn1gKTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgeENvb3IgPSBwYXJzZUludChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXlgKS52YWx1ZVxuICAgICk7XG4gICAgY29uc3QgeUNvb3IgPSBwYXJzZUludChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXhgKS52YWx1ZVxuICAgICk7XG4gICAgY29uc3Qgc2hpcE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXNoaXBzYFxuICAgICkudmFsdWU7XG5cbiAgICBjb25zdCBvcmllbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LW9yaWVudGBcbiAgICApLnZhbHVlO1xuXG4gICAgY29uc3Qgc2hpcCA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpW3NoaXBOYW1lXTtcblxuICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gb3JpZW50O1xuICAgIGNvbnNvbGUubG9nKG9yaWVudCk7XG5cbiAgICBwbGF5ZXIuYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcCk7XG4gICAgcmVuZGVyQm9hcmQocGxheWVyKTtcbiAgfSk7XG59O1xuXG5jb25zdCBpbml0RmluU2V0dXAgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllciR7cGxheWVyLm51bWJlcn0tZmluQnRuYCk7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS1mb3JtYCk7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhzaGlwc09iaik7XG4gIGxldCBpc0FsbFBsYWNlZCA9IGZhbHNlO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcblxuICAgIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGNvbnN0IGNvbXAgPSBzaGlwLmdldFNoaXAoKS5jb21wO1xuICAgICAgaWYgKGNvbXAubGVuZ3RoID09PSAwKSByZXR1cm4gKGlzQWxsUGxhY2VkID0gZmFsc2UpO1xuICAgICAgZWxzZSByZXR1cm4gKGlzQWxsUGxhY2VkID0gdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpc0FsbFBsYWNlZFxuICAgICAgPyBmb3JtLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZGlzcGxheTogbm9uZTtcIilcbiAgICAgIDogY29uc29sZS5sb2coXCJQbGVhc2UgcGxhY2UgYWxsIHRoZSBzaGlwcyBmaXJzdFwiKTtcblxuICAgIGhpZGVCb2FyZChwbGF5ZXIpO1xuXG4gICAgaWYgKG1vZGUgPT09IFwicHZjXCIpIHtcbiAgICAgIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICAgICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBoaWRlQm9hcmQgPSAocGxheWVyKSA9PiB7XG4gIGxldCBzcXVhcmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7cGxheWVyLm51bWJlcn0tc3F1YXJlYCk7XG5cbiAgc3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JheTtcIik7XG4gIH0pO1xufTtcblxuY29uc3QgaW5pdHBsYXlCdG4gPSAoUE9uZSwgUFR3bykgPT4ge1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICBjb25zdCBwbGF5V2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheVwiKTtcblxuICBwbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgcGxheWVyID0gcGxheVdpbmRvdy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuXG4gICAgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICAgIHJlbmRlckJvYXJkKFBPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKFBUd28pO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtQT25lLm51bWJlcn1gKTtcbiAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICB9IGVsc2UgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItT25lXCIpIHtcbiAgICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtQVHdvLm51bWJlcn1gKTtcbiAgICAgIGNvbnNvbGUubG9nKG1vZGUpO1xuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIpIHtcbiAgICAgICAgYXV0b0F0ayhQT25lLCBQVHdvKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVuZGVyQm9hcmQoUFR3byk7XG4gICAgICAgIHJlbmRlclBsYXlCZChQT25lKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCByZW5kZXJQbGF5QmQgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgY29uc3QgY3VyckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2JvYXJkJHtwbGF5ZXIubnVtYmVyfWApO1xuXG4gIHdoaWxlIChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyQm9hcmQucmVtb3ZlQ2hpbGQoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBpdGVtID0gYm9hcmRbaV1bal07XG5cbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwbGF5ZXIubnVtYmVyfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBpbml0U3FyQnRuKHBsYXllciwgc3F1YXJlKTtcblxuICAgICAgaWYgKFxuICAgICAgICBpdGVtICE9PSBudWxsICYmXG4gICAgICAgIGl0ZW0uZ2V0U2hpcCgpLmhpdENvdW50ID4gMCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBtaXNzZXMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHJldHVybiBpdGVtWzBdID09PSBpICYmIGl0ZW1bMV0gPT09IGo7XG4gICAgICAgIH0pXG4gICAgICApIHtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGN1cnJCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgaW5pdFNxckJ0biA9IChwbGF5ZXIsIHNxdWFyZSkgPT4ge1xuICBjb25zdCBib2FyZCA9IHBsYXllci5ib2FyZDtcbiAgY29uc3QgYm9hcmRMaXN0ID0gYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gIGNvbnN0IHggPSBwYXJzZUludChzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS14XCIpKTtcbiAgY29uc3QgeSA9IHBhcnNlSW50KHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIikpO1xuXG4gIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIGhpZGVCb2FyZChwbGF5ZXIpO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XCIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBjb21wTW9kZSA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyKTtcbn07XG5cbmNvbnN0IGF1dG9BdGsgPSAocGxheU9uZSwgcGxheVR3bykgPT4ge1xuICBjb25zdCBib2FyZCA9IHBsYXlPbmUuYm9hcmQ7XG4gIGNvbnN0IGJvYXJkTGlzdCA9IGJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHBsYXlXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCBjb250ID0gdHJ1ZTtcblxuICB3aGlsZSAoY29udCA9PT0gdHJ1ZSkge1xuICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG5cbiAgICBpZiAoYm9hcmRMaXN0W3hdW3ldID09PSBudWxsKSB7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke3BsYXlPbmUubnVtYmVyfWApO1xuICAgICAgcmVuZGVyQm9hcmQocGxheU9uZSk7XG4gICAgICByZW5kZXJQbGF5QmQocGxheVR3byk7XG4gICAgICBjb250ID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiY29udGludWluZ1wiKTtcbiAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IHtcbiAgcmVuZGVyQm9hcmQsXG4gIGdyYWJQbGF5ZXJTaGlwcyxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG59O1xuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgZ3JhYlBsYXllclNoaXBzLFxuICBpbml0UGxhY2VTaGlwLFxuICBpbml0RmluU2V0dXAsXG4gIGluaXRwbGF5QnRuLFxuICBjb21wTW9kZSxcbn0gZnJvbSBcIi4vRE9NXCI7XG5cbmNvbnN0IGdhbWVNb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lX21vZGVcIik7XG5jb25zdCBwdnBCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3B2cFwiKTtcbmNvbnN0IHB2Y0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZjXCIpO1xuY29uc3QgcGxheWVyT25lID0gUGxheWVyKFwiT25lXCIpO1xuY29uc3QgcGxheWVyVHdvID0gUGxheWVyKFwiVHdvXCIpO1xuXG5wdnBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyT25lKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyVHdvKTtcblxuICBncmFiUGxheWVyU2hpcHMocGxheWVyT25lKTtcbiAgZ3JhYlBsYXllclNoaXBzKHBsYXllclR3byk7XG5cbiAgaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUpO1xuICBpbml0UGxhY2VTaGlwKHBsYXllclR3byk7XG5cbiAgaW5pdEZpblNldHVwKHBsYXllck9uZSk7XG4gIGluaXRGaW5TZXR1cChwbGF5ZXJUd28pO1xuXG4gIGluaXRwbGF5QnRuKHBsYXllck9uZSwgcGxheWVyVHdvKTtcblxuICByZXR1cm4gZ2FtZU1vZGUuY2xvc2UoKTtcbn0pO1xuXG5wdmNCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXllclR3by1mb3JtXCIpO1xuXG4gIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gIHJlbmRlckJvYXJkKHBsYXllclR3byk7XG4gIGdyYWJQbGF5ZXJTaGlwcyhwbGF5ZXJPbmUpO1xuICBpbml0UGxhY2VTaGlwKHBsYXllck9uZSk7XG4gIGluaXRGaW5TZXR1cChwbGF5ZXJPbmUpO1xuICBpbml0RmluU2V0dXAocGxheWVyVHdvKTtcbiAgaW5pdHBsYXlCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuXG4gIGNvbXBNb2RlKHBsYXllclR3byk7XG5cbiAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmU7XCIpO1xuICBtYWluLmNsYXNzTGlzdC5hZGQoXCJwdmNcIik7XG5cbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubG9hZFwiLCBnYW1lTW9kZS5zaG93TW9kYWwoKSk7XG4iXSwibmFtZXMiOlsiU2hpcCIsIm4iLCJzaGlwT2JqIiwiZ2V0U2hpcCIsImhpdCIsImhpdENvdW50IiwibGVuZ3RoIiwic3VuayIsImlzU3VuayIsIkdhbWVib2FyZCIsImJvYXJkIiwibWlzc2VzIiwiYWxsU2hpcHMiLCJsX3NoaXAiLCJtX3NoaXBfSSIsIm1fc2hpcF9JSSIsInNfc2hpcF9JIiwic19zaGlwX0lJIiwic19zaGlwX0lJSSIsInhzX3NoaXBfSSIsInhzX3NoaXBfSUkiLCJ4c19zaGlwX0lJSSIsInhzX3NoaXBfSVYiLCJpc0ZpdCIsImFyciIsInN0YXR1cyIsImZvckVhY2giLCJpdGVtIiwieCIsInkiLCJjcmVhdGVDb21wIiwic2hpcCIsInRlbXAiLCJhIiwiYiIsIm9yaWVudGF0aW9uIiwicHVzaCIsInBsYWNlU2hpcCIsImNvbnNvbGUiLCJsb2ciLCJjb21wIiwiY3JlYXRlQm9hcmQiLCJpIiwiaiIsImdldEJvYXJkIiwiZ2V0U2hpcHMiLCJyZWNlaXZlQXR0YWNrIiwiaGl0Q29vciIsImdldE1pc3NlcyIsImlzQWxsU3VuayIsInNoaXBzIiwiT2JqZWN0IiwidmFsdWVzIiwicG9wdWxhdGVCZCIsImtleXMiLCJkaXJlY3Rpb25zIiwia2V5IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwieiIsImZpdCIsIlBsYXllciIsIm51bWJlciIsIndpbiIsImlzQ29tcCIsImZpbGxTcXIiLCJwbGF5ZXIiLCJzcXIiLCJ0YWciLCJmaW5kIiwic2V0QXR0cmlidXRlIiwicmVuZGVyQm9hcmQiLCJzaGlwc09iaiIsInhDb29yIiwieUNvb3IiLCJyZW5kZXJTaGlwIiwicGxheWVyTnVtIiwiY3VycmVudEJvYXJkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxhc3RFbGVtZW50Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImdyYWJQbGF5ZXJTaGlwcyIsInNlbGVjdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJvcHRpb24iLCJ0ZXh0Q29udGVudCIsImluaXRQbGFjZVNoaXAiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwicGFyc2VJbnQiLCJ2YWx1ZSIsInNoaXBOYW1lIiwib3JpZW50IiwiaW5pdEZpblNldHVwIiwibWFpbiIsImJ1dHRvbiIsImZvcm0iLCJpc0FsbFBsYWNlZCIsIm1vZGUiLCJnZXRBdHRyaWJ1dGUiLCJoaWRlQm9hcmQiLCJzaG93TW9kYWwiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5pdHBsYXlCdG4iLCJQT25lIiwiUFR3byIsImRpYWxvZyIsInBsYXlXaW5kb3ciLCJyZW5kZXJQbGF5QmQiLCJjbG9zZSIsImF1dG9BdGsiLCJjdXJyQm9hcmQiLCJpbml0U3FyQnRuIiwiYm9hcmRMaXN0IiwicGxheU9uZSIsInBsYXlUd28iLCJjb250IiwiZ2FtZU1vZGUiLCJwdnBCdG4iLCJwdmNCdG4iLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iXSwic291cmNlUm9vdCI6IiJ9