(()=>{"use strict";const e=(e,t)=>{let r={};return r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],{getShip:()=>r,hit:()=>{r.hitCount+=1,r.hitCount===r.length&&(r.sunk=!0)},isSunk:()=>!0===r.sunk,resetShip:()=>(r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],r)}},t=()=>{let t=[],r=[],o=[],a={battleship:e(4,"battleship"),cruiser_I:e(3,"cruiser_I"),cruiser_II:e(3,"cruiser_II"),destroyer_I:e(2,"destroyer_I"),destroyer_II:e(2,"destroyer_II"),destroyer_III:e(2,"destroyer_III"),submarine_I:e(1,"submarine_I"),submarine_II:e(1,"submarine_II"),submarine_III:e(1,"submarine_III"),submarine_IV:e(1,"submarine_IV")};const n=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],a=e[1],null!==t[o][a]))return r=!1;var o,a})),r},l=(e,t,r)=>{const o=r.getShip().length;let a=[],n=e,l=t;if("horizontal"===r.getShip().orientation)for(;l!==t+o;)a.push([e,l]),l+=1;else for(;n!==e+o;)a.push([n,t]),n+=1;return a},u=(e,r,o)=>{let a=[],u=!0;return r+length-1>9||e>9||e+length-1>9||r>9?alert("Ship is out of bound"):(a=l(e,r,o),u=n(a),!1===u?(u=!0,a=[],alert("square is already occupied")):(o.getShip().comp=a,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:u,getBoard:()=>t,getShips:()=>a,receiveAttack:(e,a)=>(null===t[e][a]?r.push([e,a]):(o.push([e,a]),t[e][a].hit(),t[e][a].getShip().hitCoor.push([e,a])),t),getMisses:()=>r,getHits:()=>o,isAllSunk:()=>{const e=Object.values(a);let t=!0;return e.forEach((e=>{if(!e.isSunk())return t=!1})),t},populateBd:()=>{const e=Object.keys(a),r=["horizontal","vertical"];return e.forEach((e=>{const t=a[e],o=t.getShip().length;let c=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),d=Math.floor(2*Math.random());t.getShip().orientation=r[d];let i=l(c,s,t),m=n(i);for(;s+o-1>9||c+o-1>9||!1===m;)c=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),d=Math.floor(2*Math.random()),t.getShip().orientation=r[d],i=l(c,s,t),m=n(i);u(c,s,t)})),t},resetBoard:()=>{const e=Object.keys(a);t=[],r=[],o=[],e.forEach((e=>{a[e].resetShip()}))}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,a)=>{const n=e.board.getMisses();null===t?n.find((e=>e[0]===o&&e[1]===a))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===a))&&r.setAttribute("style","background-color: red;")},a=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const a=o[0][0],n=o[0][1];e.board.placeShip(a,n,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let a=document.getElementById(`board${r}`);for(;a.lastElementChild;)a.removeChild(a.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const u=document.createElement("div");u.classList.add(`${r}-square`),u.setAttribute("data-x",`${n}`),u.setAttribute("data-y",`${l}`),o(e,t[n][l],u,n,l),a.appendChild(u)}return a},n=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},l=(e,t,r)=>{let o,a,n;for("player-Two"===r?(o=t.board.getBoard(),a=t.board.getMisses(),n=document.querySelector(`#board${t.number}`)):(o=e.board.getBoard(),a=e.board.getMisses(),n=document.querySelector(`#board${e.number}`));n.lastElementChild;)n.removeChild(n.lastElementChild);for(let l=0;l<o.length;l++)for(let c=0;c<o.length;c++){const s=o[l][c],d=document.createElement("button");"player-One"===r?d.classList.add(`${e.number}-square`):d.classList.add(`${t.number}-square`),d.setAttribute("data-x",`${l}`),d.setAttribute("data-y",`${c}`),u(e,t,d),null!==s&&s.getShip().hitCount>0&&s.getShip().hitCoor.find((e=>e[0]===l&&e[1]===c))&&(d.setAttribute("style","background-color: red;"),d.setAttribute("disabled","")),a.find((e=>e[0]===l&&e[1]===c))&&(d.setAttribute("style","background-color: green;"),d.setAttribute("disabled","")),n.appendChild(d)}},u=(e,t,r)=>{const o=document.querySelector(".dialog"),a=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y")),u=document.querySelector(".winner"),c=document.querySelector(".end-game"),d=document.querySelector("#play-window"),i=document.querySelector(".player-name"),m=document.querySelector("main");r.addEventListener("click",(h=>{h.preventDefault();const p=r.getAttribute("class"),y=d.getAttribute("data-id"),b=m.getAttribute("class");let S,g;S="One-square"===p?e.board:t.board,g=S.getBoard(),S.receiveAttack(a,l),null===g[a][l]?(n("One-square"===p?t:e),r.setAttribute("style","background-color: yellow;"),i.textContent="pvc"===b?"Computer`s turn!":"player-One"===y?"Player Two`s turn!":"Player One`s turn!",o.showModal()):(s(g[a][l],"One-square"===p?e.number:t.number),r.setAttribute("style","background-color: red;"),S.isAllSunk()&&(r.setAttribute("style","background-color: red;"),c.showModal(),u.textContent="player-Two"===y?"Congratulations Player Two!":"Congratulations Player One!"))}))},c=e=>{const t=e.board.getShips()[document.querySelector("#ships").value].getShip().length,r=document.querySelector(".shape");for(;r.lastElementChild;)r.removeChild(r.lastElementChild);for(let e=1;e<=t;e++){const e=document.createElement("div");e.classList.add("square"),r.appendChild(e)}},s=(e,t)=>{const r=e.getShip().name,o=document.querySelector(`.shiplist-${t}`).querySelector(`.${r}`).querySelectorAll(".square");e.isSunk()&&o.forEach((e=>{e.setAttribute("style","background-color: red;")}))},d=document.querySelector(".game_mode"),i=document.querySelector("#pvp"),m=document.querySelector("#pvc"),h=document.querySelectorAll(".restart"),p=document.querySelector(".end-game"),y=document.querySelector("form"),b=document.querySelector("#ships"),S=document.querySelector("#orientation");let g=r("One"),f=r("Two");var q,v;q=g,v=f,document.querySelector("#placeShipBtn").addEventListener("click",(e=>{e.preventDefault();let t=document.querySelector("form").getAttribute("id");const r=parseInt(document.querySelector("#y-coor").value),o=parseInt(document.querySelector("#x-coor").value),n=document.querySelector("#ships").value,l=document.querySelector("#orientation").value;let u;u="playerOne-form"===t?q.board.getShips()[n]:v.board.getShips()[n],u.getShip().orientation=l,Number.isNaN(r)||Number.isNaN(o)||("playerOne-form"===t?(q.board.placeShip(r,o,u),a(q)):(v.board.placeShip(r,o,u),a(v)))})),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector("#finBtn"),a=document.querySelector("form"),l=document.querySelector(".player-name");let u=!1;o.addEventListener("click",(o=>{let s;o.preventDefault();const d=r.getAttribute("class");let i=a.getAttribute("id");if(s="playerOne-form"===i?e.board.getShips():t.board.getShips(),Object.values(s).forEach((e=>{const t=e.getShip().comp;return u=0!==t.length})),u){const r=document.querySelector(".shape"),o=document.querySelector("#ships"),u=document.querySelector("#x-coor"),s=document.querySelector("#y-coor"),m=o.querySelector(".battleship"),h=document.querySelector(".message"),p=document.querySelector("span");if(u.value="",s.value="",r.classList.remove("vertical"),m.removeAttribute("selected"),m.setAttribute("selected",""),c(t),"playerOne-form"===i&&(p.textContent="Player Two",a.setAttribute("id","playerTwo-form"),n(e)),"pvc"===d||"playerTwo-form"===i){a.setAttribute("style","display: none;"),h.setAttribute("style","display: none;"),n(t);const e=document.querySelector(".dialog");l.textContent="Player One`s turn!",e.showModal()}}else alert("Please place all the ships first")}))})(g,f),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),n=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(u=>{u.preventDefault();let c=n.getAttribute("data-id");if("player-Two"===c)return a(e),l(e,t,c),n.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===c){const u=r.getAttribute("class");return n.setAttribute("data-id",`player-${t.number}`),"pvc"===u?(((e,t)=>{const r=e.board,o=r.getBoard(),n=r.getMisses(),u=r.getHits(),c=document.querySelector("#play-window"),d=document.querySelector(".winner"),i=document.querySelector(".end-game");let m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()),p=!0;for(;!0===p;)if(n.find((e=>e[0]===m&&e[1]===h))||u.find((e=>e[0]===m&&e[1]===h)))m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random());else if(r.receiveAttack(m,h),null===o[m][h]){const r=`player-${t.number}`;c.setAttribute("data-id",`player-${e.number}`),a(e),l(e,t,r),p=!1}else e.board.isAllSunk()?(p=!1,i.showModal(),d.textContent="Computer won!"):(s(e.board.getBoard()[m][h],e.number),m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()))})(e,t),o.close()):(a(t),l(e,t,c),o.close())}}))})(g,f),((e,t)=>{const r=document.querySelector("form");document.querySelector("#random").addEventListener("click",(o=>{o.preventDefault(),"playerOne-form"===r.getAttribute("id")?(e.board.populateBd(),a(e)):(t.board.populateBd(),a(t))}))})(g,f),a(g),a(f),c(g),i.addEventListener("click",(e=>(e.preventDefault(),d.close()))),m.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main");var r;return(r=f).board.populateBd(),a(r),n(r),t.classList.add("pvc"),d.close()})),h.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#play-window"),o=document.querySelector("#x-coor"),n=document.querySelector("#y-coor"),l=b.querySelector(".battleship"),u=document.querySelectorAll(".square"),s=document.querySelector(".shape"),i=document.querySelector(".message"),m=document.querySelector("span");p.close(),y.setAttribute("id","playerOne-form"),y.removeAttribute("style"),t.classList.remove("pvc"),s.classList.remove("vertical"),r.setAttribute("data-id","player-Two"),u.forEach((e=>{e.removeAttribute("style")})),o.value="",n.value="",l.removeAttribute("selected"),l.setAttribute("selected",""),m.textContent="Player One",i.removeAttribute("style"),c(g),g.board.resetBoard(),f.board.resetBoard(),a(g),a(f),d.showModal()})))),b.addEventListener("change",(()=>{c(g)})),S.addEventListener("change",(()=>{const e=document.querySelector(".shape");"vertical"===S.value?e.classList.add("vertical"):e.classList.remove("vertical")})),document.addEventListener("onload",d.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQU0sa0JBQ3hCLEVBQUtpRSxnQkFBZ0IsU0FDckJoQyxFQUFLbkIsVUFBVWtELE9BQU8sT0FDdEJuQixFQUFVL0IsVUFBVWtELE9BQU8sWUFDM0JqQyxFQUFPL0IsYUFBYSxVQUFXLGNBRS9COEMsRUFBUXpGLFNBQVN1RCxJQUNmQSxFQUFPcUQsZ0JBQWdCLFFBQVEsSUFHakMxRyxFQUFFcUYsTUFBUSxHQUNWcEYsRUFBRW9GLE1BQVEsR0FDVmlCLEVBQUlJLGdCQUFnQixZQUNwQkosRUFBSTdELGFBQWEsV0FBWSxJQUU3QitELEVBQUt2QixZQUFjLGFBQ25Cc0IsRUFBUUcsZ0JBQWdCLFNBRXhCdEIsRUFBWVMsR0FDWkEsRUFBVWhILE1BQU1rRCxhQUNoQitELEVBQVVqSCxNQUFNa0QsYUFFaEJXLEVBQVltRCxHQUNabkQsRUFBWW9ELEdBQ1pOLEVBQVNOLFdBQVcsTUFJeEIsRUFBT1AsaUJBQWlCLFVBQVUsS0FDaENTLEVBQVlTLEVBQVUsSUFHeEJELEVBQVNqQixpQkFBaUIsVUFBVSxLQUNsQyxNQUFNVyxFQUFZckMsU0FBU2dCLGNBQWMsVUFFbEIsYUFBbkIyQixFQUFTUCxNQUNYQyxFQUFVL0IsVUFBVUMsSUFBSSxZQUV4QjhCLEVBQVUvQixVQUFVa0QsT0FBTyxXQUM3QixJQUdGeEQsU0FBUzBCLGlCQUFpQixTQUFVYSxFQUFTTixZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL0RPTS5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaGlwID0gKG4sIG5hbWUpID0+IHtcbiAgbGV0IHNoaXBPYmogPSB7fTtcblxuICBzaGlwT2JqW1wibmFtZVwiXSA9IG5hbWU7XG4gIHNoaXBPYmpbXCJsZW5ndGhcIl0gPSBuO1xuICBzaGlwT2JqW1wiaGl0Q291bnRcIl0gPSAwO1xuICBzaGlwT2JqW1wic3Vua1wiXSA9IGZhbHNlO1xuICBzaGlwT2JqW1wib3JpZW50YXRpb25cIl0gPSBcImhvcml6b250YWxcIjtcbiAgc2hpcE9ialtcImNvbXBcIl0gPSBbXTtcbiAgc2hpcE9ialtcImhpdENvb3JcIl0gPSBbXTtcblxuICBjb25zdCBnZXRTaGlwID0gKCkgPT4gc2hpcE9iajtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5oaXRDb3VudCArPSAxO1xuICAgIGlmIChzaGlwT2JqLmhpdENvdW50ID09PSBzaGlwT2JqLmxlbmd0aCkgc2hpcE9iai5zdW5rID0gdHJ1ZTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHNoaXBPYmouc3VuayA9PT0gdHJ1ZSA/IHRydWUgOiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCByZXNldFNoaXAgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5uYW1lID0gbmFtZTtcbiAgICBzaGlwT2JqLmxlbmd0aCA9IG47XG4gICAgc2hpcE9iai5oaXRDb3VudCA9IDA7XG4gICAgc2hpcE9iai5zdW5rID0gZmFsc2U7XG4gICAgc2hpcE9iai5vcmllbnRhdGlvbiA9IFwiaG9yaXpvbnRhbFwiO1xuICAgIHNoaXBPYmouY29tcCA9IFtdO1xuICAgIHNoaXBPYmouaGl0Q29vciA9IFtdO1xuXG4gICAgcmV0dXJuIHNoaXBPYmo7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRTaGlwLFxuICAgIGhpdCxcbiAgICBpc1N1bmssXG4gICAgcmVzZXRTaGlwLFxuICB9O1xufTtcblxuZXhwb3J0IHsgU2hpcCB9O1xuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcblxuY29uc3QgR2FtZWJvYXJkID0gKCkgPT4ge1xuICBsZXQgYm9hcmQgPSBbXTtcbiAgbGV0IG1pc3NlcyA9IFtdO1xuICBsZXQgaGl0cyA9IFtdO1xuXG4gIGxldCBhbGxTaGlwcyA9IHtcbiAgICBiYXR0bGVzaGlwOiBTaGlwKDQsIFwiYmF0dGxlc2hpcFwiKSxcbiAgICBjcnVpc2VyX0k6IFNoaXAoMywgXCJjcnVpc2VyX0lcIiksXG4gICAgY3J1aXNlcl9JSTogU2hpcCgzLCBcImNydWlzZXJfSUlcIiksXG4gICAgZGVzdHJveWVyX0k6IFNoaXAoMiwgXCJkZXN0cm95ZXJfSVwiKSxcbiAgICBkZXN0cm95ZXJfSUk6IFNoaXAoMiwgXCJkZXN0cm95ZXJfSUlcIiksXG4gICAgZGVzdHJveWVyX0lJSTogU2hpcCgyLCBcImRlc3Ryb3llcl9JSUlcIiksXG4gICAgc3VibWFyaW5lX0k6IFNoaXAoMSwgXCJzdWJtYXJpbmVfSVwiKSxcbiAgICBzdWJtYXJpbmVfSUk6IFNoaXAoMSwgXCJzdWJtYXJpbmVfSUlcIiksXG4gICAgc3VibWFyaW5lX0lJSTogU2hpcCgxLCBcInN1Ym1hcmluZV9JSUlcIiksXG4gICAgc3VibWFyaW5lX0lWOiBTaGlwKDEsIFwic3VibWFyaW5lX0lWXCIpLFxuICB9O1xuXG4gIGNvbnN0IGdldEJvYXJkID0gKCkgPT4gYm9hcmQ7XG4gIGNvbnN0IGdldE1pc3NlcyA9ICgpID0+IG1pc3NlcztcbiAgY29uc3QgZ2V0U2hpcHMgPSAoKSA9PiBhbGxTaGlwcztcbiAgY29uc3QgZ2V0SGl0cyA9ICgpID0+IGhpdHM7XG5cbiAgY29uc3QgY3JlYXRlQm9hcmQgPSAoKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBib2FyZFtpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGJvYXJkW2ldW2pdID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgaXNFbXB0eSA9ICh4LCB5KSA9PiB7XG4gICAgcmV0dXJuIGJvYXJkW3hdW3ldID09PSBudWxsID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGlzRml0ID0gKGFycikgPT4ge1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgYXJyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGlmIChpdGVtWzBdID4gOSB8fCBpdGVtWzFdID4gOSB8fCAhaXNFbXB0eShpdGVtWzBdLCBpdGVtWzFdKSlcbiAgICAgICAgcmV0dXJuIChzdGF0dXMgPSBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhdHVzO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZUNvbXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcbiAgICBjb25zdCBvcmllbnRhdGlvbiA9IHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uO1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IGEgPSB4O1xuICAgIGxldCBiID0geTtcblxuICAgIGlmIChvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgIHdoaWxlIChiICE9PSB5ICsgbGVuZ3RoKSB7XG4gICAgICAgIHRlbXAucHVzaChbeCwgYl0pO1xuICAgICAgICBiICs9IDE7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChhICE9PSB4ICsgbGVuZ3RoKSB7XG4gICAgICAgIHRlbXAucHVzaChbYSwgeV0pO1xuICAgICAgICBhICs9IDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRlbXA7XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKHgsIHksIHNoaXApID0+IHtcbiAgICBsZXQgdGVtcCA9IFtdO1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgaWYgKHkgKyBsZW5ndGggLSAxID4gOSB8fCB4ID4gOSB8fCB4ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeSA+IDkpIHtcbiAgICAgIHJldHVybiBhbGVydChcIlNoaXAgaXMgb3V0IG9mIGJvdW5kXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgIHN0YXR1cyA9IGlzRml0KHRlbXApO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXMgPT09IGZhbHNlKSB7XG4gICAgICBzdGF0dXMgPSB0cnVlO1xuICAgICAgdGVtcCA9IFtdO1xuICAgICAgcmV0dXJuIGFsZXJ0KFwic3F1YXJlIGlzIGFscmVhZHkgb2NjdXBpZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAgPSB0ZW1wO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5jb21wLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgYm9hcmRbaXRlbVswXV1baXRlbVsxXV0gPSBzaGlwO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHBvcHVsYXRlQmQgPSAoKSA9PiB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFsbFNoaXBzKTtcbiAgICBjb25zdCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xuXG4gICAga2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IHNoaXAgPSBhbGxTaGlwc1trZXldO1xuICAgICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuXG4gICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBkaXJlY3Rpb25zW3pdO1xuICAgICAgbGV0IHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgbGV0IGZpdCA9IGlzRml0KHRlbXApO1xuXG4gICAgICB3aGlsZSAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCBmaXQgPT09IGZhbHNlKSB7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgICBmaXQgPSBpc0ZpdCh0ZW1wKTtcbiAgICAgIH1cblxuICAgICAgcGxhY2VTaGlwKHgsIHksIHNoaXApO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoeCwgeSkgPT4ge1xuICAgIGlmIChib2FyZFt4XVt5XSA9PT0gbnVsbCkgbWlzc2VzLnB1c2goW3gsIHldKTtcbiAgICBlbHNlIHtcbiAgICAgIGhpdHMucHVzaChbeCwgeV0pO1xuICAgICAgYm9hcmRbeF1beV0uaGl0KCk7XG4gICAgICBib2FyZFt4XVt5XS5nZXRTaGlwKCkuaGl0Q29vci5wdXNoKFt4LCB5XSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IGlzQWxsU3VuayA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoYWxsU2hpcHMpO1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgaWYgKCFzaGlwLmlzU3VuaygpKSB7XG4gICAgICAgIHJldHVybiAoc3RhdHVzID0gZmFsc2UpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXR1cztcbiAgfTtcblxuICBjb25zdCByZXNldEJvYXJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhbGxTaGlwcyk7XG4gICAgYm9hcmQgPSBbXTtcbiAgICBtaXNzZXMgPSBbXTtcbiAgICBoaXRzID0gW107XG5cbiAgICBrZXlzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGFsbFNoaXBzW3NoaXBdLnJlc2V0U2hpcCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgY3JlYXRlQm9hcmQsXG4gICAgcGxhY2VTaGlwLFxuICAgIGdldEJvYXJkLFxuICAgIGdldFNoaXBzLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgZ2V0TWlzc2VzLFxuICAgIGdldEhpdHMsXG4gICAgaXNBbGxTdW5rLFxuICAgIHBvcHVsYXRlQmQsXG4gICAgcmVzZXRCb2FyZCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWVib2FyZCB9O1xuIiwiaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmNvbnN0IFBsYXllciA9IChudW1iZXIpID0+IHtcbiAgbGV0IHdpbiA9IGZhbHNlO1xuICBsZXQgYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgbGV0IGlzQ29tcCA9IGZhbHNlO1xuXG4gIHJldHVybiB7XG4gICAgbnVtYmVyLFxuICAgIHdpbixcbiAgICBib2FyZCxcbiAgICBpc0NvbXAsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImNvbnN0IGZpbGxTcXIgPSAocGxheWVyLCBzcXIsIHRhZywgeCwgeSkgPT4ge1xuICBjb25zdCBtaXNzZXMgPSBwbGF5ZXIuYm9hcmQuZ2V0TWlzc2VzKCk7XG5cbiAgaWYgKHNxciA9PT0gbnVsbCkge1xuICAgIGlmIChcbiAgICAgIG1pc3Nlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KVxuICAgICkge1xuICAgICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogeWVsbG93O1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogYmx1ZTtcIik7XG4gICAgfVxuICB9IGVsc2UgaWYgKFxuICAgIHNxci5nZXRTaGlwKCkuaGl0Q29vci5maW5kKChpdGVtKSA9PiB7XG4gICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgIH0pXG4gICkge1xuICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG4gIH1cbn07XG5cbmNvbnN0IHJlbmRlclNoaXAgPSAocGxheWVyKSA9PiB7XG4gIGxldCBib2FyZCA9IHBsYXllci5ib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBzaGlwc09iaiA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpO1xuICBjb25zdCBzaGlwc0xpc3QgPSBPYmplY3Qua2V5cyhzaGlwc09iaik7XG5cbiAgc2hpcHNMaXN0LmZvckVhY2goKHNoaXApID0+IHtcbiAgICBjb25zdCBjb21wID0gc2hpcHNPYmpbc2hpcF0uZ2V0U2hpcCgpLmNvbXA7XG5cbiAgICBpZiAoY29tcC5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnN0IHhDb29yID0gY29tcFswXVswXTtcbiAgICAgIGNvbnN0IHlDb29yID0gY29tcFswXVsxXTtcbiAgICAgIHBsYXllci5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwc09ialtzaGlwXSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gYm9hcmQ7XG59O1xuXG5jb25zdCByZW5kZXJCb2FyZCA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLmNyZWF0ZUJvYXJkKCk7XG5cbiAgcmVuZGVyU2hpcChwbGF5ZXIpO1xuXG4gIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHBsYXllck51bSA9IHBsYXllci5udW1iZXI7XG4gIGxldCBjdXJyZW50Qm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgYm9hcmQke3BsYXllck51bX1gKTtcblxuICB3aGlsZSAoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpXG4gICAgY3VycmVudEJvYXJkLnJlbW92ZUNoaWxkKGN1cnJlbnRCb2FyZC5sYXN0RWxlbWVudENoaWxkKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBib2FyZC5sZW5ndGg7IGorKykge1xuICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BsYXllck51bX0tc3F1YXJlYCk7XG5cbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIiwgYCR7aX1gKTtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIiwgYCR7an1gKTtcblxuICAgICAgZmlsbFNxcihwbGF5ZXIsIGJvYXJkW2ldW2pdLCBzcXVhcmUsIGksIGopO1xuXG4gICAgICBjdXJyZW50Qm9hcmQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gY3VycmVudEJvYXJkO1xufTtcblxuY29uc3QgaW5pdFBsYWNlU2hpcCA9IChwT25lLCBwVHdvKSA9PiB7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGFjZVNoaXBCdG5gKTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJmb3JtXCIpO1xuICAgIGxldCBpZCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICBjb25zdCB4Q29vciA9IHBhcnNlSW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCN5LWNvb3JgKS52YWx1ZSk7XG4gICAgY29uc3QgeUNvb3IgPSBwYXJzZUludChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjeC1jb29yYCkudmFsdWUpO1xuICAgIGNvbnN0IHNoaXBOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3NoaXBzYCkudmFsdWU7XG5cbiAgICBjb25zdCBvcmllbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjb3JpZW50YXRpb25gKS52YWx1ZTtcblxuICAgIGxldCBzaGlwO1xuICAgIGlkID09PSBcInBsYXllck9uZS1mb3JtXCJcbiAgICAgID8gKHNoaXAgPSBwT25lLmJvYXJkLmdldFNoaXBzKClbc2hpcE5hbWVdKVxuICAgICAgOiAoc2hpcCA9IHBUd28uYm9hcmQuZ2V0U2hpcHMoKVtzaGlwTmFtZV0pO1xuXG4gICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBvcmllbnQ7XG5cbiAgICBpZiAoTnVtYmVyLmlzTmFOKHhDb29yKSB8fCBOdW1iZXIuaXNOYU4oeUNvb3IpKSByZXR1cm47XG4gICAgZWxzZSB7XG4gICAgICBpZiAoaWQgPT09IFwicGxheWVyT25lLWZvcm1cIikge1xuICAgICAgICBwT25lLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXApO1xuICAgICAgICByZW5kZXJCb2FyZChwT25lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBUd28uYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcCk7XG4gICAgICAgIHJlbmRlckJvYXJkKHBUd28pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBpbml0RmluU2V0dXAgPSAocE9uZSwgcFR3bykgPT4ge1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNmaW5CdG5gKTtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGZvcm1gKTtcbiAgY29uc3QgcGxheWVyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLW5hbWVcIik7XG5cbiAgbGV0IGlzQWxsUGxhY2VkID0gZmFsc2U7XG5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGxldCBzaGlwc09iajtcbiAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICBsZXQgaWQgPSBmb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuXG4gICAgaWQgPT09IFwicGxheWVyT25lLWZvcm1cIlxuICAgICAgPyAoc2hpcHNPYmogPSBwT25lLmJvYXJkLmdldFNoaXBzKCkpXG4gICAgICA6IChzaGlwc09iaiA9IHBUd28uYm9hcmQuZ2V0U2hpcHMoKSk7XG5cbiAgICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoc2hpcHNPYmopO1xuXG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgY29uc3QgY29tcCA9IHNoaXAuZ2V0U2hpcCgpLmNvbXA7XG4gICAgICBpZiAoY29tcC5sZW5ndGggPT09IDApIHJldHVybiAoaXNBbGxQbGFjZWQgPSBmYWxzZSk7XG4gICAgICBlbHNlIHJldHVybiAoaXNBbGxQbGFjZWQgPSB0cnVlKTtcbiAgICB9KTtcblxuICAgIGlmIChpc0FsbFBsYWNlZCkge1xuICAgICAgY29uc3Qgc2hhcGVDb250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGFwZVwiKTtcbiAgICAgIGNvbnN0IHNoaXBzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzaGlwc1wiKTtcbiAgICAgIGNvbnN0IHggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3gtY29vclwiKTtcbiAgICAgIGNvbnN0IHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ktY29vclwiKTtcbiAgICAgIGNvbnN0IG9wdCA9IHNoaXBzLnF1ZXJ5U2VsZWN0b3IoXCIuYmF0dGxlc2hpcFwiKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lc3NhZ2VcIik7XG4gICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInNwYW5cIik7XG5cbiAgICAgIHgudmFsdWUgPSBcIlwiO1xuICAgICAgeS52YWx1ZSA9IFwiXCI7XG4gICAgICBzaGFwZUNvbnQuY2xhc3NMaXN0LnJlbW92ZShcInZlcnRpY2FsXCIpO1xuICAgICAgb3B0LnJlbW92ZUF0dHJpYnV0ZShcInNlbGVjdGVkXCIpO1xuICAgICAgb3B0LnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIFwiXCIpO1xuICAgICAgcmVuZGVyU2hhcGUocFR3byk7XG5cbiAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiKSB7XG4gICAgICAgIHNwYW4udGV4dENvbnRlbnQgPSBcIlBsYXllciBUd29cIjtcbiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInBsYXllclR3by1mb3JtXCIpO1xuICAgICAgICBoaWRlQm9hcmQocE9uZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiIHx8IGlkID09PSBcInBsYXllclR3by1mb3JtXCIpIHtcbiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmU7XCIpO1xuICAgICAgICBtZXNzYWdlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZGlzcGxheTogbm9uZTtcIik7XG4gICAgICAgIGhpZGVCb2FyZChwVHdvKTtcbiAgICAgICAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gICAgICAgIHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBPbmVgcyB0dXJuIVwiO1xuICAgICAgICBkaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KFwiUGxlYXNlIHBsYWNlIGFsbCB0aGUgc2hpcHMgZmlyc3RcIik7XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IGhpZGVCb2FyZCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHtwbGF5ZXIubnVtYmVyfS1zcXVhcmVgKTtcblxuICBzcXVhcmVzLmZvckVhY2goKHNxdWFyZSkgPT4ge1xuICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBncmF5O1wiKTtcbiAgfSk7XG59O1xuXG5jb25zdCBpbml0cGxheUJ0biA9IChQT25lLCBQVHdvKSA9PiB7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcbiAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gIGNvbnN0IHBsYXlXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBjb25zdCBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5XCIpO1xuXG4gIHBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGxldCBwbGF5ZXIgPSBwbGF5V2luZG93LmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG5cbiAgICBpZiAocGxheWVyID09PSBcInBsYXllci1Ud29cIikge1xuICAgICAgcmVuZGVyQm9hcmQoUE9uZSk7XG4gICAgICByZW5kZXJQbGF5QmQoUE9uZSwgUFR3bywgcGxheWVyKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UE9uZS5udW1iZXJ9YCk7XG4gICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgfSBlbHNlIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UFR3by5udW1iZXJ9YCk7XG4gICAgICBpZiAobW9kZSA9PT0gXCJwdmNcIikge1xuICAgICAgICBhdXRvQXRrKFBPbmUsIFBUd28pO1xuICAgICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZW5kZXJCb2FyZChQVHdvKTtcbiAgICAgICAgcmVuZGVyUGxheUJkKFBPbmUsIFBUd28sIHBsYXllcik7XG4gICAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgcmVuZGVyUGxheUJkID0gKHBPbmUsIHBUd28sIGlkKSA9PiB7XG4gIGxldCBib2FyZDtcbiAgbGV0IG1pc3NlcztcbiAgbGV0IGN1cnJCb2FyZDtcblxuICBpZiAoaWQgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgYm9hcmQgPSBwVHdvLmJvYXJkLmdldEJvYXJkKCk7XG4gICAgbWlzc2VzID0gcFR3by5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgICBjdXJyQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYm9hcmQke3BUd28ubnVtYmVyfWApO1xuICB9IGVsc2Uge1xuICAgIGJvYXJkID0gcE9uZS5ib2FyZC5nZXRCb2FyZCgpO1xuICAgIG1pc3NlcyA9IHBPbmUuYm9hcmQuZ2V0TWlzc2VzKCk7XG4gICAgY3VyckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2JvYXJkJHtwT25lLm51bWJlcn1gKTtcbiAgfVxuXG4gIHdoaWxlIChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyQm9hcmQucmVtb3ZlQ2hpbGQoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBpdGVtID0gYm9hcmRbaV1bal07XG5cbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICBpZiAoaWQgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BPbmUubnVtYmVyfS1zcXVhcmVgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BUd28ubnVtYmVyfS1zcXVhcmVgKTtcbiAgICAgIH1cblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBpbml0U3FyQnRuKHBPbmUsIHBUd28sIHNxdWFyZSk7XG5cbiAgICAgIGlmIChcbiAgICAgICAgaXRlbSAhPT0gbnVsbCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb3VudCA+IDAgJiZcbiAgICAgICAgaXRlbS5nZXRTaGlwKCkuaGl0Q29vci5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IGkgJiYgaXRlbVsxXSA9PT0gajtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyZWVuO1wiKTtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgICAgfVxuXG4gICAgICBjdXJyQm9hcmQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGluaXRTcXJCdG4gPSAocE9uZSwgcFR3bywgc3F1YXJlKSA9PiB7XG4gIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICBjb25zdCB4ID0gcGFyc2VJbnQoc3F1YXJlLmdldEF0dHJpYnV0ZShcImRhdGEteFwiKSk7XG4gIGNvbnN0IHkgPSBwYXJzZUludChzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS15XCIpKTtcbiAgY29uc3Qgd2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aW5uZXJcIik7XG4gIGNvbnN0IGVuZE1zZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZW5kLWdhbWVcIik7XG4gIGNvbnN0IHdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHBsYXllck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllci1uYW1lXCIpO1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG5cbiAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBzcXVhcmVJZCA9IHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICBjb25zdCBpZCA9IHdpbmRvdy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgIGxldCBib2FyZDtcbiAgICBsZXQgYm9hcmRMaXN0O1xuXG4gICAgaWYgKHNxdWFyZUlkID09PSBcIk9uZS1zcXVhcmVcIikge1xuICAgICAgYm9hcmQgPSBwT25lLmJvYXJkO1xuICAgIH0gZWxzZSB7XG4gICAgICBib2FyZCA9IHBUd28uYm9hcmQ7XG4gICAgfVxuXG4gICAgYm9hcmRMaXN0ID0gYm9hcmQuZ2V0Qm9hcmQoKTtcblxuICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG4gICAgaWYgKGJvYXJkTGlzdFt4XVt5XSA9PT0gbnVsbCkge1xuICAgICAgaWYgKHNxdWFyZUlkID09PSBcIk9uZS1zcXVhcmVcIikge1xuICAgICAgICBoaWRlQm9hcmQocFR3byk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoaWRlQm9hcmQocE9uZSk7XG4gICAgICB9XG5cbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHllbGxvdztcIik7XG5cbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICAgIHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyYHMgdHVybiFcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlkID09PSBcInBsYXllci1PbmVcIlxuICAgICAgICAgID8gKHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBUd29gcyB0dXJuIVwiKVxuICAgICAgICAgIDogKHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBPbmVgcyB0dXJuIVwiKTtcbiAgICAgIH1cblxuICAgICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc3F1YXJlSWQgPT09IFwiT25lLXNxdWFyZVwiKSB7XG4gICAgICAgIHVwZGF0ZVNoaXBsaXN0KGJvYXJkTGlzdFt4XVt5XSwgcE9uZS5udW1iZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXBkYXRlU2hpcGxpc3QoYm9hcmRMaXN0W3hdW3ldLCBwVHdvLm51bWJlcik7XG4gICAgICB9XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuXG4gICAgICBpZiAoYm9hcmQuaXNBbGxTdW5rKCkpIHtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICAgICAgZW5kTXNnLnNob3dNb2RhbCgpO1xuICAgICAgICBpZiAoaWQgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gYENvbmdyYXR1bGF0aW9ucyBQbGF5ZXIgVHdvIWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gYENvbmdyYXR1bGF0aW9ucyBQbGF5ZXIgT25lIWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgY29tcE1vZGUgPSAocGxheWVyKSA9PiB7XG4gIHBsYXllci5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gIHJlbmRlckJvYXJkKHBsYXllcik7XG4gIGhpZGVCb2FyZChwbGF5ZXIpO1xufTtcblxuY29uc3QgYXV0b0F0ayA9IChwbGF5T25lLCBwbGF5VHdvKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gcGxheU9uZS5ib2FyZDtcbiAgY29uc3QgYm9hcmRMaXN0ID0gYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgbWlzc2VzID0gYm9hcmQuZ2V0TWlzc2VzKCk7XG4gIGNvbnN0IGhpdHMgPSBib2FyZC5nZXRIaXRzKCk7XG4gIGNvbnN0IHBsYXlXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndpbm5lclwiKTtcbiAgY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbiAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICBsZXQgY29udCA9IHRydWU7XG5cbiAgd2hpbGUgKGNvbnQgPT09IHRydWUpIHtcbiAgICBpZiAoXG4gICAgICBtaXNzZXMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgICAgfSkgfHxcbiAgICAgIGhpdHMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgICAgfSlcbiAgICApIHtcbiAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcblxuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIGNvbnN0IGlkID0gYHBsYXllci0ke3BsYXlUd28ubnVtYmVyfWA7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke3BsYXlPbmUubnVtYmVyfWApO1xuICAgICAgcmVuZGVyQm9hcmQocGxheU9uZSk7XG4gICAgICByZW5kZXJQbGF5QmQocGxheU9uZSwgcGxheVR3bywgaWQpO1xuICAgICAgY29udCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocGxheU9uZS5ib2FyZC5pc0FsbFN1bmsoKSkge1xuICAgICAgICBjb250ID0gZmFsc2U7XG4gICAgICAgIGVuZE1zZy5zaG93TW9kYWwoKTtcbiAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gXCJDb21wdXRlciB3b24hXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1cGRhdGVTaGlwbGlzdChwbGF5T25lLmJvYXJkLmdldEJvYXJkKClbeF1beV0sIHBsYXlPbmUubnVtYmVyKTtcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGluaXRSYW5kQnRuID0gKHBPbmUsIHBUd28pID0+IHtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJmb3JtXCIpO1xuICBjb25zdCByYW5kQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyYW5kb21cIik7XG5cbiAgcmFuZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBpZCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICBpZiAoaWQgPT09IFwicGxheWVyT25lLWZvcm1cIikge1xuICAgICAgcE9uZS5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gICAgICByZW5kZXJCb2FyZChwT25lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcFR3by5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gICAgICByZW5kZXJCb2FyZChwVHdvKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgcmVuZGVyU2hhcGUgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzaGlwc1wiKTtcbiAgY29uc3QgbmFtZSA9IHNlbGVjdGVkLnZhbHVlO1xuICBjb25zdCBzaGlwID0gc2hpcHNPYmpbbmFtZV07XG4gIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcbiAgY29uc3Qgc2hhcGVDb250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGFwZVwiKTtcblxuICB3aGlsZSAoc2hhcGVDb250Lmxhc3RFbGVtZW50Q2hpbGQpXG4gICAgc2hhcGVDb250LnJlbW92ZUNoaWxkKHNoYXBlQ29udC5sYXN0RWxlbWVudENoaWxkKTtcblxuICBmb3IgKGxldCBpID0gMTsgaSA8PSBsZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVcIik7XG4gICAgc2hhcGVDb250LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gIH1cbn07XG5cbmNvbnN0IHVwZGF0ZVNoaXBsaXN0ID0gKHNoaXAsIG51bWJlcikgPT4ge1xuICBjb25zdCBuYW1lID0gc2hpcC5nZXRTaGlwKCkubmFtZTtcbiAgY29uc3Qgc2hpcHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnNoaXBsaXN0LSR7bnVtYmVyfWApO1xuICBjb25zdCBzaGlwQ29udCA9IHNoaXBzTGlzdC5xdWVyeVNlbGVjdG9yKGAuJHtuYW1lfWApO1xuICBjb25zdCBzcXVhcmVzID0gc2hpcENvbnQucXVlcnlTZWxlY3RvckFsbChcIi5zcXVhcmVcIik7XG4gIGNvbnN0IHRlbXAgPSBbXTtcblxuICBpZiAoc2hpcC5pc1N1bmsoKSkge1xuICAgIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgIH0pO1xuICB9XG59O1xuXG5leHBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG4gIGluaXRSYW5kQnRuLFxuICByZW5kZXJTaGFwZSxcbn07XG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7XG4gIHJlbmRlckJvYXJkLFxuICBpbml0UGxhY2VTaGlwLFxuICBpbml0RmluU2V0dXAsXG4gIGluaXRwbGF5QnRuLFxuICBjb21wTW9kZSxcbiAgaW5pdFJhbmRCdG4sXG4gIHJlbmRlclNoYXBlLFxufSBmcm9tIFwiLi9ET01cIjtcblxuY29uc3QgZ2FtZU1vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbWVfbW9kZVwiKTtcbmNvbnN0IHB2cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZwXCIpO1xuY29uc3QgcHZjQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwdmNcIik7XG5jb25zdCByZXN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXN0YXJ0XCIpO1xuY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbmNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2hpcHNcIik7XG5jb25zdCBzZWxlY3RPciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3JpZW50YXRpb25cIik7XG5sZXQgcGxheWVyT25lID0gUGxheWVyKFwiT25lXCIpO1xubGV0IHBsYXllclR3byA9IFBsYXllcihcIlR3b1wiKTtcblxuaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5pbml0RmluU2V0dXAocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdHBsYXlCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdFJhbmRCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xucmVuZGVyQm9hcmQocGxheWVyT25lKTtcbnJlbmRlckJvYXJkKHBsYXllclR3byk7XG5yZW5kZXJTaGFwZShwbGF5ZXJPbmUpO1xuXG5wdnBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucHZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcblxuICBjb21wTW9kZShwbGF5ZXJUd28pO1xuXG4gIG1haW4uY2xhc3NMaXN0LmFkZChcInB2Y1wiKTtcblxuICByZXR1cm4gZ2FtZU1vZGUuY2xvc2UoKTtcbn0pO1xuXG5yZXN0YXJ0QnRuLmZvckVhY2goKGJ1dHRvbikgPT5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gICAgY29uc3Qgd2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgICBjb25zdCB4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN4LWNvb3JcIik7XG4gICAgY29uc3QgeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeS1jb29yXCIpO1xuICAgIGNvbnN0IG9wdCA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKFwiLmJhdHRsZXNoaXBcIik7XG4gICAgY29uc3Qgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3F1YXJlXCIpO1xuICAgIGNvbnN0IHNoYXBlQ29udCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hhcGVcIik7XG4gICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcbiAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInNwYW5cIik7XG5cbiAgICBlbmRNc2cuY2xvc2UoKTtcblxuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwbGF5ZXJPbmUtZm9ybVwiKTtcbiAgICBmb3JtLnJlbW92ZUF0dHJpYnV0ZShcInN0eWxlXCIpO1xuICAgIG1haW4uY2xhc3NMaXN0LnJlbW92ZShcInB2Y1wiKTtcbiAgICBzaGFwZUNvbnQuY2xhc3NMaXN0LnJlbW92ZShcInZlcnRpY2FsXCIpO1xuICAgIHdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIFwicGxheWVyLVR3b1wiKTtcblxuICAgIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgICBzcXVhcmUucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG4gICAgfSk7XG5cbiAgICB4LnZhbHVlID0gXCJcIjtcbiAgICB5LnZhbHVlID0gXCJcIjtcbiAgICBvcHQucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgb3B0LnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIFwiXCIpO1xuXG4gICAgc3Bhbi50ZXh0Q29udGVudCA9IFwiUGxheWVyIE9uZVwiO1xuICAgIG1lc3NhZ2UucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG5cbiAgICByZW5kZXJTaGFwZShwbGF5ZXJPbmUpO1xuICAgIHBsYXllck9uZS5ib2FyZC5yZXNldEJvYXJkKCk7XG4gICAgcGxheWVyVHdvLmJvYXJkLnJlc2V0Qm9hcmQoKTtcblxuICAgIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gICAgcmVuZGVyQm9hcmQocGxheWVyVHdvKTtcbiAgICBnYW1lTW9kZS5zaG93TW9kYWwoKTtcbiAgfSlcbik7XG5cbnNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgcmVuZGVyU2hhcGUocGxheWVyT25lKTtcbn0pO1xuXG5zZWxlY3RPci5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgY29uc3Qgc2hhcGVDb250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGFwZVwiKTtcblxuICBpZiAoc2VsZWN0T3IudmFsdWUgPT09IFwidmVydGljYWxcIikge1xuICAgIHNoYXBlQ29udC5jbGFzc0xpc3QuYWRkKFwidmVydGljYWxcIik7XG4gIH0gZWxzZSB7XG4gICAgc2hhcGVDb250LmNsYXNzTGlzdC5yZW1vdmUoXCJ2ZXJ0aWNhbFwiKTtcbiAgfVxufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxvYWRcIiwgZ2FtZU1vZGUuc2hvd01vZGFsKCkpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJuIiwibmFtZSIsInNoaXBPYmoiLCJnZXRTaGlwIiwiaGl0IiwiaGl0Q291bnQiLCJsZW5ndGgiLCJzdW5rIiwiaXNTdW5rIiwicmVzZXRTaGlwIiwib3JpZW50YXRpb24iLCJjb21wIiwiaGl0Q29vciIsIkdhbWVib2FyZCIsImJvYXJkIiwibWlzc2VzIiwiaGl0cyIsImFsbFNoaXBzIiwiYmF0dGxlc2hpcCIsImNydWlzZXJfSSIsImNydWlzZXJfSUkiLCJkZXN0cm95ZXJfSSIsImRlc3Ryb3llcl9JSSIsImRlc3Ryb3llcl9JSUkiLCJzdWJtYXJpbmVfSSIsInN1Ym1hcmluZV9JSSIsInN1Ym1hcmluZV9JSUkiLCJzdWJtYXJpbmVfSVYiLCJpc0ZpdCIsImFyciIsInN0YXR1cyIsImZvckVhY2giLCJpdGVtIiwieCIsInkiLCJjcmVhdGVDb21wIiwic2hpcCIsInRlbXAiLCJhIiwiYiIsInB1c2giLCJwbGFjZVNoaXAiLCJhbGVydCIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJnZXRCb2FyZCIsImdldFNoaXBzIiwicmVjZWl2ZUF0dGFjayIsImdldE1pc3NlcyIsImdldEhpdHMiLCJpc0FsbFN1bmsiLCJzaGlwcyIsIk9iamVjdCIsInZhbHVlcyIsInBvcHVsYXRlQmQiLCJrZXlzIiwiZGlyZWN0aW9ucyIsImtleSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInoiLCJmaXQiLCJyZXNldEJvYXJkIiwiUGxheWVyIiwibnVtYmVyIiwid2luIiwiaXNDb21wIiwiZmlsbFNxciIsInBsYXllciIsInNxciIsInRhZyIsImZpbmQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJCb2FyZCIsInNoaXBzT2JqIiwieENvb3IiLCJ5Q29vciIsInJlbmRlclNoaXAiLCJwbGF5ZXJOdW0iLCJjdXJyZW50Qm9hcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibGFzdEVsZW1lbnRDaGlsZCIsInJlbW92ZUNoaWxkIiwic3F1YXJlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiaGlkZUJvYXJkIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbmRlclBsYXlCZCIsInBPbmUiLCJwVHdvIiwiaWQiLCJjdXJyQm9hcmQiLCJxdWVyeVNlbGVjdG9yIiwiaW5pdFNxckJ0biIsImRpYWxvZyIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwid2lubmVyIiwiZW5kTXNnIiwid2luZG93IiwicGxheWVyTmFtZSIsIm1haW4iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic3F1YXJlSWQiLCJtb2RlIiwiYm9hcmRMaXN0IiwidGV4dENvbnRlbnQiLCJzaG93TW9kYWwiLCJ1cGRhdGVTaGlwbGlzdCIsInJlbmRlclNoYXBlIiwidmFsdWUiLCJzaGFwZUNvbnQiLCJzcXVhcmVzIiwiZ2FtZU1vZGUiLCJwdnBCdG4iLCJwdmNCdG4iLCJyZXN0YXJ0QnRuIiwic2VsZWN0T3IiLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iLCJzaGlwTmFtZSIsIm9yaWVudCIsIk51bWJlciIsImlzTmFOIiwiYnV0dG9uIiwiZm9ybSIsImlzQWxsUGxhY2VkIiwib3B0IiwibWVzc2FnZSIsInNwYW4iLCJyZW1vdmUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbml0RmluU2V0dXAiLCJQT25lIiwiUFR3byIsInBsYXlXaW5kb3ciLCJjbG9zZSIsInBsYXlPbmUiLCJwbGF5VHdvIiwiY29udCIsImF1dG9BdGsiLCJpbml0cGxheUJ0biIsImluaXRSYW5kQnRuIl0sInNvdXJjZVJvb3QiOiIifQ==