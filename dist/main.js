(()=>{"use strict";const e=(e,t)=>{let r={};return r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],{getShip:()=>r,hit:()=>{r.hitCount+=1,r.hitCount===r.length&&(r.sunk=!0)},isSunk:()=>!0===r.sunk,resetShip:()=>(r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],r)}},t=()=>{let t=[],r=[],o=[],n={battleship:e(4,"battleship"),cruiser_I:e(3,"cruiser_I"),cruiser_II:e(3,"cruiser_II"),destroyer_I:e(2,"destroyer_I"),destroyer_II:e(2,"destroyer_II"),destroyer_III:e(2,"destroyer_III"),submarine_I:e(1,"submarine_I"),submarine_II:e(1,"submarine_II"),submarine_III:e(1,"submarine_III"),submarine_IV:e(1,"submarine_IV")};const a=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],n=e[1],null!==t[o][n]))return r=!1;var o,n})),r},l=(e,t,r)=>{const o=r.getShip().length;let n=[],a=e,l=t;if("horizontal"===r.getShip().orientation)for(;l!==t+o;)n.push([e,l]),l+=1;else for(;a!==e+o;)n.push([a,t]),a+=1;return n},u=(e,r,o)=>{let n=[],u=!0;return r+length-1>9||e>9||e+length-1>9||r>9?alert("Ship is out of bound"):(n=l(e,r,o),u=a(n),!1===u?(u=!0,n=[],alert("square is already occupied")):(o.getShip().comp=n,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:u,getBoard:()=>t,getShips:()=>n,receiveAttack:(e,n)=>(null===t[e][n]?r.push([e,n]):(o.push([e,n]),t[e][n].hit(),t[e][n].getShip().hitCoor.push([e,n])),t),getMisses:()=>r,getHits:()=>o,isAllSunk:()=>{const e=Object.values(n);let t=!0;return e.forEach((e=>{if(!e.isSunk())return t=!1})),t},populateBd:()=>{const e=Object.keys(n),r=["horizontal","vertical"];return e.forEach((e=>{const t=n[e],o=t.getShip().length;let c=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),d=Math.floor(2*Math.random());t.getShip().orientation=r[d];let i=l(c,s,t),m=a(i);for(;s+o-1>9||c+o-1>9||!1===m;)c=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),d=Math.floor(2*Math.random()),t.getShip().orientation=r[d],i=l(c,s,t),m=a(i);u(c,s,t)})),t},resetBoard:()=>{const e=Object.keys(n);t=[],r=[],o=[],e.forEach((e=>{n[e].resetShip()}))}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,n)=>{const a=e.board.getMisses();null===t?a.find((e=>e[0]===o&&e[1]===n))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===n))&&r.setAttribute("style","background-color: red;")},n=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const n=o[0][0],a=o[0][1];e.board.placeShip(n,a,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let n=document.getElementById(`board${r}`);for(;n.lastElementChild;)n.removeChild(n.lastElementChild);for(let a=0;a<t.length;a++)for(let l=0;l<t.length;l++){const u=document.createElement("div");u.classList.add(`${r}-square`),u.setAttribute("data-x",`${a}`),u.setAttribute("data-y",`${l}`),o(e,t[a][l],u,a,l),n.appendChild(u)}return n},a=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},l=(e,t,r)=>{let o,n,a;for("player-Two"===r?(o=t.board.getBoard(),n=t.board.getMisses(),a=document.querySelector(`#board${t.number}`)):(o=e.board.getBoard(),n=e.board.getMisses(),a=document.querySelector(`#board${e.number}`));a.lastElementChild;)a.removeChild(a.lastElementChild);for(let l=0;l<o.length;l++)for(let c=0;c<o.length;c++){const s=o[l][c],d=document.createElement("button");"player-One"===r?d.classList.add(`${e.number}-square`):d.classList.add(`${t.number}-square`),d.setAttribute("data-x",`${l}`),d.setAttribute("data-y",`${c}`),u(e,t,d),null!==s&&s.getShip().hitCount>0&&s.getShip().hitCoor.find((e=>e[0]===l&&e[1]===c))&&(d.setAttribute("style","background-color: red;"),d.setAttribute("disabled","")),n.find((e=>e[0]===l&&e[1]===c))&&(d.setAttribute("style","background-color: green;"),d.setAttribute("disabled","")),a.appendChild(d)}},u=(e,t,r)=>{const o=document.querySelector(".dialog"),n=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y")),u=document.querySelector(".winner"),c=document.querySelector(".end-game"),d=document.querySelector("#play-window"),i=document.querySelector(".player-name"),m=document.querySelector("main");r.addEventListener("click",(h=>{h.preventDefault();const p=r.getAttribute("class"),b=d.getAttribute("data-id"),y=m.getAttribute("class");let S,g;S="One-square"===p?e.board:t.board,g=S.getBoard(),S.receiveAttack(n,l),null===g[n][l]?(a("One-square"===p?t:e),r.setAttribute("style","background-color: yellow;"),i.textContent="pvc"===y?"Computer`s turn!":"player-One"===b?"Player Two`s turn!":"Player One`s turn!",o.showModal()):(s(g[n][l],"One-square"===p?e.number:t.number),r.setAttribute("style","background-color: red;"),S.isAllSunk()&&(r.setAttribute("style","background-color: red;"),c.showModal(),u.textContent="player-Two"===b?"Congratulations Player Two!":"Congratulations Player One!"))}))},c=e=>{const t=e.board.getShips()[document.querySelector("#ships").value].getShip().length,r=document.querySelector(".shape");for(let e=1;e<=t;e++){const e=document.createElement("div");e.classList.add("square"),r.appendChild(e)}},s=(e,t)=>{const r=e.getShip().name,o=document.querySelector(`.shiplist-${t}`).querySelector(`.${r}`).querySelectorAll(".square");e.isSunk()&&o.forEach((e=>{e.setAttribute("style","background-color: red;")}))},d=document.querySelector(".game_mode"),i=document.querySelector("#pvp"),m=document.querySelector("#pvc"),h=document.querySelectorAll(".restart"),p=document.querySelector(".end-game"),b=document.querySelector("form"),y=document.querySelector("#ships");let S=r("One"),g=r("Two");var f,q;f=S,q=g,document.querySelector("#placeShipBtn").addEventListener("click",(e=>{e.preventDefault();let t=document.querySelector("form").getAttribute("id");const r=parseInt(document.querySelector("#y-coor").value),o=parseInt(document.querySelector("#x-coor").value),a=document.querySelector("#ships").value,l=document.querySelector("#orientation").value;let u;u="playerOne-form"===t?f.board.getShips()[a]:q.board.getShips()[a],u.getShip().orientation=l,Number.isNaN(r)||Number.isNaN(o)||("playerOne-form"===t?(f.board.placeShip(r,o,u),n(f)):(q.board.placeShip(r,o,u),n(q)))})),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector("#finBtn"),n=document.querySelector("form"),l=document.querySelector(".player-name");let u=!1;o.addEventListener("click",(o=>{let c;o.preventDefault();const s=r.getAttribute("class");let d=n.getAttribute("id");if(c="playerOne-form"===d?e.board.getShips():t.board.getShips(),Object.values(c).forEach((e=>{const t=e.getShip().comp;return u=0!==t.length})),u){const r=document.querySelector("#x-coor"),o=document.querySelector("#y-coor"),u=document.querySelector("#battleship");if(r.value="",o.value="",u.removeAttribute("selected"),u.setAttribute("selected",""),"playerOne-form"===d&&(n.setAttribute("id","playerTwo-form"),a(e)),"pvc"===s||"playerTwo-form"===d){n.setAttribute("style","display: none;"),a(t);const e=document.querySelector(".dialog");l.textContent="Player One`s turn!",e.showModal()}}else alert("Please place all the ships first")}))})(S,g),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),a=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(u=>{u.preventDefault();let c=a.getAttribute("data-id");if("player-Two"===c)return n(e),l(e,t,c),a.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===c){const u=r.getAttribute("class");return a.setAttribute("data-id",`player-${t.number}`),"pvc"===u?(((e,t)=>{const r=e.board,o=r.getBoard(),a=r.getMisses(),u=r.getHits(),c=document.querySelector("#play-window"),d=document.querySelector(".winner"),i=document.querySelector(".end-game");let m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()),p=!0;for(;!0===p;)if(a.find((e=>e[0]===m&&e[1]===h))||u.find((e=>e[0]===m&&e[1]===h)))m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random());else if(r.receiveAttack(m,h),null===o[m][h]){const r=`player-${t.number}`;c.setAttribute("data-id",`player-${e.number}`),n(e),l(e,t,r),p=!1}else e.board.isAllSunk()?(p=!1,i.showModal(),d.textContent="Computer won!"):(s(e.board.getBoard()[m][h],e.number),m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()))})(e,t),o.close()):(n(t),l(e,t,c),o.close())}}))})(S,g),((e,t)=>{const r=document.querySelector("form");document.querySelector("#random").addEventListener("click",(o=>{o.preventDefault(),"playerOne-form"===r.getAttribute("id")?(e.board.populateBd(),n(e)):(t.board.populateBd(),n(t))}))})(S,g),n(S),n(g),c(S),i.addEventListener("click",(e=>(e.preventDefault(),d.close()))),m.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main");var r;return(r=g).board.populateBd(),n(r),a(r),t.classList.add("pvc"),d.close()})),h.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#play-window"),o=document.querySelector("#x-coor"),a=document.querySelector("#y-coor"),l=document.querySelector("#battleship"),u=document.querySelectorAll(".square");p.close(),b.setAttribute("id","playerOne-form"),b.removeAttribute("style"),t.classList.remove("pvc"),r.setAttribute("data-id","player-Two"),u.forEach((e=>{e.removeAttribute("style")})),o.value="",a.value="",l.removeAttribute("selected"),l.setAttribute("selected",""),S.board.resetBoard(),g.board.resetBoard(),n(S),n(g),d.showModal()})))),y.addEventListener("change",(()=>{const e=document.querySelector(".shape");for(;e.lastElementChild;)e.removeChild(e.lastElementChild);c(S)})),document.addEventListener("onload",d.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y0FBYyxVQUV6QyxLQUFPcUIsRUFBVW5DLGtCQUNmbUMsRUFBVWxDLFlBQVlrQyxFQUFVbkMsa0JBRWxDaUMsRUFBWVEsRUFBVSxJQUd4QjNDLFNBQVMwQixpQkFBaUIsU0FBVWEsRUFBU04sWSIsInNvdXJjZXMiOlsid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9ET00uanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IChuLCBuYW1lKSA9PiB7XG4gIGxldCBzaGlwT2JqID0ge307XG5cbiAgc2hpcE9ialtcIm5hbWVcIl0gPSBuYW1lO1xuICBzaGlwT2JqW1wibGVuZ3RoXCJdID0gbjtcbiAgc2hpcE9ialtcImhpdENvdW50XCJdID0gMDtcbiAgc2hpcE9ialtcInN1bmtcIl0gPSBmYWxzZTtcbiAgc2hpcE9ialtcIm9yaWVudGF0aW9uXCJdID0gXCJob3Jpem9udGFsXCI7XG4gIHNoaXBPYmpbXCJjb21wXCJdID0gW107XG4gIHNoaXBPYmpbXCJoaXRDb29yXCJdID0gW107XG5cbiAgY29uc3QgZ2V0U2hpcCA9ICgpID0+IHNoaXBPYmo7XG5cbiAgY29uc3QgaGl0ID0gKCkgPT4ge1xuICAgIHNoaXBPYmouaGl0Q291bnQgKz0gMTtcbiAgICBpZiAoc2hpcE9iai5oaXRDb3VudCA9PT0gc2hpcE9iai5sZW5ndGgpIHNoaXBPYmouc3VuayA9IHRydWU7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgIHJldHVybiBzaGlwT2JqLnN1bmsgPT09IHRydWUgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgcmVzZXRTaGlwID0gKCkgPT4ge1xuICAgIHNoaXBPYmoubmFtZSA9IG5hbWU7XG4gICAgc2hpcE9iai5sZW5ndGggPSBuO1xuICAgIHNoaXBPYmouaGl0Q291bnQgPSAwO1xuICAgIHNoaXBPYmouc3VuayA9IGZhbHNlO1xuICAgIHNoaXBPYmoub3JpZW50YXRpb24gPSBcImhvcml6b250YWxcIjtcbiAgICBzaGlwT2JqLmNvbXAgPSBbXTtcbiAgICBzaGlwT2JqLmhpdENvb3IgPSBbXTtcblxuICAgIHJldHVybiBzaGlwT2JqO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgZ2V0U2hpcCxcbiAgICBoaXQsXG4gICAgaXNTdW5rLFxuICAgIHJlc2V0U2hpcCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFNoaXAgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5cbmNvbnN0IEdhbWVib2FyZCA9ICgpID0+IHtcbiAgbGV0IGJvYXJkID0gW107XG4gIGxldCBtaXNzZXMgPSBbXTtcbiAgbGV0IGhpdHMgPSBbXTtcblxuICBsZXQgYWxsU2hpcHMgPSB7XG4gICAgYmF0dGxlc2hpcDogU2hpcCg0LCBcImJhdHRsZXNoaXBcIiksXG4gICAgY3J1aXNlcl9JOiBTaGlwKDMsIFwiY3J1aXNlcl9JXCIpLFxuICAgIGNydWlzZXJfSUk6IFNoaXAoMywgXCJjcnVpc2VyX0lJXCIpLFxuICAgIGRlc3Ryb3llcl9JOiBTaGlwKDIsIFwiZGVzdHJveWVyX0lcIiksXG4gICAgZGVzdHJveWVyX0lJOiBTaGlwKDIsIFwiZGVzdHJveWVyX0lJXCIpLFxuICAgIGRlc3Ryb3llcl9JSUk6IFNoaXAoMiwgXCJkZXN0cm95ZXJfSUlJXCIpLFxuICAgIHN1Ym1hcmluZV9JOiBTaGlwKDEsIFwic3VibWFyaW5lX0lcIiksXG4gICAgc3VibWFyaW5lX0lJOiBTaGlwKDEsIFwic3VibWFyaW5lX0lJXCIpLFxuICAgIHN1Ym1hcmluZV9JSUk6IFNoaXAoMSwgXCJzdWJtYXJpbmVfSUlJXCIpLFxuICAgIHN1Ym1hcmluZV9JVjogU2hpcCgxLCBcInN1Ym1hcmluZV9JVlwiKSxcbiAgfTtcblxuICBjb25zdCBnZXRCb2FyZCA9ICgpID0+IGJvYXJkO1xuICBjb25zdCBnZXRNaXNzZXMgPSAoKSA9PiBtaXNzZXM7XG4gIGNvbnN0IGdldFNoaXBzID0gKCkgPT4gYWxsU2hpcHM7XG4gIGNvbnN0IGdldEhpdHMgPSAoKSA9PiBoaXRzO1xuXG4gIGNvbnN0IGNyZWF0ZUJvYXJkID0gKCkgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgYm9hcmRbaV0gPSBbXTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBib2FyZFtpXVtqXSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IGlzRW1wdHkgPSAoeCwgeSkgPT4ge1xuICAgIHJldHVybiBib2FyZFt4XVt5XSA9PT0gbnVsbCA/IHRydWUgOiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBpc0ZpdCA9IChhcnIpID0+IHtcbiAgICBsZXQgc3RhdHVzID0gdHJ1ZTtcblxuICAgIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBpZiAoaXRlbVswXSA+IDkgfHwgaXRlbVsxXSA+IDkgfHwgIWlzRW1wdHkoaXRlbVswXSwgaXRlbVsxXSkpXG4gICAgICAgIHJldHVybiAoc3RhdHVzID0gZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXR1cztcbiAgfTtcblxuICBjb25zdCBjcmVhdGVDb21wID0gKHgsIHksIHNoaXApID0+IHtcbiAgICBjb25zdCBsZW5ndGggPSBzaGlwLmdldFNoaXAoKS5sZW5ndGg7XG4gICAgY29uc3Qgb3JpZW50YXRpb24gPSBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbjtcbiAgICBsZXQgdGVtcCA9IFtdO1xuICAgIGxldCBhID0geDtcbiAgICBsZXQgYiA9IHk7XG5cbiAgICBpZiAob3JpZW50YXRpb24gPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgICB3aGlsZSAoYiAhPT0geSArIGxlbmd0aCkge1xuICAgICAgICB0ZW1wLnB1c2goW3gsIGJdKTtcbiAgICAgICAgYiArPSAxO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB3aGlsZSAoYSAhPT0geCArIGxlbmd0aCkge1xuICAgICAgICB0ZW1wLnB1c2goW2EsIHldKTtcbiAgICAgICAgYSArPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0ZW1wO1xuICB9O1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9ICh4LCB5LCBzaGlwKSA9PiB7XG4gICAgbGV0IHRlbXAgPSBbXTtcbiAgICBsZXQgc3RhdHVzID0gdHJ1ZTtcblxuICAgIGlmICh5ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeCA+IDkgfHwgeCArIGxlbmd0aCAtIDEgPiA5IHx8IHkgPiA5KSB7XG4gICAgICByZXR1cm4gYWxlcnQoXCJTaGlwIGlzIG91dCBvZiBib3VuZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICBzdGF0dXMgPSBpc0ZpdCh0ZW1wKTtcbiAgICB9XG5cbiAgICBpZiAoc3RhdHVzID09PSBmYWxzZSkge1xuICAgICAgc3RhdHVzID0gdHJ1ZTtcbiAgICAgIHRlbXAgPSBbXTtcbiAgICAgIHJldHVybiBhbGVydChcInNxdWFyZSBpcyBhbHJlYWR5IG9jY3VwaWVkXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaGlwLmdldFNoaXAoKS5jb21wID0gdGVtcDtcblxuICAgICAgc2hpcC5nZXRTaGlwKCkuY29tcC5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGJvYXJkW2l0ZW1bMF1dW2l0ZW1bMV1dID0gc2hpcDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBwb3B1bGF0ZUJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhbGxTaGlwcyk7XG4gICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiXTtcblxuICAgIGtleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBjb25zdCBzaGlwID0gYWxsU2hpcHNba2V5XTtcbiAgICAgIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcblxuICAgICAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBsZXQgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGxldCB6ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XG5cbiAgICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gZGlyZWN0aW9uc1t6XTtcbiAgICAgIGxldCB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgIGxldCBmaXQgPSBpc0ZpdCh0ZW1wKTtcblxuICAgICAgd2hpbGUgKHkgKyBsZW5ndGggLSAxID4gOSB8fCB4ICsgbGVuZ3RoIC0gMSA+IDkgfHwgZml0ID09PSBmYWxzZSkge1xuICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgICB6ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XG5cbiAgICAgICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBkaXJlY3Rpb25zW3pdO1xuICAgICAgICB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgICAgZml0ID0gaXNGaXQodGVtcCk7XG4gICAgICB9XG5cbiAgICAgIHBsYWNlU2hpcCh4LCB5LCBzaGlwKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHgsIHkpID0+IHtcbiAgICBpZiAoYm9hcmRbeF1beV0gPT09IG51bGwpIG1pc3Nlcy5wdXNoKFt4LCB5XSk7XG4gICAgZWxzZSB7XG4gICAgICBoaXRzLnB1c2goW3gsIHldKTtcbiAgICAgIGJvYXJkW3hdW3ldLmhpdCgpO1xuICAgICAgYm9hcmRbeF1beV0uZ2V0U2hpcCgpLmhpdENvb3IucHVzaChbeCwgeV0pO1xuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBpc0FsbFN1bmsgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2hpcHMgPSBPYmplY3QudmFsdWVzKGFsbFNoaXBzKTtcbiAgICBsZXQgc3RhdHVzID0gdHJ1ZTtcblxuICAgIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGlmICghc2hpcC5pc1N1bmsoKSkge1xuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0dXM7XG4gIH07XG5cbiAgY29uc3QgcmVzZXRCb2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoYWxsU2hpcHMpO1xuICAgIGJvYXJkID0gW107XG4gICAgbWlzc2VzID0gW107XG4gICAgaGl0cyA9IFtdO1xuXG4gICAga2V5cy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBhbGxTaGlwc1tzaGlwXS5yZXNldFNoaXAoKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGNyZWF0ZUJvYXJkLFxuICAgIHBsYWNlU2hpcCxcbiAgICBnZXRCb2FyZCxcbiAgICBnZXRTaGlwcyxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGdldE1pc3NlcyxcbiAgICBnZXRIaXRzLFxuICAgIGlzQWxsU3VuayxcbiAgICBwb3B1bGF0ZUJkLFxuICAgIHJlc2V0Qm9hcmQsXG4gIH07XG59O1xuXG5leHBvcnQgeyBHYW1lYm9hcmQgfTtcbiIsImltcG9ydCB7IEdhbWVib2FyZCB9IGZyb20gXCIuL2dhbWVib2FyZFwiO1xuXG5jb25zdCBQbGF5ZXIgPSAobnVtYmVyKSA9PiB7XG4gIGxldCB3aW4gPSBmYWxzZTtcbiAgbGV0IGJvYXJkID0gR2FtZWJvYXJkKCk7XG4gIGxldCBpc0NvbXAgPSBmYWxzZTtcblxuICByZXR1cm4ge1xuICAgIG51bWJlcixcbiAgICB3aW4sXG4gICAgYm9hcmQsXG4gICAgaXNDb21wLFxuICB9O1xufTtcblxuZXhwb3J0IHsgUGxheWVyIH07XG4iLCJjb25zdCBmaWxsU3FyID0gKHBsYXllciwgc3FyLCB0YWcsIHgsIHkpID0+IHtcbiAgY29uc3QgbWlzc2VzID0gcGxheWVyLmJvYXJkLmdldE1pc3NlcygpO1xuXG4gIGlmIChzcXIgPT09IG51bGwpIHtcbiAgICBpZiAoXG4gICAgICBtaXNzZXMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgICAgfSlcbiAgICApIHtcbiAgICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHllbGxvdztcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGJsdWU7XCIpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChcbiAgICBzcXIuZ2V0U2hpcCgpLmhpdENvb3IuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICB9KVxuICApIHtcbiAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICB9XG59O1xuXG5jb25zdCByZW5kZXJTaGlwID0gKHBsYXllcikgPT4ge1xuICBsZXQgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3Qgc2hpcHNPYmogPSBwbGF5ZXIuYm9hcmQuZ2V0U2hpcHMoKTtcbiAgY29uc3Qgc2hpcHNMaXN0ID0gT2JqZWN0LmtleXMoc2hpcHNPYmopO1xuXG4gIHNoaXBzTGlzdC5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgY29uc3QgY29tcCA9IHNoaXBzT2JqW3NoaXBdLmdldFNoaXAoKS5jb21wO1xuXG4gICAgaWYgKGNvbXAubGVuZ3RoICE9PSAwKSB7XG4gICAgICBjb25zdCB4Q29vciA9IGNvbXBbMF1bMF07XG4gICAgICBjb25zdCB5Q29vciA9IGNvbXBbMF1bMV07XG4gICAgICBwbGF5ZXIuYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcHNPYmpbc2hpcF0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGJvYXJkO1xufTtcblxuY29uc3QgcmVuZGVyQm9hcmQgPSAocGxheWVyKSA9PiB7XG4gIHBsYXllci5ib2FyZC5jcmVhdGVCb2FyZCgpO1xuXG4gIHJlbmRlclNoaXAocGxheWVyKTtcblxuICBjb25zdCBib2FyZCA9IHBsYXllci5ib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBwbGF5ZXJOdW0gPSBwbGF5ZXIubnVtYmVyO1xuICBsZXQgY3VycmVudEJvYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYGJvYXJkJHtwbGF5ZXJOdW19YCk7XG5cbiAgd2hpbGUgKGN1cnJlbnRCb2FyZC5sYXN0RWxlbWVudENoaWxkKVxuICAgIGN1cnJlbnRCb2FyZC5yZW1vdmVDaGlsZChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmQubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwbGF5ZXJOdW19LXNxdWFyZWApO1xuXG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGF0YS14XCIsIGAke2l9YCk7XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGF0YS15XCIsIGAke2p9YCk7XG5cbiAgICAgIGZpbGxTcXIocGxheWVyLCBib2FyZFtpXVtqXSwgc3F1YXJlLCBpLCBqKTtcblxuICAgICAgY3VycmVudEJvYXJkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGN1cnJlbnRCb2FyZDtcbn07XG5cbmNvbnN0IGluaXRQbGFjZVNoaXAgPSAocE9uZSwgcFR3bykgPT4ge1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxhY2VTaGlwQnRuYCk7XG5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgICBsZXQgaWQgPSBmb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuXG4gICAgY29uc3QgeENvb3IgPSBwYXJzZUludChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjeS1jb29yYCkudmFsdWUpO1xuICAgIGNvbnN0IHlDb29yID0gcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3gtY29vcmApLnZhbHVlKTtcbiAgICBjb25zdCBzaGlwTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNzaGlwc2ApLnZhbHVlO1xuXG4gICAgY29uc3Qgb3JpZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI29yaWVudGF0aW9uYCkudmFsdWU7XG5cbiAgICBsZXQgc2hpcDtcbiAgICBpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiXG4gICAgICA/IChzaGlwID0gcE9uZS5ib2FyZC5nZXRTaGlwcygpW3NoaXBOYW1lXSlcbiAgICAgIDogKHNoaXAgPSBwVHdvLmJvYXJkLmdldFNoaXBzKClbc2hpcE5hbWVdKTtcblxuICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gb3JpZW50O1xuXG4gICAgaWYgKE51bWJlci5pc05hTih4Q29vcikgfHwgTnVtYmVyLmlzTmFOKHlDb29yKSkgcmV0dXJuO1xuICAgIGVsc2Uge1xuICAgICAgaWYgKGlkID09PSBcInBsYXllck9uZS1mb3JtXCIpIHtcbiAgICAgICAgcE9uZS5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwKTtcbiAgICAgICAgcmVuZGVyQm9hcmQocE9uZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwVHdvLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXApO1xuICAgICAgICByZW5kZXJCb2FyZChwVHdvKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgaW5pdEZpblNldHVwID0gKHBPbmUsIHBUd28pID0+IHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjZmluQnRuYCk7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBmb3JtYCk7XG4gIGNvbnN0IHBsYXllck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllci1uYW1lXCIpO1xuXG4gIGxldCBpc0FsbFBsYWNlZCA9IGZhbHNlO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBsZXQgc2hpcHNPYmo7XG4gICAgY29uc3QgbW9kZSA9IG1haW4uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG4gICAgbGV0IGlkID0gZm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcblxuICAgIGlkID09PSBcInBsYXllck9uZS1mb3JtXCJcbiAgICAgID8gKHNoaXBzT2JqID0gcE9uZS5ib2FyZC5nZXRTaGlwcygpKVxuICAgICAgOiAoc2hpcHNPYmogPSBwVHdvLmJvYXJkLmdldFNoaXBzKCkpO1xuXG4gICAgY29uc3Qgc2hpcHMgPSBPYmplY3QudmFsdWVzKHNoaXBzT2JqKTtcblxuICAgIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGNvbnN0IGNvbXAgPSBzaGlwLmdldFNoaXAoKS5jb21wO1xuICAgICAgaWYgKGNvbXAubGVuZ3RoID09PSAwKSByZXR1cm4gKGlzQWxsUGxhY2VkID0gZmFsc2UpO1xuICAgICAgZWxzZSByZXR1cm4gKGlzQWxsUGxhY2VkID0gdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpZiAoaXNBbGxQbGFjZWQpIHtcbiAgICAgIGNvbnN0IHggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3gtY29vclwiKTtcbiAgICAgIGNvbnN0IHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ktY29vclwiKTtcbiAgICAgIGNvbnN0IG9wdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYmF0dGxlc2hpcFwiKTtcblxuICAgICAgeC52YWx1ZSA9IFwiXCI7XG4gICAgICB5LnZhbHVlID0gXCJcIjtcbiAgICAgIG9wdC5yZW1vdmVBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKTtcbiAgICAgIG9wdC5zZXRBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiLCBcIlwiKTtcblxuICAgICAgaWYgKGlkID09PSBcInBsYXllck9uZS1mb3JtXCIpIHtcbiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInBsYXllclR3by1mb3JtXCIpO1xuICAgICAgICBoaWRlQm9hcmQocE9uZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiIHx8IGlkID09PSBcInBsYXllclR3by1mb3JtXCIpIHtcbiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmU7XCIpO1xuICAgICAgICBoaWRlQm9hcmQocFR3byk7XG4gICAgICAgIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICAgICAgICBwbGF5ZXJOYW1lLnRleHRDb250ZW50ID0gXCJQbGF5ZXIgT25lYHMgdHVybiFcIjtcbiAgICAgICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydChcIlBsZWFzZSBwbGFjZSBhbGwgdGhlIHNoaXBzIGZpcnN0XCIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBoaWRlQm9hcmQgPSAocGxheWVyKSA9PiB7XG4gIGxldCBzcXVhcmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7cGxheWVyLm51bWJlcn0tc3F1YXJlYCk7XG5cbiAgc3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JheTtcIik7XG4gIH0pO1xufTtcblxuY29uc3QgaW5pdHBsYXlCdG4gPSAoUE9uZSwgUFR3bykgPT4ge1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICBjb25zdCBwbGF5V2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheVwiKTtcblxuICBwbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgcGxheWVyID0gcGxheVdpbmRvdy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuXG4gICAgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICAgIHJlbmRlckJvYXJkKFBPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKFBPbmUsIFBUd28sIHBsYXllcik7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke1BPbmUubnVtYmVyfWApO1xuICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgIH0gZWxzZSBpZiAocGxheWVyID09PSBcInBsYXllci1PbmVcIikge1xuICAgICAgY29uc3QgbW9kZSA9IG1haW4uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke1BUd28ubnVtYmVyfWApO1xuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIpIHtcbiAgICAgICAgYXV0b0F0ayhQT25lLCBQVHdvKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVuZGVyQm9hcmQoUFR3byk7XG4gICAgICAgIHJlbmRlclBsYXlCZChQT25lLCBQVHdvLCBwbGF5ZXIpO1xuICAgICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IHJlbmRlclBsYXlCZCA9IChwT25lLCBwVHdvLCBpZCkgPT4ge1xuICBsZXQgYm9hcmQ7XG4gIGxldCBtaXNzZXM7XG4gIGxldCBjdXJyQm9hcmQ7XG5cbiAgaWYgKGlkID09PSBcInBsYXllci1Ud29cIikge1xuICAgIGJvYXJkID0gcFR3by5ib2FyZC5nZXRCb2FyZCgpO1xuICAgIG1pc3NlcyA9IHBUd28uYm9hcmQuZ2V0TWlzc2VzKCk7XG4gICAgY3VyckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2JvYXJkJHtwVHdvLm51bWJlcn1gKTtcbiAgfSBlbHNlIHtcbiAgICBib2FyZCA9IHBPbmUuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgICBtaXNzZXMgPSBwT25lLmJvYXJkLmdldE1pc3NlcygpO1xuICAgIGN1cnJCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNib2FyZCR7cE9uZS5udW1iZXJ9YCk7XG4gIH1cblxuICB3aGlsZSAoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpXG4gICAgY3VyckJvYXJkLnJlbW92ZUNoaWxkKGN1cnJCb2FyZC5sYXN0RWxlbWVudENoaWxkKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBib2FyZC5sZW5ndGg7IGorKykge1xuICAgICAgY29uc3QgaXRlbSA9IGJvYXJkW2ldW2pdO1xuXG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgaWYgKGlkID09PSBcInBsYXllci1PbmVcIikge1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwT25lLm51bWJlcn0tc3F1YXJlYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwVHdvLm51bWJlcn0tc3F1YXJlYCk7XG4gICAgICB9XG5cbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIiwgYCR7aX1gKTtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIiwgYCR7an1gKTtcblxuICAgICAgaW5pdFNxckJ0bihwT25lLCBwVHdvLCBzcXVhcmUpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIGl0ZW0gIT09IG51bGwgJiZcbiAgICAgICAgaXRlbS5nZXRTaGlwKCkuaGl0Q291bnQgPiAwICYmXG4gICAgICAgIGl0ZW0uZ2V0U2hpcCgpLmhpdENvb3IuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHJldHVybiBpdGVtWzBdID09PSBpICYmIGl0ZW1bMV0gPT09IGo7XG4gICAgICAgIH0pXG4gICAgICApIHtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIG1pc3Nlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IGkgJiYgaXRlbVsxXSA9PT0gajtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBncmVlbjtcIik7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICAgIH1cblxuICAgICAgY3VyckJvYXJkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBpbml0U3FyQnRuID0gKHBPbmUsIHBUd28sIHNxdWFyZSkgPT4ge1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgeCA9IHBhcnNlSW50KHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIikpO1xuICBjb25zdCB5ID0gcGFyc2VJbnQoc3F1YXJlLmdldEF0dHJpYnV0ZShcImRhdGEteVwiKSk7XG4gIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2lubmVyXCIpO1xuICBjb25zdCBlbmRNc2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVuZC1nYW1lXCIpO1xuICBjb25zdCB3aW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBjb25zdCBwbGF5ZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItbmFtZVwiKTtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuXG4gIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3Qgc3F1YXJlSWQgPSBzcXVhcmUuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG4gICAgY29uc3QgaWQgPSB3aW5kb3cuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcbiAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICBsZXQgYm9hcmQ7XG4gICAgbGV0IGJvYXJkTGlzdDtcblxuICAgIGlmIChzcXVhcmVJZCA9PT0gXCJPbmUtc3F1YXJlXCIpIHtcbiAgICAgIGJvYXJkID0gcE9uZS5ib2FyZDtcbiAgICB9IGVsc2Uge1xuICAgICAgYm9hcmQgPSBwVHdvLmJvYXJkO1xuICAgIH1cblxuICAgIGJvYXJkTGlzdCA9IGJvYXJkLmdldEJvYXJkKCk7XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIGlmIChzcXVhcmVJZCA9PT0gXCJPbmUtc3F1YXJlXCIpIHtcbiAgICAgICAgaGlkZUJvYXJkKHBUd28pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGlkZUJvYXJkKHBPbmUpO1xuICAgICAgfVxuXG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XCIpO1xuXG4gICAgICBpZiAobW9kZSA9PT0gXCJwdmNcIikge1xuICAgICAgICBwbGF5ZXJOYW1lLnRleHRDb250ZW50ID0gXCJDb21wdXRlcmBzIHR1cm4hXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZCA9PT0gXCJwbGF5ZXItT25lXCJcbiAgICAgICAgICA/IChwbGF5ZXJOYW1lLnRleHRDb250ZW50ID0gXCJQbGF5ZXIgVHdvYHMgdHVybiFcIilcbiAgICAgICAgICA6IChwbGF5ZXJOYW1lLnRleHRDb250ZW50ID0gXCJQbGF5ZXIgT25lYHMgdHVybiFcIik7XG4gICAgICB9XG5cbiAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHNxdWFyZUlkID09PSBcIk9uZS1zcXVhcmVcIikge1xuICAgICAgICB1cGRhdGVTaGlwbGlzdChib2FyZExpc3RbeF1beV0sIHBPbmUubnVtYmVyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVwZGF0ZVNoaXBsaXN0KGJvYXJkTGlzdFt4XVt5XSwgcFR3by5udW1iZXIpO1xuICAgICAgfVxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcblxuICAgICAgaWYgKGJvYXJkLmlzQWxsU3VuaygpKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG4gICAgICAgIGVuZE1zZy5zaG93TW9kYWwoKTtcbiAgICAgICAgaWYgKGlkID09PSBcInBsYXllci1Ud29cIikge1xuICAgICAgICAgIHdpbm5lci50ZXh0Q29udGVudCA9IGBDb25ncmF0dWxhdGlvbnMgUGxheWVyIFR3byFgO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdpbm5lci50ZXh0Q29udGVudCA9IGBDb25ncmF0dWxhdGlvbnMgUGxheWVyIE9uZSFgO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IGNvbXBNb2RlID0gKHBsYXllcikgPT4ge1xuICBwbGF5ZXIuYm9hcmQucG9wdWxhdGVCZCgpO1xuICByZW5kZXJCb2FyZChwbGF5ZXIpO1xuICBoaWRlQm9hcmQocGxheWVyKTtcbn07XG5cbmNvbnN0IGF1dG9BdGsgPSAocGxheU9uZSwgcGxheVR3bykgPT4ge1xuICBjb25zdCBib2FyZCA9IHBsYXlPbmUuYm9hcmQ7XG4gIGNvbnN0IGJvYXJkTGlzdCA9IGJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IG1pc3NlcyA9IGJvYXJkLmdldE1pc3NlcygpO1xuICBjb25zdCBoaXRzID0gYm9hcmQuZ2V0SGl0cygpO1xuICBjb25zdCBwbGF5V2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgY29uc3Qgd2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aW5uZXJcIik7XG4gIGNvbnN0IGVuZE1zZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZW5kLWdhbWVcIik7XG4gIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICBsZXQgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgbGV0IGNvbnQgPSB0cnVlO1xuXG4gIHdoaWxlIChjb250ID09PSB0cnVlKSB7XG4gICAgaWYgKFxuICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pIHx8XG4gICAgICBoaXRzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pXG4gICAgKSB7XG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG5cbiAgICBpZiAoYm9hcmRMaXN0W3hdW3ldID09PSBudWxsKSB7XG4gICAgICBjb25zdCBpZCA9IGBwbGF5ZXItJHtwbGF5VHdvLm51bWJlcn1gO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtwbGF5T25lLm51bWJlcn1gKTtcbiAgICAgIHJlbmRlckJvYXJkKHBsYXlPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKHBsYXlPbmUsIHBsYXlUd28sIGlkKTtcbiAgICAgIGNvbnQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHBsYXlPbmUuYm9hcmQuaXNBbGxTdW5rKCkpIHtcbiAgICAgICAgY29udCA9IGZhbHNlO1xuICAgICAgICBlbmRNc2cuc2hvd01vZGFsKCk7XG4gICAgICAgIHdpbm5lci50ZXh0Q29udGVudCA9IFwiQ29tcHV0ZXIgd29uIVwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXBkYXRlU2hpcGxpc3QocGxheU9uZS5ib2FyZC5nZXRCb2FyZCgpW3hdW3ldLCBwbGF5T25lLm51bWJlcik7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBpbml0UmFuZEJ0biA9IChwT25lLCBwVHdvKSA9PiB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgY29uc3QgcmFuZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcmFuZG9tXCIpO1xuXG4gIHJhbmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgaWQgPSBmb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuXG4gICAgaWYgKGlkID09PSBcInBsYXllck9uZS1mb3JtXCIpIHtcbiAgICAgIHBPbmUuYm9hcmQucG9wdWxhdGVCZCgpO1xuICAgICAgcmVuZGVyQm9hcmQocE9uZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBUd28uYm9hcmQucG9wdWxhdGVCZCgpO1xuICAgICAgcmVuZGVyQm9hcmQocFR3byk7XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IHJlbmRlclNoYXBlID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBzaGlwc09iaiA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpO1xuICBjb25zdCBzZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2hpcHNcIik7XG4gIGNvbnN0IG5hbWUgPSBzZWxlY3RlZC52YWx1ZTtcbiAgY29uc3Qgc2hpcCA9IHNoaXBzT2JqW25hbWVdO1xuICBjb25zdCBsZW5ndGggPSBzaGlwLmdldFNoaXAoKS5sZW5ndGg7XG4gIGNvbnN0IHNoYXBlQ29udCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hhcGVcIik7XG5cbiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKFwic3F1YXJlXCIpO1xuICAgIHNoYXBlQ29udC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICB9XG59O1xuXG5jb25zdCB1cGRhdGVTaGlwbGlzdCA9IChzaGlwLCBudW1iZXIpID0+IHtcbiAgY29uc3QgbmFtZSA9IHNoaXAuZ2V0U2hpcCgpLm5hbWU7XG4gIGNvbnN0IHNoaXBzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5zaGlwbGlzdC0ke251bWJlcn1gKTtcbiAgY29uc3Qgc2hpcENvbnQgPSBzaGlwc0xpc3QucXVlcnlTZWxlY3RvcihgLiR7bmFtZX1gKTtcbiAgY29uc3Qgc3F1YXJlcyA9IHNoaXBDb250LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3F1YXJlXCIpO1xuICBjb25zdCB0ZW1wID0gW107XG5cbiAgaWYgKHNoaXAuaXNTdW5rKCkpIHtcbiAgICBzcXVhcmVzLmZvckVhY2goKHNxdWFyZSkgPT4ge1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICB9KTtcbiAgfVxufTtcblxuZXhwb3J0IHtcbiAgcmVuZGVyQm9hcmQsXG4gIGluaXRQbGFjZVNoaXAsXG4gIGluaXRGaW5TZXR1cCxcbiAgaW5pdHBsYXlCdG4sXG4gIGNvbXBNb2RlLFxuICBpbml0UmFuZEJ0bixcbiAgcmVuZGVyU2hhcGUsXG59O1xuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG4gIGluaXRSYW5kQnRuLFxuICByZW5kZXJTaGFwZSxcbn0gZnJvbSBcIi4vRE9NXCI7XG5cbmNvbnN0IGdhbWVNb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lX21vZGVcIik7XG5jb25zdCBwdnBCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3B2cFwiKTtcbmNvbnN0IHB2Y0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZjXCIpO1xuY29uc3QgcmVzdGFydEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVzdGFydFwiKTtcbmNvbnN0IGVuZE1zZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZW5kLWdhbWVcIik7XG5jb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG5jb25zdCBzZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NoaXBzXCIpO1xubGV0IHBsYXllck9uZSA9IFBsYXllcihcIk9uZVwiKTtcbmxldCBwbGF5ZXJUd28gPSBQbGF5ZXIoXCJUd29cIik7XG5cbmluaXRQbGFjZVNoaXAocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdEZpblNldHVwKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbmluaXRwbGF5QnRuKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbmluaXRSYW5kQnRuKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbnJlbmRlckJvYXJkKHBsYXllck9uZSk7XG5yZW5kZXJCb2FyZChwbGF5ZXJUd28pO1xucmVuZGVyU2hhcGUocGxheWVyT25lKTtcblxucHZwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHJldHVybiBnYW1lTW9kZS5jbG9zZSgpO1xufSk7XG5cbnB2Y0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG5cbiAgY29tcE1vZGUocGxheWVyVHdvKTtcblxuICBtYWluLmNsYXNzTGlzdC5hZGQoXCJwdmNcIik7XG5cbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucmVzdGFydEJ0bi5mb3JFYWNoKChidXR0b24pID0+XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICAgIGNvbnN0IHdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gICAgY29uc3QgeCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeC1jb29yXCIpO1xuICAgIGNvbnN0IHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ktY29vclwiKTtcbiAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2JhdHRsZXNoaXBcIik7XG4gICAgY29uc3Qgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3F1YXJlXCIpO1xuXG4gICAgZW5kTXNnLmNsb3NlKCk7XG5cbiAgICBmb3JtLnNldEF0dHJpYnV0ZShcImlkXCIsIFwicGxheWVyT25lLWZvcm1cIik7XG4gICAgZm9ybS5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICBtYWluLmNsYXNzTGlzdC5yZW1vdmUoXCJwdmNcIik7XG4gICAgd2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgXCJwbGF5ZXItVHdvXCIpO1xuXG4gICAgc3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICAgIHNxdWFyZS5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICB9KTtcblxuICAgIHgudmFsdWUgPSBcIlwiO1xuICAgIHkudmFsdWUgPSBcIlwiO1xuICAgIG9wdC5yZW1vdmVBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKTtcbiAgICBvcHQuc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJcIik7XG5cbiAgICBwbGF5ZXJPbmUuYm9hcmQucmVzZXRCb2FyZCgpO1xuICAgIHBsYXllclR3by5ib2FyZC5yZXNldEJvYXJkKCk7XG5cbiAgICByZW5kZXJCb2FyZChwbGF5ZXJPbmUpO1xuICAgIHJlbmRlckJvYXJkKHBsYXllclR3byk7XG4gICAgZ2FtZU1vZGUuc2hvd01vZGFsKCk7XG4gIH0pXG4pO1xuXG5zZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoKSA9PiB7XG4gIGNvbnN0IHNoYXBlQ29udCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hhcGVcIik7XG5cbiAgd2hpbGUgKHNoYXBlQ29udC5sYXN0RWxlbWVudENoaWxkKVxuICAgIHNoYXBlQ29udC5yZW1vdmVDaGlsZChzaGFwZUNvbnQubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgcmVuZGVyU2hhcGUocGxheWVyT25lKTtcbn0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwib25sb2FkXCIsIGdhbWVNb2RlLnNob3dNb2RhbCgpKTtcbiJdLCJuYW1lcyI6WyJTaGlwIiwibiIsIm5hbWUiLCJzaGlwT2JqIiwiZ2V0U2hpcCIsImhpdCIsImhpdENvdW50IiwibGVuZ3RoIiwic3VuayIsImlzU3VuayIsInJlc2V0U2hpcCIsIm9yaWVudGF0aW9uIiwiY29tcCIsImhpdENvb3IiLCJHYW1lYm9hcmQiLCJib2FyZCIsIm1pc3NlcyIsImhpdHMiLCJhbGxTaGlwcyIsImJhdHRsZXNoaXAiLCJjcnVpc2VyX0kiLCJjcnVpc2VyX0lJIiwiZGVzdHJveWVyX0kiLCJkZXN0cm95ZXJfSUkiLCJkZXN0cm95ZXJfSUlJIiwic3VibWFyaW5lX0kiLCJzdWJtYXJpbmVfSUkiLCJzdWJtYXJpbmVfSUlJIiwic3VibWFyaW5lX0lWIiwiaXNGaXQiLCJhcnIiLCJzdGF0dXMiLCJmb3JFYWNoIiwiaXRlbSIsIngiLCJ5IiwiY3JlYXRlQ29tcCIsInNoaXAiLCJ0ZW1wIiwiYSIsImIiLCJwdXNoIiwicGxhY2VTaGlwIiwiYWxlcnQiLCJjcmVhdGVCb2FyZCIsImkiLCJqIiwiZ2V0Qm9hcmQiLCJnZXRTaGlwcyIsInJlY2VpdmVBdHRhY2siLCJnZXRNaXNzZXMiLCJnZXRIaXRzIiwiaXNBbGxTdW5rIiwic2hpcHMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJwb3B1bGF0ZUJkIiwia2V5cyIsImRpcmVjdGlvbnMiLCJrZXkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ6IiwiZml0IiwicmVzZXRCb2FyZCIsIlBsYXllciIsIm51bWJlciIsIndpbiIsImlzQ29tcCIsImZpbGxTcXIiLCJwbGF5ZXIiLCJzcXIiLCJ0YWciLCJmaW5kIiwic2V0QXR0cmlidXRlIiwicmVuZGVyQm9hcmQiLCJzaGlwc09iaiIsInhDb29yIiwieUNvb3IiLCJyZW5kZXJTaGlwIiwicGxheWVyTnVtIiwiY3VycmVudEJvYXJkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxhc3RFbGVtZW50Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImhpZGVCb2FyZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZW5kZXJQbGF5QmQiLCJwT25lIiwicFR3byIsImlkIiwiY3VyckJvYXJkIiwicXVlcnlTZWxlY3RvciIsImluaXRTcXJCdG4iLCJkaWFsb2ciLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsIndpbm5lciIsImVuZE1zZyIsIndpbmRvdyIsInBsYXllck5hbWUiLCJtYWluIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInNxdWFyZUlkIiwibW9kZSIsImJvYXJkTGlzdCIsInRleHRDb250ZW50Iiwic2hvd01vZGFsIiwidXBkYXRlU2hpcGxpc3QiLCJyZW5kZXJTaGFwZSIsInZhbHVlIiwic2hhcGVDb250Iiwic3F1YXJlcyIsImdhbWVNb2RlIiwicHZwQnRuIiwicHZjQnRuIiwicmVzdGFydEJ0biIsInBsYXllck9uZSIsInBsYXllclR3byIsInNoaXBOYW1lIiwib3JpZW50IiwiTnVtYmVyIiwiaXNOYU4iLCJidXR0b24iLCJmb3JtIiwiaXNBbGxQbGFjZWQiLCJvcHQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbml0RmluU2V0dXAiLCJQT25lIiwiUFR3byIsInBsYXlXaW5kb3ciLCJjbG9zZSIsInBsYXlPbmUiLCJwbGF5VHdvIiwiY29udCIsImF1dG9BdGsiLCJpbml0cGxheUJ0biIsImluaXRSYW5kQnRuIiwicmVtb3ZlIl0sInNvdXJjZVJvb3QiOiIifQ==