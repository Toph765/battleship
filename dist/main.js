(()=>{"use strict";const e=(e,t)=>{let r={};return r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],{getShip:()=>r,hit:()=>{r.hitCount+=1,r.hitCount===r.length&&(r.sunk=!0)},isSunk:()=>!0===r.sunk,resetShip:()=>(r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],r)}},t=()=>{let t=[],r=[],o=[],a={battleship:e(4,"battleship"),cruiser_I:e(3,"cruiser_I"),cruiser_II:e(3,"cruiser_II"),destroyer_I:e(2,"destroyer_I"),destroyer_II:e(2,"destroyer_II"),destroyer_III:e(2,"destroyer_III"),submarine_I:e(1,"submarine_I"),submarine_II:e(1,"submarine_II"),submarine_III:e(1,"submarine_III"),submarine_IV:e(1,"submarine_IV")};const l=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],a=e[1],null!==t[o][a]))return r=!1;var o,a})),r},n=(e,t,r)=>{const o=r.getShip().length;let a=[],l=e,n=t;if("horizontal"===r.getShip().orientation)for(;n!==t+o;)a.push([e,n]),n+=1;else for(;l!==e+o;)a.push([l,t]),l+=1;return a},u=(e,r,o)=>{let a=[],u=!0;return r+length-1>9||e>9||e+length-1>9||r>9?alert("Ship is out of bound"):(a=n(e,r,o),u=l(a),!1===u?(u=!0,a=[],alert("square is already occupied")):(o.getShip().comp=a,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:u,getBoard:()=>t,getShips:()=>a,receiveAttack:(e,a)=>(null===t[e][a]?r.push([e,a]):(o.push([e,a]),t[e][a].hit(),t[e][a].getShip().hitCoor.push([e,a])),t),getMisses:()=>r,getHits:()=>o,isAllSunk:()=>{const e=Object.values(a);let t=!0;return e.forEach((e=>{if(!e.isSunk())return t=!1})),t},populateBd:()=>{const e=Object.keys(a),r=["horizontal","vertical"];return e.forEach((e=>{const t=a[e],o=t.getShip().length;let s=Math.floor(10*Math.random()),c=Math.floor(10*Math.random()),d=Math.floor(2*Math.random());t.getShip().orientation=r[d];let i=n(s,c,t),m=l(i);for(;c+o-1>9||s+o-1>9||!1===m;)s=Math.floor(10*Math.random()),c=Math.floor(10*Math.random()),d=Math.floor(2*Math.random()),t.getShip().orientation=r[d],i=n(s,c,t),m=l(i);u(s,c,t)})),t},resetBoard:()=>{const e=Object.keys(a);t=[],r=[],o=[],e.forEach((e=>{a[e].resetShip()}))}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,a)=>{const l=e.board.getMisses();null===t?l.find((e=>e[0]===o&&e[1]===a))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===a))&&r.setAttribute("style","background-color: red;")},a=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const a=o[0][0],l=o[0][1];e.board.placeShip(a,l,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let a=document.getElementById(`board${r}`);for(;a.lastElementChild;)a.removeChild(a.lastElementChild);for(let l=0;l<t.length;l++)for(let n=0;n<t.length;n++){const u=document.createElement("div");u.classList.add(`${r}-square`),u.setAttribute("data-x",`${l}`),u.setAttribute("data-y",`${n}`),o(e,t[l][n],u,l,n),a.appendChild(u)}return a},l=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},n=(e,t,r)=>{let o,a,l;for("player-Two"===r?(o=t.board.getBoard(),a=t.board.getMisses(),l=document.querySelector(`#board${t.number}`)):(o=e.board.getBoard(),a=e.board.getMisses(),l=document.querySelector(`#board${e.number}`));l.lastElementChild;)l.removeChild(l.lastElementChild);for(let n=0;n<o.length;n++)for(let s=0;s<o.length;s++){const c=o[n][s],d=document.createElement("button");"player-One"===r?d.classList.add(`${e.number}-square`):d.classList.add(`${t.number}-square`),d.setAttribute("data-x",`${n}`),d.setAttribute("data-y",`${s}`),u(e,t,d),null!==c&&c.getShip().hitCount>0&&c.getShip().hitCoor.find((e=>e[0]===n&&e[1]===s))&&(d.setAttribute("style","background-color: red;"),d.setAttribute("disabled","")),a.find((e=>e[0]===n&&e[1]===s))&&(d.setAttribute("style","background-color: green;"),d.setAttribute("disabled","")),l.appendChild(d)}},u=(e,t,r)=>{const o=document.querySelector(".dialog"),a=parseInt(r.getAttribute("data-x")),n=parseInt(r.getAttribute("data-y")),u=document.querySelector(".winner"),s=document.querySelector(".end-game"),d=document.querySelector("#play-window"),i=document.querySelector(".player-name"),m=document.querySelector("main");r.addEventListener("click",(h=>{h.preventDefault();const p=r.getAttribute("class"),y=d.getAttribute("data-id"),b=m.getAttribute("class");let S,g;S="One-square"===p?e.board:t.board,g=S.getBoard(),S.receiveAttack(a,n),null===g[a][n]?(l("One-square"===p?t:e),r.setAttribute("style","background-color: yellow;"),i.textContent="pvc"===b?"Computer`s turn!":"player-One"===y?"Player Two`s turn!":"Player One`s turn!",o.showModal()):(c(g[a][n],"One-square"===p?e.number:t.number),r.setAttribute("style","background-color: red;"),S.isAllSunk()&&(r.setAttribute("style","background-color: red;"),s.showModal(),u.textContent="player-Two"===y?"Congratulations Player Two!":"Congratulations Player One!"))}))},s=e=>{const t=e.board.getShips()[document.querySelector("#ships").value].getShip().length,r=document.querySelector(".shape");for(;r.lastElementChild;)r.removeChild(r.lastElementChild);for(let e=1;e<=t;e++){const e=document.createElement("div");e.classList.add("square"),r.appendChild(e)}},c=(e,t)=>{const r=e.getShip().name,o=document.querySelector(`.shiplist-${t}`).querySelector(`.${r}`).querySelectorAll(".square");e.isSunk()&&o.forEach((e=>{e.setAttribute("style","background-color: red;")}))},d=document.querySelector(".game_mode"),i=document.querySelector("#pvp"),m=document.querySelector("#pvc"),h=document.querySelectorAll(".restart"),p=document.querySelector(".end-game"),y=document.querySelector("form"),b=document.querySelector("#ships"),S=document.querySelector("#orientation");let g=r("One"),f=r("Two");var q,v;q=g,v=f,document.querySelector("#placeShipBtn").addEventListener("click",(e=>{e.preventDefault();let t=document.querySelector("form").getAttribute("id");const r=parseInt(document.querySelector("#y-coor").value),o=parseInt(document.querySelector("#x-coor").value),l=document.querySelector("#ships").value,n=document.querySelector("#orientation").value;let u;u="playerOne-form"===t?q.board.getShips()[l]:v.board.getShips()[l],u.getShip().orientation=n,Number.isNaN(r)||Number.isNaN(o)||("playerOne-form"===t?(q.board.placeShip(r,o,u),a(q)):(v.board.placeShip(r,o,u),a(v)))})),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector("#finBtn"),a=document.querySelector("form"),n=document.querySelector(".player-name");let u=!1;o.addEventListener("click",(o=>{let c;o.preventDefault();const d=r.getAttribute("class");let i=a.getAttribute("id");if(c="playerOne-form"===i?e.board.getShips():t.board.getShips(),Object.values(c).forEach((e=>{const t=e.getShip().comp;return u=0!==t.length})),u){const r=document.querySelector(".shape"),o=document.querySelector("#ships"),u=document.querySelector("#x-coor"),c=document.querySelector("#y-coor"),m=o.querySelector(".battleship"),h=document.querySelector(".message");if(u.value="",c.value="",r.classList.remove("vertical"),m.removeAttribute("selected"),m.setAttribute("selected",""),s(t),"playerOne-form"===i&&(h.textContent="Player Two please set up your board",a.setAttribute("id","playerTwo-form"),l(e)),"pvc"===d||"playerTwo-form"===i){a.setAttribute("style","display: none;"),h.setAttribute("style","display: none;"),l(t);const e=document.querySelector(".dialog");n.textContent="Player One`s turn!",e.showModal()}}else alert("Please place all the ships first")}))})(g,f),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),l=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(u=>{u.preventDefault();let s=l.getAttribute("data-id");if("player-Two"===s)return a(e),n(e,t,s),l.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===s){const u=r.getAttribute("class");return l.setAttribute("data-id",`player-${t.number}`),"pvc"===u?(((e,t)=>{const r=e.board,o=r.getBoard(),l=r.getMisses(),u=r.getHits(),s=document.querySelector("#play-window"),d=document.querySelector(".winner"),i=document.querySelector(".end-game");let m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()),p=!0;for(;!0===p;)if(l.find((e=>e[0]===m&&e[1]===h))||u.find((e=>e[0]===m&&e[1]===h)))m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random());else if(r.receiveAttack(m,h),null===o[m][h]){const r=`player-${t.number}`;s.setAttribute("data-id",`player-${e.number}`),a(e),n(e,t,r),p=!1}else e.board.isAllSunk()?(p=!1,i.showModal(),d.textContent="Computer won!"):(c(e.board.getBoard()[m][h],e.number),m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()))})(e,t),o.close()):(a(t),n(e,t,s),o.close())}}))})(g,f),((e,t)=>{const r=document.querySelector("form");document.querySelector("#random").addEventListener("click",(o=>{o.preventDefault(),"playerOne-form"===r.getAttribute("id")?(e.board.populateBd(),a(e)):(t.board.populateBd(),a(t))}))})(g,f),a(g),a(f),s(g),i.addEventListener("click",(e=>(e.preventDefault(),d.close()))),m.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main");var r;return(r=f).board.populateBd(),a(r),l(r),t.classList.add("pvc"),d.close()})),h.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#play-window"),o=document.querySelector("#x-coor"),l=document.querySelector("#y-coor"),n=b.querySelector(".battleship"),u=document.querySelectorAll(".square"),c=document.querySelector(".shape"),i=document.querySelector(".message");p.close(),y.setAttribute("id","playerOne-form"),y.removeAttribute("style"),t.classList.remove("pvc"),c.classList.remove("vertical"),r.setAttribute("data-id","player-Two"),u.forEach((e=>{e.removeAttribute("style")})),o.value="",l.value="",n.removeAttribute("selected"),n.setAttribute("selected",""),i.textContent="Player One please set up your board",i.removeAttribute("style"),s(g),g.board.resetBoard(),f.board.resetBoard(),a(g),a(f),d.showModal()})))),b.addEventListener("change",(()=>{s(g)})),S.addEventListener("change",(()=>{const e=document.querySelector(".shape");"vertical"===S.value?e.classList.add("vertical"):e.classList.remove("vertical")})),document.addEventListener("onload",d.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQ3RCbEIsRUFBVS9CLFVBQVVpRCxPQUFPLFlBQzNCaEMsRUFBTy9CLGFBQWEsVUFBVyxjQUUvQjhDLEVBQVF6RixTQUFTdUQsSUFDZkEsRUFBT29ELGdCQUFnQixRQUFRLElBR2pDekcsRUFBRXFGLE1BQVEsR0FDVnBGLEVBQUVvRixNQUFRLEdBQ1ZpQixFQUFJRyxnQkFBZ0IsWUFDcEJILEVBQUk3RCxhQUFhLFdBQVksSUFFN0I4RCxFQUFRdEIsWUFBYyxzQ0FDdEJzQixFQUFRRSxnQkFBZ0IsU0FFeEJyQixFQUFZUyxHQUNaQSxFQUFVaEgsTUFBTWtELGFBQ2hCK0QsRUFBVWpILE1BQU1rRCxhQUVoQlcsRUFBWW1ELEdBQ1puRCxFQUFZb0QsR0FDWk4sRUFBU04sV0FBVyxNQUl4QixFQUFPUCxpQkFBaUIsVUFBVSxLQUNoQ1MsRUFBWVMsRUFBVSxJQUd4QkQsRUFBU2pCLGlCQUFpQixVQUFVLEtBQ2xDLE1BQU1XLEVBQVlyQyxTQUFTZ0IsY0FBYyxVQUVsQixhQUFuQjJCLEVBQVNQLE1BQ1hDLEVBQVUvQixVQUFVQyxJQUFJLFlBRXhCOEIsRUFBVS9CLFVBQVVpRCxPQUFPLFdBQzdCLElBR0Z2RCxTQUFTMEIsaUJBQWlCLFNBQVVhLEVBQVNOLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvRE9NLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNoaXAgPSAobiwgbmFtZSkgPT4ge1xuICBsZXQgc2hpcE9iaiA9IHt9O1xuXG4gIHNoaXBPYmpbXCJuYW1lXCJdID0gbmFtZTtcbiAgc2hpcE9ialtcImxlbmd0aFwiXSA9IG47XG4gIHNoaXBPYmpbXCJoaXRDb3VudFwiXSA9IDA7XG4gIHNoaXBPYmpbXCJzdW5rXCJdID0gZmFsc2U7XG4gIHNoaXBPYmpbXCJvcmllbnRhdGlvblwiXSA9IFwiaG9yaXpvbnRhbFwiO1xuICBzaGlwT2JqW1wiY29tcFwiXSA9IFtdO1xuICBzaGlwT2JqW1wiaGl0Q29vclwiXSA9IFtdO1xuXG4gIGNvbnN0IGdldFNoaXAgPSAoKSA9PiBzaGlwT2JqO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBzaGlwT2JqLmhpdENvdW50ICs9IDE7XG4gICAgaWYgKHNoaXBPYmouaGl0Q291bnQgPT09IHNoaXBPYmoubGVuZ3RoKSBzaGlwT2JqLnN1bmsgPSB0cnVlO1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gc2hpcE9iai5zdW5rID09PSB0cnVlID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IHJlc2V0U2hpcCA9ICgpID0+IHtcbiAgICBzaGlwT2JqLm5hbWUgPSBuYW1lO1xuICAgIHNoaXBPYmoubGVuZ3RoID0gbjtcbiAgICBzaGlwT2JqLmhpdENvdW50ID0gMDtcbiAgICBzaGlwT2JqLnN1bmsgPSBmYWxzZTtcbiAgICBzaGlwT2JqLm9yaWVudGF0aW9uID0gXCJob3Jpem9udGFsXCI7XG4gICAgc2hpcE9iai5jb21wID0gW107XG4gICAgc2hpcE9iai5oaXRDb29yID0gW107XG5cbiAgICByZXR1cm4gc2hpcE9iajtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGdldFNoaXAsXG4gICAgaGl0LFxuICAgIGlzU3VuayxcbiAgICByZXNldFNoaXAsXG4gIH07XG59O1xuXG5leHBvcnQgeyBTaGlwIH07XG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuXG5jb25zdCBHYW1lYm9hcmQgPSAoKSA9PiB7XG4gIGxldCBib2FyZCA9IFtdO1xuICBsZXQgbWlzc2VzID0gW107XG4gIGxldCBoaXRzID0gW107XG5cbiAgbGV0IGFsbFNoaXBzID0ge1xuICAgIGJhdHRsZXNoaXA6IFNoaXAoNCwgXCJiYXR0bGVzaGlwXCIpLFxuICAgIGNydWlzZXJfSTogU2hpcCgzLCBcImNydWlzZXJfSVwiKSxcbiAgICBjcnVpc2VyX0lJOiBTaGlwKDMsIFwiY3J1aXNlcl9JSVwiKSxcbiAgICBkZXN0cm95ZXJfSTogU2hpcCgyLCBcImRlc3Ryb3llcl9JXCIpLFxuICAgIGRlc3Ryb3llcl9JSTogU2hpcCgyLCBcImRlc3Ryb3llcl9JSVwiKSxcbiAgICBkZXN0cm95ZXJfSUlJOiBTaGlwKDIsIFwiZGVzdHJveWVyX0lJSVwiKSxcbiAgICBzdWJtYXJpbmVfSTogU2hpcCgxLCBcInN1Ym1hcmluZV9JXCIpLFxuICAgIHN1Ym1hcmluZV9JSTogU2hpcCgxLCBcInN1Ym1hcmluZV9JSVwiKSxcbiAgICBzdWJtYXJpbmVfSUlJOiBTaGlwKDEsIFwic3VibWFyaW5lX0lJSVwiKSxcbiAgICBzdWJtYXJpbmVfSVY6IFNoaXAoMSwgXCJzdWJtYXJpbmVfSVZcIiksXG4gIH07XG5cbiAgY29uc3QgZ2V0Qm9hcmQgPSAoKSA9PiBib2FyZDtcbiAgY29uc3QgZ2V0TWlzc2VzID0gKCkgPT4gbWlzc2VzO1xuICBjb25zdCBnZXRTaGlwcyA9ICgpID0+IGFsbFNoaXBzO1xuICBjb25zdCBnZXRIaXRzID0gKCkgPT4gaGl0cztcblxuICBjb25zdCBjcmVhdGVCb2FyZCA9ICgpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGJvYXJkW2ldID0gW107XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgYm9hcmRbaV1bal0gPSBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBpc0VtcHR5ID0gKHgsIHkpID0+IHtcbiAgICByZXR1cm4gYm9hcmRbeF1beV0gPT09IG51bGwgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgaXNGaXQgPSAoYXJyKSA9PiB7XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaWYgKGl0ZW1bMF0gPiA5IHx8IGl0ZW1bMV0gPiA5IHx8ICFpc0VtcHR5KGl0ZW1bMF0sIGl0ZW1bMV0pKVxuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0dXM7XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlQ29tcCA9ICh4LCB5LCBzaGlwKSA9PiB7XG4gICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb247XG4gICAgbGV0IHRlbXAgPSBbXTtcbiAgICBsZXQgYSA9IHg7XG4gICAgbGV0IGIgPSB5O1xuXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgd2hpbGUgKGIgIT09IHkgKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFt4LCBiXSk7XG4gICAgICAgIGIgKz0gMTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGEgIT09IHggKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFthLCB5XSk7XG4gICAgICAgIGEgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGVtcDtcbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBpZiAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCB5ID4gOSkge1xuICAgICAgcmV0dXJuIGFsZXJ0KFwiU2hpcCBpcyBvdXQgb2YgYm91bmRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgc3RhdHVzID0gaXNGaXQodGVtcCk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gZmFsc2UpIHtcbiAgICAgIHN0YXR1cyA9IHRydWU7XG4gICAgICB0ZW1wID0gW107XG4gICAgICByZXR1cm4gYWxlcnQoXCJzcXVhcmUgaXMgYWxyZWFkeSBvY2N1cGllZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hpcC5nZXRTaGlwKCkuY29tcCA9IHRlbXA7XG5cbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBib2FyZFtpdGVtWzBdXVtpdGVtWzFdXSA9IHNoaXA7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgcG9wdWxhdGVCZCA9ICgpID0+IHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoYWxsU2hpcHMpO1xuICAgIGNvbnN0IGRpcmVjdGlvbnMgPSBbXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIl07XG5cbiAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgY29uc3Qgc2hpcCA9IGFsbFNoaXBzW2tleV07XG4gICAgICBjb25zdCBsZW5ndGggPSBzaGlwLmdldFNoaXAoKS5sZW5ndGg7XG5cbiAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBsZXQgeiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICBsZXQgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICBsZXQgZml0ID0gaXNGaXQodGVtcCk7XG5cbiAgICAgIHdoaWxlICh5ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeCArIGxlbmd0aCAtIDEgPiA5IHx8IGZpdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gZGlyZWN0aW9uc1t6XTtcbiAgICAgICAgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICAgIGZpdCA9IGlzRml0KHRlbXApO1xuICAgICAgfVxuXG4gICAgICBwbGFjZVNoaXAoeCwgeSwgc2hpcCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9ICh4LCB5KSA9PiB7XG4gICAgaWYgKGJvYXJkW3hdW3ldID09PSBudWxsKSBtaXNzZXMucHVzaChbeCwgeV0pO1xuICAgIGVsc2Uge1xuICAgICAgaGl0cy5wdXNoKFt4LCB5XSk7XG4gICAgICBib2FyZFt4XVt5XS5oaXQoKTtcbiAgICAgIGJvYXJkW3hdW3ldLmdldFNoaXAoKS5oaXRDb29yLnB1c2goW3gsIHldKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgaXNBbGxTdW5rID0gKCkgPT4ge1xuICAgIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhhbGxTaGlwcyk7XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBpZiAoIXNoaXAuaXNTdW5rKCkpIHtcbiAgICAgICAgcmV0dXJuIChzdGF0dXMgPSBmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhdHVzO1xuICB9O1xuXG4gIGNvbnN0IHJlc2V0Qm9hcmQgPSAoKSA9PiB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFsbFNoaXBzKTtcbiAgICBib2FyZCA9IFtdO1xuICAgIG1pc3NlcyA9IFtdO1xuICAgIGhpdHMgPSBbXTtcblxuICAgIGtleXMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgYWxsU2hpcHNbc2hpcF0ucmVzZXRTaGlwKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVCb2FyZCxcbiAgICBwbGFjZVNoaXAsXG4gICAgZ2V0Qm9hcmQsXG4gICAgZ2V0U2hpcHMsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBnZXRNaXNzZXMsXG4gICAgZ2V0SGl0cyxcbiAgICBpc0FsbFN1bmssXG4gICAgcG9wdWxhdGVCZCxcbiAgICByZXNldEJvYXJkLFxuICB9O1xufTtcblxuZXhwb3J0IHsgR2FtZWJvYXJkIH07XG4iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gKG51bWJlcikgPT4ge1xuICBsZXQgd2luID0gZmFsc2U7XG4gIGxldCBib2FyZCA9IEdhbWVib2FyZCgpO1xuICBsZXQgaXNDb21wID0gZmFsc2U7XG5cbiAgcmV0dXJuIHtcbiAgICBudW1iZXIsXG4gICAgd2luLFxuICAgIGJvYXJkLFxuICAgIGlzQ29tcCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFBsYXllciB9O1xuIiwiY29uc3QgZmlsbFNxciA9IChwbGF5ZXIsIHNxciwgdGFnLCB4LCB5KSA9PiB7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcblxuICBpZiAoc3FyID09PSBudWxsKSB7XG4gICAgaWYgKFxuICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pXG4gICAgKSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBibHVlO1wiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXG4gICAgc3FyLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgfSlcbiAgKSB7XG4gICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgfVxufTtcblxuY29uc3QgcmVuZGVyU2hpcCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzTGlzdCA9IE9iamVjdC5rZXlzKHNoaXBzT2JqKTtcblxuICBzaGlwc0xpc3QuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IGNvbXAgPSBzaGlwc09ialtzaGlwXS5nZXRTaGlwKCkuY29tcDtcblxuICAgIGlmIChjb21wLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29uc3QgeENvb3IgPSBjb21wWzBdWzBdO1xuICAgICAgY29uc3QgeUNvb3IgPSBjb21wWzBdWzFdO1xuICAgICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXBzT2JqW3NoaXBdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn07XG5cbmNvbnN0IHJlbmRlckJvYXJkID0gKHBsYXllcikgPT4ge1xuICBwbGF5ZXIuYm9hcmQuY3JlYXRlQm9hcmQoKTtcblxuICByZW5kZXJTaGlwKHBsYXllcik7XG5cbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgcGxheWVyTnVtID0gcGxheWVyLm51bWJlcjtcbiAgbGV0IGN1cnJlbnRCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBib2FyZCR7cGxheWVyTnVtfWApO1xuXG4gIHdoaWxlIChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyZW50Qm9hcmQucmVtb3ZlQ2hpbGQoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyTnVtfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBmaWxsU3FyKHBsYXllciwgYm9hcmRbaV1bal0sIHNxdWFyZSwgaSwgaik7XG5cbiAgICAgIGN1cnJlbnRCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50Qm9hcmQ7XG59O1xuXG5jb25zdCBpbml0UGxhY2VTaGlwID0gKHBPbmUsIHBUd28pID0+IHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYWNlU2hpcEJ0bmApO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gICAgbGV0IGlkID0gZm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcblxuICAgIGNvbnN0IHhDb29yID0gcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3ktY29vcmApLnZhbHVlKTtcbiAgICBjb25zdCB5Q29vciA9IHBhcnNlSW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCN4LWNvb3JgKS52YWx1ZSk7XG4gICAgY29uc3Qgc2hpcE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjc2hpcHNgKS52YWx1ZTtcblxuICAgIGNvbnN0IG9yaWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNvcmllbnRhdGlvbmApLnZhbHVlO1xuXG4gICAgbGV0IHNoaXA7XG4gICAgaWQgPT09IFwicGxheWVyT25lLWZvcm1cIlxuICAgICAgPyAoc2hpcCA9IHBPbmUuYm9hcmQuZ2V0U2hpcHMoKVtzaGlwTmFtZV0pXG4gICAgICA6IChzaGlwID0gcFR3by5ib2FyZC5nZXRTaGlwcygpW3NoaXBOYW1lXSk7XG5cbiAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IG9yaWVudDtcblxuICAgIGlmIChOdW1iZXIuaXNOYU4oeENvb3IpIHx8IE51bWJlci5pc05hTih5Q29vcikpIHJldHVybjtcbiAgICBlbHNlIHtcbiAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiKSB7XG4gICAgICAgIHBPbmUuYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcCk7XG4gICAgICAgIHJlbmRlckJvYXJkKHBPbmUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcFR3by5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwKTtcbiAgICAgICAgcmVuZGVyQm9hcmQocFR3byk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IGluaXRGaW5TZXR1cCA9IChwT25lLCBwVHdvKSA9PiB7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2ZpbkJ0bmApO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgZm9ybWApO1xuICBjb25zdCBwbGF5ZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItbmFtZVwiKTtcblxuICBsZXQgaXNBbGxQbGFjZWQgPSBmYWxzZTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgbGV0IHNoaXBzT2JqO1xuICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgIGxldCBpZCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICBpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiXG4gICAgICA/IChzaGlwc09iaiA9IHBPbmUuYm9hcmQuZ2V0U2hpcHMoKSlcbiAgICAgIDogKHNoaXBzT2JqID0gcFR3by5ib2FyZC5nZXRTaGlwcygpKTtcblxuICAgIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhzaGlwc09iaik7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBjb25zdCBjb21wID0gc2hpcC5nZXRTaGlwKCkuY29tcDtcbiAgICAgIGlmIChjb21wLmxlbmd0aCA9PT0gMCkgcmV0dXJuIChpc0FsbFBsYWNlZCA9IGZhbHNlKTtcbiAgICAgIGVsc2UgcmV0dXJuIChpc0FsbFBsYWNlZCA9IHRydWUpO1xuICAgIH0pO1xuXG4gICAgaWYgKGlzQWxsUGxhY2VkKSB7XG4gICAgICBjb25zdCBzaGFwZUNvbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNoYXBlXCIpO1xuICAgICAgY29uc3Qgc2hpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NoaXBzXCIpO1xuICAgICAgY29uc3QgeCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeC1jb29yXCIpO1xuICAgICAgY29uc3QgeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeS1jb29yXCIpO1xuICAgICAgY29uc3Qgb3B0ID0gc2hpcHMucXVlcnlTZWxlY3RvcihcIi5iYXR0bGVzaGlwXCIpO1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcblxuICAgICAgeC52YWx1ZSA9IFwiXCI7XG4gICAgICB5LnZhbHVlID0gXCJcIjtcbiAgICAgIHNoYXBlQ29udC5jbGFzc0xpc3QucmVtb3ZlKFwidmVydGljYWxcIik7XG4gICAgICBvcHQucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgICBvcHQuc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJcIik7XG4gICAgICByZW5kZXJTaGFwZShwVHdvKTtcblxuICAgICAgaWYgKGlkID09PSBcInBsYXllck9uZS1mb3JtXCIpIHtcbiAgICAgICAgbWVzc2FnZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIFR3byBwbGVhc2Ugc2V0IHVwIHlvdXIgYm9hcmRcIjtcbiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInBsYXllclR3by1mb3JtXCIpO1xuICAgICAgICBoaWRlQm9hcmQocE9uZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiIHx8IGlkID09PSBcInBsYXllclR3by1mb3JtXCIpIHtcbiAgICAgICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmU7XCIpO1xuICAgICAgICBtZXNzYWdlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZGlzcGxheTogbm9uZTtcIik7XG4gICAgICAgIGhpZGVCb2FyZChwVHdvKTtcbiAgICAgICAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gICAgICAgIHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBPbmVgcyB0dXJuIVwiO1xuICAgICAgICBkaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KFwiUGxlYXNlIHBsYWNlIGFsbCB0aGUgc2hpcHMgZmlyc3RcIik7XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IGhpZGVCb2FyZCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IHNxdWFyZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAuJHtwbGF5ZXIubnVtYmVyfS1zcXVhcmVgKTtcblxuICBzcXVhcmVzLmZvckVhY2goKHNxdWFyZSkgPT4ge1xuICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBncmF5O1wiKTtcbiAgfSk7XG59O1xuXG5jb25zdCBpbml0cGxheUJ0biA9IChQT25lLCBQVHdvKSA9PiB7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcbiAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gIGNvbnN0IHBsYXlXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBjb25zdCBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5XCIpO1xuXG4gIHBsYXlCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGxldCBwbGF5ZXIgPSBwbGF5V2luZG93LmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG5cbiAgICBpZiAocGxheWVyID09PSBcInBsYXllci1Ud29cIikge1xuICAgICAgcmVuZGVyQm9hcmQoUE9uZSk7XG4gICAgICByZW5kZXJQbGF5QmQoUE9uZSwgUFR3bywgcGxheWVyKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UE9uZS5udW1iZXJ9YCk7XG4gICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgfSBlbHNlIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UFR3by5udW1iZXJ9YCk7XG4gICAgICBpZiAobW9kZSA9PT0gXCJwdmNcIikge1xuICAgICAgICBhdXRvQXRrKFBPbmUsIFBUd28pO1xuICAgICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZW5kZXJCb2FyZChQVHdvKTtcbiAgICAgICAgcmVuZGVyUGxheUJkKFBPbmUsIFBUd28sIHBsYXllcik7XG4gICAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgcmVuZGVyUGxheUJkID0gKHBPbmUsIHBUd28sIGlkKSA9PiB7XG4gIGxldCBib2FyZDtcbiAgbGV0IG1pc3NlcztcbiAgbGV0IGN1cnJCb2FyZDtcblxuICBpZiAoaWQgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgYm9hcmQgPSBwVHdvLmJvYXJkLmdldEJvYXJkKCk7XG4gICAgbWlzc2VzID0gcFR3by5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgICBjdXJyQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYm9hcmQke3BUd28ubnVtYmVyfWApO1xuICB9IGVsc2Uge1xuICAgIGJvYXJkID0gcE9uZS5ib2FyZC5nZXRCb2FyZCgpO1xuICAgIG1pc3NlcyA9IHBPbmUuYm9hcmQuZ2V0TWlzc2VzKCk7XG4gICAgY3VyckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2JvYXJkJHtwT25lLm51bWJlcn1gKTtcbiAgfVxuXG4gIHdoaWxlIChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyQm9hcmQucmVtb3ZlQ2hpbGQoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBpdGVtID0gYm9hcmRbaV1bal07XG5cbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICBpZiAoaWQgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BPbmUubnVtYmVyfS1zcXVhcmVgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BUd28ubnVtYmVyfS1zcXVhcmVgKTtcbiAgICAgIH1cblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBpbml0U3FyQnRuKHBPbmUsIHBUd28sIHNxdWFyZSk7XG5cbiAgICAgIGlmIChcbiAgICAgICAgaXRlbSAhPT0gbnVsbCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb3VudCA+IDAgJiZcbiAgICAgICAgaXRlbS5nZXRTaGlwKCkuaGl0Q29vci5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IGkgJiYgaXRlbVsxXSA9PT0gajtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyZWVuO1wiKTtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgICAgfVxuXG4gICAgICBjdXJyQm9hcmQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGluaXRTcXJCdG4gPSAocE9uZSwgcFR3bywgc3F1YXJlKSA9PiB7XG4gIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICBjb25zdCB4ID0gcGFyc2VJbnQoc3F1YXJlLmdldEF0dHJpYnV0ZShcImRhdGEteFwiKSk7XG4gIGNvbnN0IHkgPSBwYXJzZUludChzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS15XCIpKTtcbiAgY29uc3Qgd2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aW5uZXJcIik7XG4gIGNvbnN0IGVuZE1zZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZW5kLWdhbWVcIik7XG4gIGNvbnN0IHdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHBsYXllck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllci1uYW1lXCIpO1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG5cbiAgc3F1YXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBzcXVhcmVJZCA9IHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICBjb25zdCBpZCA9IHdpbmRvdy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgIGxldCBib2FyZDtcbiAgICBsZXQgYm9hcmRMaXN0O1xuXG4gICAgaWYgKHNxdWFyZUlkID09PSBcIk9uZS1zcXVhcmVcIikge1xuICAgICAgYm9hcmQgPSBwT25lLmJvYXJkO1xuICAgIH0gZWxzZSB7XG4gICAgICBib2FyZCA9IHBUd28uYm9hcmQ7XG4gICAgfVxuXG4gICAgYm9hcmRMaXN0ID0gYm9hcmQuZ2V0Qm9hcmQoKTtcblxuICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG4gICAgaWYgKGJvYXJkTGlzdFt4XVt5XSA9PT0gbnVsbCkge1xuICAgICAgaWYgKHNxdWFyZUlkID09PSBcIk9uZS1zcXVhcmVcIikge1xuICAgICAgICBoaWRlQm9hcmQocFR3byk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoaWRlQm9hcmQocE9uZSk7XG4gICAgICB9XG5cbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHllbGxvdztcIik7XG5cbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICAgIHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyYHMgdHVybiFcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlkID09PSBcInBsYXllci1PbmVcIlxuICAgICAgICAgID8gKHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBUd29gcyB0dXJuIVwiKVxuICAgICAgICAgIDogKHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBPbmVgcyB0dXJuIVwiKTtcbiAgICAgIH1cblxuICAgICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc3F1YXJlSWQgPT09IFwiT25lLXNxdWFyZVwiKSB7XG4gICAgICAgIHVwZGF0ZVNoaXBsaXN0KGJvYXJkTGlzdFt4XVt5XSwgcE9uZS5udW1iZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXBkYXRlU2hpcGxpc3QoYm9hcmRMaXN0W3hdW3ldLCBwVHdvLm51bWJlcik7XG4gICAgICB9XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuXG4gICAgICBpZiAoYm9hcmQuaXNBbGxTdW5rKCkpIHtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICAgICAgZW5kTXNnLnNob3dNb2RhbCgpO1xuICAgICAgICBpZiAoaWQgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gYENvbmdyYXR1bGF0aW9ucyBQbGF5ZXIgVHdvIWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gYENvbmdyYXR1bGF0aW9ucyBQbGF5ZXIgT25lIWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgY29tcE1vZGUgPSAocGxheWVyKSA9PiB7XG4gIHBsYXllci5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gIHJlbmRlckJvYXJkKHBsYXllcik7XG4gIGhpZGVCb2FyZChwbGF5ZXIpO1xufTtcblxuY29uc3QgYXV0b0F0ayA9IChwbGF5T25lLCBwbGF5VHdvKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gcGxheU9uZS5ib2FyZDtcbiAgY29uc3QgYm9hcmRMaXN0ID0gYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgbWlzc2VzID0gYm9hcmQuZ2V0TWlzc2VzKCk7XG4gIGNvbnN0IGhpdHMgPSBib2FyZC5nZXRIaXRzKCk7XG4gIGNvbnN0IHBsYXlXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndpbm5lclwiKTtcbiAgY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbiAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICBsZXQgY29udCA9IHRydWU7XG5cbiAgd2hpbGUgKGNvbnQgPT09IHRydWUpIHtcbiAgICBpZiAoXG4gICAgICBtaXNzZXMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgICAgfSkgfHxcbiAgICAgIGhpdHMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0geCAmJiBpdGVtWzFdID09PSB5O1xuICAgICAgfSlcbiAgICApIHtcbiAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcblxuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIGNvbnN0IGlkID0gYHBsYXllci0ke3BsYXlUd28ubnVtYmVyfWA7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke3BsYXlPbmUubnVtYmVyfWApO1xuICAgICAgcmVuZGVyQm9hcmQocGxheU9uZSk7XG4gICAgICByZW5kZXJQbGF5QmQocGxheU9uZSwgcGxheVR3bywgaWQpO1xuICAgICAgY29udCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocGxheU9uZS5ib2FyZC5pc0FsbFN1bmsoKSkge1xuICAgICAgICBjb250ID0gZmFsc2U7XG4gICAgICAgIGVuZE1zZy5zaG93TW9kYWwoKTtcbiAgICAgICAgd2lubmVyLnRleHRDb250ZW50ID0gXCJDb21wdXRlciB3b24hXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1cGRhdGVTaGlwbGlzdChwbGF5T25lLmJvYXJkLmdldEJvYXJkKClbeF1beV0sIHBsYXlPbmUubnVtYmVyKTtcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGluaXRSYW5kQnRuID0gKHBPbmUsIHBUd28pID0+IHtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJmb3JtXCIpO1xuICBjb25zdCByYW5kQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyYW5kb21cIik7XG5cbiAgcmFuZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBpZCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICBpZiAoaWQgPT09IFwicGxheWVyT25lLWZvcm1cIikge1xuICAgICAgcE9uZS5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gICAgICByZW5kZXJCb2FyZChwT25lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcFR3by5ib2FyZC5wb3B1bGF0ZUJkKCk7XG4gICAgICByZW5kZXJCb2FyZChwVHdvKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgcmVuZGVyU2hhcGUgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNzaGlwc1wiKTtcbiAgY29uc3QgbmFtZSA9IHNlbGVjdGVkLnZhbHVlO1xuICBjb25zdCBzaGlwID0gc2hpcHNPYmpbbmFtZV07XG4gIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcbiAgY29uc3Qgc2hhcGVDb250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGFwZVwiKTtcblxuICB3aGlsZSAoc2hhcGVDb250Lmxhc3RFbGVtZW50Q2hpbGQpXG4gICAgc2hhcGVDb250LnJlbW92ZUNoaWxkKHNoYXBlQ29udC5sYXN0RWxlbWVudENoaWxkKTtcblxuICBmb3IgKGxldCBpID0gMTsgaSA8PSBsZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoXCJzcXVhcmVcIik7XG4gICAgc2hhcGVDb250LmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gIH1cbn07XG5cbmNvbnN0IHVwZGF0ZVNoaXBsaXN0ID0gKHNoaXAsIG51bWJlcikgPT4ge1xuICBjb25zdCBuYW1lID0gc2hpcC5nZXRTaGlwKCkubmFtZTtcbiAgY29uc3Qgc2hpcHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLnNoaXBsaXN0LSR7bnVtYmVyfWApO1xuICBjb25zdCBzaGlwQ29udCA9IHNoaXBzTGlzdC5xdWVyeVNlbGVjdG9yKGAuJHtuYW1lfWApO1xuICBjb25zdCBzcXVhcmVzID0gc2hpcENvbnQucXVlcnlTZWxlY3RvckFsbChcIi5zcXVhcmVcIik7XG4gIGNvbnN0IHRlbXAgPSBbXTtcblxuICBpZiAoc2hpcC5pc1N1bmsoKSkge1xuICAgIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgIH0pO1xuICB9XG59O1xuXG5leHBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG4gIGluaXRSYW5kQnRuLFxuICByZW5kZXJTaGFwZSxcbn07XG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7XG4gIHJlbmRlckJvYXJkLFxuICBpbml0UGxhY2VTaGlwLFxuICBpbml0RmluU2V0dXAsXG4gIGluaXRwbGF5QnRuLFxuICBjb21wTW9kZSxcbiAgaW5pdFJhbmRCdG4sXG4gIHJlbmRlclNoYXBlLFxufSBmcm9tIFwiLi9ET01cIjtcblxuY29uc3QgZ2FtZU1vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbWVfbW9kZVwiKTtcbmNvbnN0IHB2cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZwXCIpO1xuY29uc3QgcHZjQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwdmNcIik7XG5jb25zdCByZXN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXN0YXJ0XCIpO1xuY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbmNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2hpcHNcIik7XG5jb25zdCBzZWxlY3RPciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3JpZW50YXRpb25cIik7XG5sZXQgcGxheWVyT25lID0gUGxheWVyKFwiT25lXCIpO1xubGV0IHBsYXllclR3byA9IFBsYXllcihcIlR3b1wiKTtcblxuaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5pbml0RmluU2V0dXAocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdHBsYXlCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdFJhbmRCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xucmVuZGVyQm9hcmQocGxheWVyT25lKTtcbnJlbmRlckJvYXJkKHBsYXllclR3byk7XG5yZW5kZXJTaGFwZShwbGF5ZXJPbmUpO1xuXG5wdnBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucHZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcblxuICBjb21wTW9kZShwbGF5ZXJUd28pO1xuXG4gIG1haW4uY2xhc3NMaXN0LmFkZChcInB2Y1wiKTtcblxuICByZXR1cm4gZ2FtZU1vZGUuY2xvc2UoKTtcbn0pO1xuXG5yZXN0YXJ0QnRuLmZvckVhY2goKGJ1dHRvbikgPT5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gICAgY29uc3Qgd2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgICBjb25zdCB4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN4LWNvb3JcIik7XG4gICAgY29uc3QgeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeS1jb29yXCIpO1xuICAgIGNvbnN0IG9wdCA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKFwiLmJhdHRsZXNoaXBcIik7XG4gICAgY29uc3Qgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3F1YXJlXCIpO1xuICAgIGNvbnN0IHNoYXBlQ29udCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hhcGVcIik7XG4gICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcblxuICAgIGVuZE1zZy5jbG9zZSgpO1xuXG4gICAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInBsYXllck9uZS1mb3JtXCIpO1xuICAgIGZvcm0ucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG4gICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKFwicHZjXCIpO1xuICAgIHNoYXBlQ29udC5jbGFzc0xpc3QucmVtb3ZlKFwidmVydGljYWxcIik7XG4gICAgd2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgXCJwbGF5ZXItVHdvXCIpO1xuXG4gICAgc3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICAgIHNxdWFyZS5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICB9KTtcblxuICAgIHgudmFsdWUgPSBcIlwiO1xuICAgIHkudmFsdWUgPSBcIlwiO1xuICAgIG9wdC5yZW1vdmVBdHRyaWJ1dGUoXCJzZWxlY3RlZFwiKTtcbiAgICBvcHQuc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJcIik7XG5cbiAgICBtZXNzYWdlLnRleHRDb250ZW50ID0gXCJQbGF5ZXIgT25lIHBsZWFzZSBzZXQgdXAgeW91ciBib2FyZFwiO1xuICAgIG1lc3NhZ2UucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG5cbiAgICByZW5kZXJTaGFwZShwbGF5ZXJPbmUpO1xuICAgIHBsYXllck9uZS5ib2FyZC5yZXNldEJvYXJkKCk7XG4gICAgcGxheWVyVHdvLmJvYXJkLnJlc2V0Qm9hcmQoKTtcblxuICAgIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gICAgcmVuZGVyQm9hcmQocGxheWVyVHdvKTtcbiAgICBnYW1lTW9kZS5zaG93TW9kYWwoKTtcbiAgfSlcbik7XG5cbnNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgcmVuZGVyU2hhcGUocGxheWVyT25lKTtcbn0pO1xuXG5zZWxlY3RPci5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgY29uc3Qgc2hhcGVDb250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGFwZVwiKTtcblxuICBpZiAoc2VsZWN0T3IudmFsdWUgPT09IFwidmVydGljYWxcIikge1xuICAgIHNoYXBlQ29udC5jbGFzc0xpc3QuYWRkKFwidmVydGljYWxcIik7XG4gIH0gZWxzZSB7XG4gICAgc2hhcGVDb250LmNsYXNzTGlzdC5yZW1vdmUoXCJ2ZXJ0aWNhbFwiKTtcbiAgfVxufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxvYWRcIiwgZ2FtZU1vZGUuc2hvd01vZGFsKCkpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJuIiwibmFtZSIsInNoaXBPYmoiLCJnZXRTaGlwIiwiaGl0IiwiaGl0Q291bnQiLCJsZW5ndGgiLCJzdW5rIiwiaXNTdW5rIiwicmVzZXRTaGlwIiwib3JpZW50YXRpb24iLCJjb21wIiwiaGl0Q29vciIsIkdhbWVib2FyZCIsImJvYXJkIiwibWlzc2VzIiwiaGl0cyIsImFsbFNoaXBzIiwiYmF0dGxlc2hpcCIsImNydWlzZXJfSSIsImNydWlzZXJfSUkiLCJkZXN0cm95ZXJfSSIsImRlc3Ryb3llcl9JSSIsImRlc3Ryb3llcl9JSUkiLCJzdWJtYXJpbmVfSSIsInN1Ym1hcmluZV9JSSIsInN1Ym1hcmluZV9JSUkiLCJzdWJtYXJpbmVfSVYiLCJpc0ZpdCIsImFyciIsInN0YXR1cyIsImZvckVhY2giLCJpdGVtIiwieCIsInkiLCJjcmVhdGVDb21wIiwic2hpcCIsInRlbXAiLCJhIiwiYiIsInB1c2giLCJwbGFjZVNoaXAiLCJhbGVydCIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJnZXRCb2FyZCIsImdldFNoaXBzIiwicmVjZWl2ZUF0dGFjayIsImdldE1pc3NlcyIsImdldEhpdHMiLCJpc0FsbFN1bmsiLCJzaGlwcyIsIk9iamVjdCIsInZhbHVlcyIsInBvcHVsYXRlQmQiLCJrZXlzIiwiZGlyZWN0aW9ucyIsImtleSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInoiLCJmaXQiLCJyZXNldEJvYXJkIiwiUGxheWVyIiwibnVtYmVyIiwid2luIiwiaXNDb21wIiwiZmlsbFNxciIsInBsYXllciIsInNxciIsInRhZyIsImZpbmQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJCb2FyZCIsInNoaXBzT2JqIiwieENvb3IiLCJ5Q29vciIsInJlbmRlclNoaXAiLCJwbGF5ZXJOdW0iLCJjdXJyZW50Qm9hcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibGFzdEVsZW1lbnRDaGlsZCIsInJlbW92ZUNoaWxkIiwic3F1YXJlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiaGlkZUJvYXJkIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbmRlclBsYXlCZCIsInBPbmUiLCJwVHdvIiwiaWQiLCJjdXJyQm9hcmQiLCJxdWVyeVNlbGVjdG9yIiwiaW5pdFNxckJ0biIsImRpYWxvZyIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwid2lubmVyIiwiZW5kTXNnIiwid2luZG93IiwicGxheWVyTmFtZSIsIm1haW4iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic3F1YXJlSWQiLCJtb2RlIiwiYm9hcmRMaXN0IiwidGV4dENvbnRlbnQiLCJzaG93TW9kYWwiLCJ1cGRhdGVTaGlwbGlzdCIsInJlbmRlclNoYXBlIiwidmFsdWUiLCJzaGFwZUNvbnQiLCJzcXVhcmVzIiwiZ2FtZU1vZGUiLCJwdnBCdG4iLCJwdmNCdG4iLCJyZXN0YXJ0QnRuIiwic2VsZWN0T3IiLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iLCJzaGlwTmFtZSIsIm9yaWVudCIsIk51bWJlciIsImlzTmFOIiwiYnV0dG9uIiwiZm9ybSIsImlzQWxsUGxhY2VkIiwib3B0IiwibWVzc2FnZSIsInJlbW92ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImluaXRGaW5TZXR1cCIsIlBPbmUiLCJQVHdvIiwicGxheVdpbmRvdyIsImNsb3NlIiwicGxheU9uZSIsInBsYXlUd28iLCJjb250IiwiYXV0b0F0ayIsImluaXRwbGF5QnRuIiwiaW5pdFJhbmRCdG4iXSwic291cmNlUm9vdCI6IiJ9