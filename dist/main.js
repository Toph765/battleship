(()=>{"use strict";const e=e=>{let t={};return t.length=e,t.hitCount=0,t.sunk=!1,t.orientation="horizontal",t.comp=[],t.hitCoor=[],{getShip:()=>t,hit:()=>{t.hitCount+=1,t.hitCount===t.length&&(t.sunk=!0)},isSunk:()=>!0===t.sunk,resetShip:()=>(t.length=e,t.hitCount=0,t.sunk=!1,t.orientation="horizontal",t.comp=[],t.hitCoor=[],t)}},t=()=>{let t=[],r=[],o=[],a={battleship:e(4),cruiser_I:e(3),cruiser_II:e(3),destroyer_I:e(2),destroyer_II:e(2),destroyer_III:e(2),submarine_I:e(1),submarine_II:e(1),submarine_III:e(1),submarine_IV:e(1)};const n=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],a=e[1],null!==t[o][a]))return r=!1;var o,a})),r},l=(e,t,r)=>{const o=r.getShip().length;let a=[],n=e,l=t;if("horizontal"===r.getShip().orientation)for(;l!==t+o;)a.push([e,l]),l+=1;else for(;n!==e+o;)a.push([n,t]),n+=1;return a},u=(e,r,o)=>{let a=[],u=!0;return r+length-1>9||e>9||e+length-1>9||r>9?alert("Ship is out of bound"):(a=l(e,r,o),u=n(a),!1===u?(u=!0,a=[],alert("square is already occupied")):(o.getShip().comp=a,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:u,getBoard:()=>t,getShips:()=>a,receiveAttack:(e,a)=>(null===t[e][a]?r.push([e,a]):(o.push([e,a]),t[e][a].hit(),t[e][a].getShip().hitCoor.push([e,a])),t),getMisses:()=>r,getHits:()=>o,isAllSunk:()=>{const e=Object.values(a);let t=!0;return e.forEach((e=>{if(!e.isSunk())return t=!1})),t},populateBd:()=>{const e=Object.keys(a),r=["horizontal","vertical"];return e.forEach((e=>{const t=a[e],o=t.getShip().length;let c=Math.floor(10*Math.random()),d=Math.floor(10*Math.random()),s=Math.floor(2*Math.random());t.getShip().orientation=r[s];let i=l(c,d,t),m=n(i);for(;d+o-1>9||c+o-1>9||!1===m;)c=Math.floor(10*Math.random()),d=Math.floor(10*Math.random()),s=Math.floor(2*Math.random()),t.getShip().orientation=r[s],i=l(c,d,t),m=n(i);u(c,d,t)})),t},resetBoard:()=>{const e=Object.keys(a);t=[],r=[],o=[],e.forEach((e=>{a[e].resetShip()}))}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,a)=>{const n=e.board.getMisses();null===t?n.find((e=>e[0]===o&&e[1]===a))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===a))&&r.setAttribute("style","background-color: red;")},a=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const a=o[0][0],n=o[0][1];e.board.placeShip(a,n,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let a=document.getElementById(`board${r}`);for(;a.lastElementChild;)a.removeChild(a.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const u=document.createElement("div");u.classList.add(`${r}-square`),u.setAttribute("data-x",`${n}`),u.setAttribute("data-y",`${l}`),o(e,t[n][l],u,n,l),a.appendChild(u)}return a},n=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},l=(e,t,r)=>{let o,a,n;for("player-Two"===r?(o=t.board.getBoard(),a=t.board.getMisses(),n=document.querySelector(`#board${t.number}`)):(o=e.board.getBoard(),a=e.board.getMisses(),n=document.querySelector(`#board${e.number}`));n.lastElementChild;)n.removeChild(n.lastElementChild);for(let l=0;l<o.length;l++)for(let c=0;c<o.length;c++){const d=o[l][c],s=document.createElement("button");"player-One"===r?s.classList.add(`${e.number}-square`):s.classList.add(`${t.number}-square`),s.setAttribute("data-x",`${l}`),s.setAttribute("data-y",`${c}`),u(e,t,s),null!==d&&d.getShip().hitCount>0&&d.getShip().hitCoor.find((e=>e[0]===l&&e[1]===c))&&(s.setAttribute("style","background-color: red;"),s.setAttribute("disabled","")),a.find((e=>e[0]===l&&e[1]===c))&&(s.setAttribute("style","background-color: green;"),s.setAttribute("disabled","")),n.appendChild(s)}},u=(e,t,r)=>{const o=document.querySelector(".dialog"),a=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y")),u=document.querySelector(".winner"),c=document.querySelector(".end-game"),d=document.querySelector("#play-window"),s=document.querySelector(".player-name"),i=document.querySelector("main");r.addEventListener("click",(m=>{m.preventDefault();const h=r.getAttribute("class"),p=d.getAttribute("data-id"),b=i.getAttribute("class");let y,g;y="One-square"===h?e.board:t.board,g=y.getBoard(),y.receiveAttack(a,l),null===g[a][l]?(n("One-square"===h?t:e),r.setAttribute("style","background-color: yellow;"),s.textContent="pvc"===b?"Computer`s turn!":"player-One"===p?"Player Two`s turn!":"Player One`s turn!",o.showModal()):(r.setAttribute("style","background-color: red;"),y.isAllSunk()&&(r.setAttribute("style","background-color: red;"),c.showModal(),u.textContent="player-Two"===p?"Congratulations Player Two!":"Congratulations Player One!"))}))},c=document.querySelector(".game_mode"),d=document.querySelector("#pvp"),s=document.querySelector("#pvc"),i=document.querySelectorAll(".restart"),m=document.querySelector(".end-game"),h=document.querySelector("form");let p=r("One"),b=r("Two");var y,g;y=p,g=b,document.querySelector("#placeShipBtn").addEventListener("click",(e=>{e.preventDefault();let t=document.querySelector("form").getAttribute("id");const r=parseInt(document.querySelector("#y-coor").value),o=parseInt(document.querySelector("#x-coor").value),n=document.querySelector("#ships").value,l=document.querySelector("#orientation").value;let u;u="playerOne-form"===t?y.board.getShips()[n]:g.board.getShips()[n],u.getShip().orientation=l,Number.isNaN(r)||Number.isNaN(o)||("playerOne-form"===t?(y.board.placeShip(r,o,u),a(y)):(g.board.placeShip(r,o,u),a(g)))})),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector("#finBtn"),a=document.querySelector("form"),l=document.querySelector(".player-name");let u=!1;o.addEventListener("click",(o=>{let c;o.preventDefault();const d=r.getAttribute("class");let s=a.getAttribute("id");if(c="playerOne-form"===s?e.board.getShips():t.board.getShips(),Object.values(c).forEach((e=>{const t=e.getShip().comp;return u=0!==t.length})),u){const r=document.querySelector("#x-coor"),o=document.querySelector("#y-coor"),u=document.querySelector("#battleship");if(r.value="",o.value="",u.removeAttribute("selected"),u.setAttribute("selected",""),"playerOne-form"===s&&(a.setAttribute("id","playerTwo-form"),n(e)),"pvc"===d||"playerTwo-form"===s){a.setAttribute("style","display: none;"),n(t);const e=document.querySelector(".dialog");l.textContent="Player One`s turn!",e.showModal()}}else alert("Please place all the ships first")}))})(p,b),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),n=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(u=>{u.preventDefault(),u.stopPropagation();let c=n.getAttribute("data-id");if("player-Two"===c)return a(e),l(e,t,c),n.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===c){const u=r.getAttribute("class");return n.setAttribute("data-id",`player-${t.number}`),"pvc"===u?(((e,t)=>{const r=e.board,o=r.getBoard(),n=r.getMisses(),u=r.getHits(),c=document.querySelector("#play-window"),d=document.querySelector(".winner"),s=document.querySelector(".end-game");let i=Math.floor(10*Math.random()),m=Math.floor(10*Math.random()),h=!0;for(;!0===h;)if(n.find((e=>e[0]===i&&e[1]===m))||u.find((e=>e[0]===i&&e[1]===m)))i=Math.floor(10*Math.random()),m=Math.floor(10*Math.random());else if(r.receiveAttack(i,m),null===o[i][m]){const r=`player-${t.number}`;c.setAttribute("data-id",`player-${e.number}`),a(e),l(e,t,r),h=!1}else e.board.isAllSunk()?(h=!1,s.showModal(),d.textContent="Computer won!"):(i=Math.floor(10*Math.random()),m=Math.floor(10*Math.random()))})(e,t),o.close()):(a(t),l(e,t,c),o.close())}}))})(p,b),((e,t)=>{const r=document.querySelector("form");document.querySelector("#random").addEventListener("click",(o=>{o.preventDefault(),"playerOne-form"===r.getAttribute("id")?(e.board.populateBd(),a(e)):(t.board.populateBd(),a(t))}))})(p,b),a(p),a(b),d.addEventListener("click",(e=>(e.preventDefault(),c.close()))),s.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main");var r;return(r=b).board.populateBd(),a(r),n(r),t.classList.add("pvc"),c.close()})),i.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#play-window"),o=document.querySelector("#x-coor"),n=document.querySelector("#y-coor"),l=document.querySelector("#battleship");m.close(),h.setAttribute("id","playerOne-form"),h.removeAttribute("style"),t.classList.remove("pvc"),r.setAttribute("data-id","player-Two"),o.value="",n.value="",l.removeAttribute("selected"),l.setAttribute("selected",""),p.board.resetBoard(),b.board.resetBoard(),a(p),a(b),c.showModal()})))),document.addEventListener("onload",c.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBVTFHLE1BQU1rRCxhQUNoQnlELEVBQVUzRyxNQUFNa0QsYUFFaEJXLEVBQVk2QyxHQUNaN0MsRUFBWThDLEdBQ1pMLEVBQVNELFdBQVcsTUFJeEJqQyxTQUFTMEIsaUJBQWlCLFNBQVVRLEVBQVNELFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvRE9NLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNoaXAgPSAobikgPT4ge1xuICBsZXQgc2hpcE9iaiA9IHt9O1xuXG4gIHNoaXBPYmpbXCJsZW5ndGhcIl0gPSBuO1xuICBzaGlwT2JqW1wiaGl0Q291bnRcIl0gPSAwO1xuICBzaGlwT2JqW1wic3Vua1wiXSA9IGZhbHNlO1xuICBzaGlwT2JqW1wib3JpZW50YXRpb25cIl0gPSBcImhvcml6b250YWxcIjtcbiAgc2hpcE9ialtcImNvbXBcIl0gPSBbXTtcbiAgc2hpcE9ialtcImhpdENvb3JcIl0gPSBbXTtcblxuICBjb25zdCBnZXRTaGlwID0gKCkgPT4gc2hpcE9iajtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5oaXRDb3VudCArPSAxO1xuICAgIGlmIChzaGlwT2JqLmhpdENvdW50ID09PSBzaGlwT2JqLmxlbmd0aCkgc2hpcE9iai5zdW5rID0gdHJ1ZTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHNoaXBPYmouc3VuayA9PT0gdHJ1ZSA/IHRydWUgOiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCByZXNldFNoaXAgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5sZW5ndGggPSBuO1xuICAgIHNoaXBPYmouaGl0Q291bnQgPSAwO1xuICAgIHNoaXBPYmouc3VuayA9IGZhbHNlO1xuICAgIHNoaXBPYmoub3JpZW50YXRpb24gPSBcImhvcml6b250YWxcIjtcbiAgICBzaGlwT2JqLmNvbXAgPSBbXTtcbiAgICBzaGlwT2JqLmhpdENvb3IgPSBbXTtcblxuICAgIHJldHVybiBzaGlwT2JqO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgZ2V0U2hpcCxcbiAgICBoaXQsXG4gICAgaXNTdW5rLFxuICAgIHJlc2V0U2hpcCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFNoaXAgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5cbmNvbnN0IEdhbWVib2FyZCA9ICgpID0+IHtcbiAgbGV0IGJvYXJkID0gW107XG4gIGxldCBtaXNzZXMgPSBbXTtcbiAgbGV0IGhpdHMgPSBbXTtcblxuICBsZXQgYWxsU2hpcHMgPSB7XG4gICAgYmF0dGxlc2hpcDogU2hpcCg0KSxcbiAgICBjcnVpc2VyX0k6IFNoaXAoMyksXG4gICAgY3J1aXNlcl9JSTogU2hpcCgzKSxcbiAgICBkZXN0cm95ZXJfSTogU2hpcCgyKSxcbiAgICBkZXN0cm95ZXJfSUk6IFNoaXAoMiksXG4gICAgZGVzdHJveWVyX0lJSTogU2hpcCgyKSxcbiAgICBzdWJtYXJpbmVfSTogU2hpcCgxKSxcbiAgICBzdWJtYXJpbmVfSUk6IFNoaXAoMSksXG4gICAgc3VibWFyaW5lX0lJSTogU2hpcCgxKSxcbiAgICBzdWJtYXJpbmVfSVY6IFNoaXAoMSksXG4gIH07XG5cbiAgY29uc3QgZ2V0Qm9hcmQgPSAoKSA9PiBib2FyZDtcbiAgY29uc3QgZ2V0TWlzc2VzID0gKCkgPT4gbWlzc2VzO1xuICBjb25zdCBnZXRTaGlwcyA9ICgpID0+IGFsbFNoaXBzO1xuICBjb25zdCBnZXRIaXRzID0gKCkgPT4gaGl0cztcblxuICBjb25zdCBjcmVhdGVCb2FyZCA9ICgpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGJvYXJkW2ldID0gW107XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgYm9hcmRbaV1bal0gPSBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBpc0VtcHR5ID0gKHgsIHkpID0+IHtcbiAgICByZXR1cm4gYm9hcmRbeF1beV0gPT09IG51bGwgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgaXNGaXQgPSAoYXJyKSA9PiB7XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaWYgKGl0ZW1bMF0gPiA5IHx8IGl0ZW1bMV0gPiA5IHx8ICFpc0VtcHR5KGl0ZW1bMF0sIGl0ZW1bMV0pKVxuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0dXM7XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlQ29tcCA9ICh4LCB5LCBzaGlwKSA9PiB7XG4gICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb247XG4gICAgbGV0IHRlbXAgPSBbXTtcbiAgICBsZXQgYSA9IHg7XG4gICAgbGV0IGIgPSB5O1xuXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgd2hpbGUgKGIgIT09IHkgKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFt4LCBiXSk7XG4gICAgICAgIGIgKz0gMTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGEgIT09IHggKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFthLCB5XSk7XG4gICAgICAgIGEgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGVtcDtcbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBpZiAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCB5ID4gOSkge1xuICAgICAgcmV0dXJuIGFsZXJ0KFwiU2hpcCBpcyBvdXQgb2YgYm91bmRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgc3RhdHVzID0gaXNGaXQodGVtcCk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gZmFsc2UpIHtcbiAgICAgIHN0YXR1cyA9IHRydWU7XG4gICAgICB0ZW1wID0gW107XG4gICAgICByZXR1cm4gYWxlcnQoXCJzcXVhcmUgaXMgYWxyZWFkeSBvY2N1cGllZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2hpcC5nZXRTaGlwKCkuY29tcCA9IHRlbXA7XG5cbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICBib2FyZFtpdGVtWzBdXVtpdGVtWzFdXSA9IHNoaXA7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgcG9wdWxhdGVCZCA9ICgpID0+IHtcbiAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoYWxsU2hpcHMpO1xuICAgIGNvbnN0IGRpcmVjdGlvbnMgPSBbXCJob3Jpem9udGFsXCIsIFwidmVydGljYWxcIl07XG5cbiAgICBrZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgY29uc3Qgc2hpcCA9IGFsbFNoaXBzW2tleV07XG4gICAgICBjb25zdCBsZW5ndGggPSBzaGlwLmdldFNoaXAoKS5sZW5ndGg7XG5cbiAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBsZXQgeiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICBsZXQgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICBsZXQgZml0ID0gaXNGaXQodGVtcCk7XG5cbiAgICAgIHdoaWxlICh5ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeCArIGxlbmd0aCAtIDEgPiA5IHx8IGZpdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgICAgeiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gZGlyZWN0aW9uc1t6XTtcbiAgICAgICAgdGVtcCA9IGNyZWF0ZUNvbXAoeCwgeSwgc2hpcCk7XG4gICAgICAgIGZpdCA9IGlzRml0KHRlbXApO1xuICAgICAgfVxuXG4gICAgICBwbGFjZVNoaXAoeCwgeSwgc2hpcCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9ICh4LCB5KSA9PiB7XG4gICAgaWYgKGJvYXJkW3hdW3ldID09PSBudWxsKSBtaXNzZXMucHVzaChbeCwgeV0pO1xuICAgIGVsc2Uge1xuICAgICAgaGl0cy5wdXNoKFt4LCB5XSk7XG4gICAgICBib2FyZFt4XVt5XS5oaXQoKTtcbiAgICAgIGJvYXJkW3hdW3ldLmdldFNoaXAoKS5oaXRDb29yLnB1c2goW3gsIHldKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgaXNBbGxTdW5rID0gKCkgPT4ge1xuICAgIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhhbGxTaGlwcyk7XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBpZiAoIXNoaXAuaXNTdW5rKCkpIHtcbiAgICAgICAgcmV0dXJuIChzdGF0dXMgPSBmYWxzZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhdHVzO1xuICB9O1xuXG4gIGNvbnN0IHJlc2V0Qm9hcmQgPSAoKSA9PiB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFsbFNoaXBzKTtcbiAgICBib2FyZCA9IFtdO1xuICAgIG1pc3NlcyA9IFtdO1xuICAgIGhpdHMgPSBbXTtcblxuICAgIGtleXMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgYWxsU2hpcHNbc2hpcF0ucmVzZXRTaGlwKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVCb2FyZCxcbiAgICBwbGFjZVNoaXAsXG4gICAgZ2V0Qm9hcmQsXG4gICAgZ2V0U2hpcHMsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBnZXRNaXNzZXMsXG4gICAgZ2V0SGl0cyxcbiAgICBpc0FsbFN1bmssXG4gICAgcG9wdWxhdGVCZCxcbiAgICByZXNldEJvYXJkLFxuICB9O1xufTtcblxuZXhwb3J0IHsgR2FtZWJvYXJkIH07XG4iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gKG51bWJlcikgPT4ge1xuICBsZXQgd2luID0gZmFsc2U7XG4gIGxldCBib2FyZCA9IEdhbWVib2FyZCgpO1xuICBsZXQgaXNDb21wID0gZmFsc2U7XG5cbiAgcmV0dXJuIHtcbiAgICBudW1iZXIsXG4gICAgd2luLFxuICAgIGJvYXJkLFxuICAgIGlzQ29tcCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFBsYXllciB9O1xuIiwiY29uc3QgZmlsbFNxciA9IChwbGF5ZXIsIHNxciwgdGFnLCB4LCB5KSA9PiB7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcblxuICBpZiAoc3FyID09PSBudWxsKSB7XG4gICAgaWYgKFxuICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pXG4gICAgKSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBibHVlO1wiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXG4gICAgc3FyLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgfSlcbiAgKSB7XG4gICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgfVxufTtcblxuY29uc3QgcmVuZGVyU2hpcCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzTGlzdCA9IE9iamVjdC5rZXlzKHNoaXBzT2JqKTtcblxuICBzaGlwc0xpc3QuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IGNvbXAgPSBzaGlwc09ialtzaGlwXS5nZXRTaGlwKCkuY29tcDtcblxuICAgIGlmIChjb21wLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29uc3QgeENvb3IgPSBjb21wWzBdWzBdO1xuICAgICAgY29uc3QgeUNvb3IgPSBjb21wWzBdWzFdO1xuICAgICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXBzT2JqW3NoaXBdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn07XG5cbmNvbnN0IHJlbmRlckJvYXJkID0gKHBsYXllcikgPT4ge1xuICBwbGF5ZXIuYm9hcmQuY3JlYXRlQm9hcmQoKTtcblxuICByZW5kZXJTaGlwKHBsYXllcik7XG5cbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgcGxheWVyTnVtID0gcGxheWVyLm51bWJlcjtcbiAgbGV0IGN1cnJlbnRCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBib2FyZCR7cGxheWVyTnVtfWApO1xuXG4gIHdoaWxlIChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyZW50Qm9hcmQucmVtb3ZlQ2hpbGQoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyTnVtfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBmaWxsU3FyKHBsYXllciwgYm9hcmRbaV1bal0sIHNxdWFyZSwgaSwgaik7XG5cbiAgICAgIGN1cnJlbnRCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50Qm9hcmQ7XG59O1xuXG5jb25zdCBpbml0UGxhY2VTaGlwID0gKHBPbmUsIHBUd28pID0+IHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYWNlU2hpcEJ0bmApO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gICAgbGV0IGlkID0gZm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcblxuICAgIGNvbnN0IHhDb29yID0gcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3ktY29vcmApLnZhbHVlKTtcbiAgICBjb25zdCB5Q29vciA9IHBhcnNlSW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCN4LWNvb3JgKS52YWx1ZSk7XG4gICAgY29uc3Qgc2hpcE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjc2hpcHNgKS52YWx1ZTtcblxuICAgIGNvbnN0IG9yaWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNvcmllbnRhdGlvbmApLnZhbHVlO1xuXG4gICAgbGV0IHNoaXA7XG4gICAgaWQgPT09IFwicGxheWVyT25lLWZvcm1cIlxuICAgICAgPyAoc2hpcCA9IHBPbmUuYm9hcmQuZ2V0U2hpcHMoKVtzaGlwTmFtZV0pXG4gICAgICA6IChzaGlwID0gcFR3by5ib2FyZC5nZXRTaGlwcygpW3NoaXBOYW1lXSk7XG5cbiAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IG9yaWVudDtcblxuICAgIGlmIChOdW1iZXIuaXNOYU4oeENvb3IpIHx8IE51bWJlci5pc05hTih5Q29vcikpIHJldHVybjtcbiAgICBlbHNlIHtcbiAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiKSB7XG4gICAgICAgIHBPbmUuYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcCk7XG4gICAgICAgIHJlbmRlckJvYXJkKHBPbmUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcFR3by5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwKTtcbiAgICAgICAgcmVuZGVyQm9hcmQocFR3byk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IGluaXRGaW5TZXR1cCA9IChwT25lLCBwVHdvKSA9PiB7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2ZpbkJ0bmApO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgZm9ybWApO1xuICBjb25zdCBwbGF5ZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItbmFtZVwiKTtcblxuICBsZXQgaXNBbGxQbGFjZWQgPSBmYWxzZTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgbGV0IHNoaXBzT2JqO1xuICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgIGxldCBpZCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICBpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiXG4gICAgICA/IChzaGlwc09iaiA9IHBPbmUuYm9hcmQuZ2V0U2hpcHMoKSlcbiAgICAgIDogKHNoaXBzT2JqID0gcFR3by5ib2FyZC5nZXRTaGlwcygpKTtcblxuICAgIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhzaGlwc09iaik7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBjb25zdCBjb21wID0gc2hpcC5nZXRTaGlwKCkuY29tcDtcbiAgICAgIGlmIChjb21wLmxlbmd0aCA9PT0gMCkgcmV0dXJuIChpc0FsbFBsYWNlZCA9IGZhbHNlKTtcbiAgICAgIGVsc2UgcmV0dXJuIChpc0FsbFBsYWNlZCA9IHRydWUpO1xuICAgIH0pO1xuXG4gICAgaWYgKGlzQWxsUGxhY2VkKSB7XG4gICAgICBjb25zdCB4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN4LWNvb3JcIik7XG4gICAgICBjb25zdCB5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN5LWNvb3JcIik7XG4gICAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2JhdHRsZXNoaXBcIik7XG5cbiAgICAgIHgudmFsdWUgPSBcIlwiO1xuICAgICAgeS52YWx1ZSA9IFwiXCI7XG4gICAgICBvcHQucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgICBvcHQuc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJcIik7XG5cbiAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiKSB7XG4gICAgICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwbGF5ZXJUd28tZm9ybVwiKTtcbiAgICAgICAgaGlkZUJvYXJkKHBPbmUpO1xuICAgICAgfVxuXG4gICAgICBpZiAobW9kZSA9PT0gXCJwdmNcIiB8fCBpZCA9PT0gXCJwbGF5ZXJUd28tZm9ybVwiKSB7XG4gICAgICAgIGZvcm0uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lO1wiKTtcbiAgICAgICAgaGlkZUJvYXJkKHBUd28pO1xuICAgICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgICAgICAgcGxheWVyTmFtZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIE9uZWBzIHR1cm4hXCI7XG4gICAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoXCJQbGVhc2UgcGxhY2UgYWxsIHRoZSBzaGlwcyBmaXJzdFwiKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgaGlkZUJvYXJkID0gKHBsYXllcikgPT4ge1xuICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke3BsYXllci5udW1iZXJ9LXNxdWFyZWApO1xuXG4gIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyYXk7XCIpO1xuICB9KTtcbn07XG5cbmNvbnN0IGluaXRwbGF5QnRuID0gKFBPbmUsIFBUd28pID0+IHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXlcIik7XG5cbiAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBsZXQgcGxheWVyID0gcGxheVdpbmRvdy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuXG4gICAgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICAgIHJlbmRlckJvYXJkKFBPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKFBPbmUsIFBUd28sIHBsYXllcik7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke1BPbmUubnVtYmVyfWApO1xuICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgIH0gZWxzZSBpZiAocGxheWVyID09PSBcInBsYXllci1PbmVcIikge1xuICAgICAgY29uc3QgbW9kZSA9IG1haW4uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke1BUd28ubnVtYmVyfWApO1xuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIpIHtcbiAgICAgICAgYXV0b0F0ayhQT25lLCBQVHdvKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVuZGVyQm9hcmQoUFR3byk7XG4gICAgICAgIHJlbmRlclBsYXlCZChQT25lLCBQVHdvLCBwbGF5ZXIpO1xuICAgICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IHJlbmRlclBsYXlCZCA9IChwT25lLCBwVHdvLCBpZCkgPT4ge1xuICAvKiBjb25zdCBib2FyZCA9IHBsYXllci5ib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBtaXNzZXMgPSBwbGF5ZXIuYm9hcmQuZ2V0TWlzc2VzKCk7XG4gIGNvbnN0IGN1cnJCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNib2FyZCR7cGxheWVyLm51bWJlcn1gKTsgKi9cbiAgLyogY29uc3Qgd2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgY29uc3QgaWQgPSB3aW5kb3cuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTsgKi9cbiAgbGV0IGJvYXJkO1xuICBsZXQgbWlzc2VzO1xuICBsZXQgY3VyckJvYXJkO1xuXG4gIGlmIChpZCA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICBib2FyZCA9IHBUd28uYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgICBtaXNzZXMgPSBwVHdvLmJvYXJkLmdldE1pc3NlcygpO1xuICAgIGN1cnJCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNib2FyZCR7cFR3by5udW1iZXJ9YCk7XG4gIH0gZWxzZSB7XG4gICAgYm9hcmQgPSBwT25lLmJvYXJkLmdldEJvYXJkKCk7XG4gICAgbWlzc2VzID0gcE9uZS5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgICBjdXJyQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYm9hcmQke3BPbmUubnVtYmVyfWApO1xuICB9XG5cbiAgd2hpbGUgKGN1cnJCb2FyZC5sYXN0RWxlbWVudENoaWxkKVxuICAgIGN1cnJCb2FyZC5yZW1vdmVDaGlsZChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmQubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBib2FyZFtpXVtqXTtcblxuICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgIC8vc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyLm51bWJlcn0tc3F1YXJlYCk7XG4gICAgICBpZiAoaWQgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BPbmUubnVtYmVyfS1zcXVhcmVgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNxdWFyZS5jbGFzc0xpc3QuYWRkKGAke3BUd28ubnVtYmVyfS1zcXVhcmVgKTtcbiAgICAgIH1cblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBpbml0U3FyQnRuKHBPbmUsIHBUd28sIHNxdWFyZSk7XG5cbiAgICAgIGlmIChcbiAgICAgICAgaXRlbSAhPT0gbnVsbCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb3VudCA+IDAgJiZcbiAgICAgICAgaXRlbS5nZXRTaGlwKCkuaGl0Q29vci5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IGkgJiYgaXRlbVsxXSA9PT0gajtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyZWVuO1wiKTtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgICAgfVxuXG4gICAgICBjdXJyQm9hcmQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGluaXRTcXJCdG4gPSAocE9uZSwgcFR3bywgc3F1YXJlKSA9PiB7XG4gIC8qIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkO1xuICBjb25zdCBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpOyAqL1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgeCA9IHBhcnNlSW50KHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIikpO1xuICBjb25zdCB5ID0gcGFyc2VJbnQoc3F1YXJlLmdldEF0dHJpYnV0ZShcImRhdGEteVwiKSk7XG4gIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2lubmVyXCIpO1xuICBjb25zdCBlbmRNc2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVuZC1nYW1lXCIpO1xuICBjb25zdCB3aW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBjb25zdCBwbGF5ZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItbmFtZVwiKTtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuXG4gIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3Qgc3F1YXJlSWQgPSBzcXVhcmUuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG4gICAgY29uc3QgaWQgPSB3aW5kb3cuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcbiAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICBsZXQgYm9hcmQ7XG4gICAgbGV0IGJvYXJkTGlzdDtcblxuICAgIGlmIChzcXVhcmVJZCA9PT0gXCJPbmUtc3F1YXJlXCIpIHtcbiAgICAgIGJvYXJkID0gcE9uZS5ib2FyZDtcbiAgICB9IGVsc2Uge1xuICAgICAgYm9hcmQgPSBwVHdvLmJvYXJkO1xuICAgIH1cblxuICAgIGJvYXJkTGlzdCA9IGJvYXJkLmdldEJvYXJkKCk7XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIC8vaGlkZUJvYXJkKHBsYXllcik7XG4gICAgICBpZiAoc3F1YXJlSWQgPT09IFwiT25lLXNxdWFyZVwiKSB7XG4gICAgICAgIGhpZGVCb2FyZChwVHdvKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGhpZGVCb2FyZChwT25lKTtcbiAgICAgIH1cblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogeWVsbG93O1wiKTtcblxuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIpIHtcbiAgICAgICAgcGxheWVyTmFtZS50ZXh0Q29udGVudCA9IFwiQ29tcHV0ZXJgcyB0dXJuIVwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWQgPT09IFwicGxheWVyLU9uZVwiXG4gICAgICAgICAgPyAocGxheWVyTmFtZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIFR3b2BzIHR1cm4hXCIpXG4gICAgICAgICAgOiAocGxheWVyTmFtZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIE9uZWBzIHR1cm4hXCIpO1xuICAgICAgfVxuXG4gICAgICBkaWFsb2cuc2hvd01vZGFsKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG5cbiAgICAgIGlmIChib2FyZC5pc0FsbFN1bmsoKSkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgICAgICBlbmRNc2cuc2hvd01vZGFsKCk7XG4gICAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBgQ29uZ3JhdHVsYXRpb25zIFBsYXllciBUd28hYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBgQ29uZ3JhdHVsYXRpb25zIFBsYXllciBPbmUhYDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBjb21wTW9kZSA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyKTtcbiAgaGlkZUJvYXJkKHBsYXllcik7XG59O1xuXG5jb25zdCBhdXRvQXRrID0gKHBsYXlPbmUsIHBsYXlUd28pID0+IHtcbiAgY29uc3QgYm9hcmQgPSBwbGF5T25lLmJvYXJkO1xuICBjb25zdCBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBtaXNzZXMgPSBib2FyZC5nZXRNaXNzZXMoKTtcbiAgY29uc3QgaGl0cyA9IGJvYXJkLmdldEhpdHMoKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2lubmVyXCIpO1xuICBjb25zdCBlbmRNc2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVuZC1nYW1lXCIpO1xuICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCBjb250ID0gdHJ1ZTtcblxuICB3aGlsZSAoY29udCA9PT0gdHJ1ZSkge1xuICAgIGlmIChcbiAgICAgIG1pc3Nlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KSB8fFxuICAgICAgaGl0cy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KVxuICAgICkge1xuICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuXG4gICAgaWYgKGJvYXJkTGlzdFt4XVt5XSA9PT0gbnVsbCkge1xuICAgICAgY29uc3QgaWQgPSBgcGxheWVyLSR7cGxheVR3by5udW1iZXJ9YDtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7cGxheU9uZS5udW1iZXJ9YCk7XG4gICAgICByZW5kZXJCb2FyZChwbGF5T25lKTtcbiAgICAgIHJlbmRlclBsYXlCZChwbGF5T25lLCBwbGF5VHdvLCBpZCk7XG4gICAgICBjb250ID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChwbGF5T25lLmJvYXJkLmlzQWxsU3VuaygpKSB7XG4gICAgICAgIGNvbnQgPSBmYWxzZTtcbiAgICAgICAgZW5kTXNnLnNob3dNb2RhbCgpO1xuICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyIHdvbiFcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBpbml0UmFuZEJ0biA9IChwT25lLCBwVHdvKSA9PiB7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbiAgY29uc3QgcmFuZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcmFuZG9tXCIpO1xuXG4gIHJhbmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgaWQgPSBmb3JtLmdldEF0dHJpYnV0ZShcImlkXCIpO1xuXG4gICAgaWYgKGlkID09PSBcInBsYXllck9uZS1mb3JtXCIpIHtcbiAgICAgIHBPbmUuYm9hcmQucG9wdWxhdGVCZCgpO1xuICAgICAgcmVuZGVyQm9hcmQocE9uZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBUd28uYm9hcmQucG9wdWxhdGVCZCgpO1xuICAgICAgcmVuZGVyQm9hcmQocFR3byk7XG4gICAgfVxuICB9KTtcbn07XG5cbmV4cG9ydCB7XG4gIHJlbmRlckJvYXJkLFxuICBpbml0UGxhY2VTaGlwLFxuICBpbml0RmluU2V0dXAsXG4gIGluaXRwbGF5QnRuLFxuICBjb21wTW9kZSxcbiAgaW5pdFJhbmRCdG4sXG59O1xuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG4gIGluaXRSYW5kQnRuLFxufSBmcm9tIFwiLi9ET01cIjtcblxuY29uc3QgZ2FtZU1vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbWVfbW9kZVwiKTtcbmNvbnN0IHB2cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZwXCIpO1xuY29uc3QgcHZjQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwdmNcIik7XG5jb25zdCByZXN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXN0YXJ0XCIpO1xuY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbmxldCBwbGF5ZXJPbmUgPSBQbGF5ZXIoXCJPbmVcIik7XG5sZXQgcGxheWVyVHdvID0gUGxheWVyKFwiVHdvXCIpO1xuXG5pbml0UGxhY2VTaGlwKHBsYXllck9uZSwgcGxheWVyVHdvKTtcbmluaXRGaW5TZXR1cChwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5pbml0cGxheUJ0bihwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5pbml0UmFuZEJ0bihwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5yZW5kZXJCb2FyZChwbGF5ZXJPbmUpO1xucmVuZGVyQm9hcmQocGxheWVyVHdvKTtcblxucHZwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHJldHVybiBnYW1lTW9kZS5jbG9zZSgpO1xufSk7XG5cbnB2Y0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG5cbiAgY29tcE1vZGUocGxheWVyVHdvKTtcblxuICBtYWluLmNsYXNzTGlzdC5hZGQoXCJwdmNcIik7XG5cbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucmVzdGFydEJ0bi5mb3JFYWNoKChidXR0b24pID0+XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICAgIGNvbnN0IHdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gICAgY29uc3QgeCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeC1jb29yXCIpO1xuICAgIGNvbnN0IHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ktY29vclwiKTtcbiAgICBjb25zdCBvcHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2JhdHRsZXNoaXBcIik7XG5cbiAgICBlbmRNc2cuY2xvc2UoKTtcblxuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwbGF5ZXJPbmUtZm9ybVwiKTtcbiAgICBmb3JtLnJlbW92ZUF0dHJpYnV0ZShcInN0eWxlXCIpO1xuICAgIG1haW4uY2xhc3NMaXN0LnJlbW92ZShcInB2Y1wiKTtcbiAgICB3aW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBcInBsYXllci1Ud29cIik7XG5cbiAgICB4LnZhbHVlID0gXCJcIjtcbiAgICB5LnZhbHVlID0gXCJcIjtcbiAgICBvcHQucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgb3B0LnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIFwiXCIpO1xuXG4gICAgcGxheWVyT25lLmJvYXJkLnJlc2V0Qm9hcmQoKTtcbiAgICBwbGF5ZXJUd28uYm9hcmQucmVzZXRCb2FyZCgpO1xuXG4gICAgcmVuZGVyQm9hcmQocGxheWVyT25lKTtcbiAgICByZW5kZXJCb2FyZChwbGF5ZXJUd28pO1xuICAgIGdhbWVNb2RlLnNob3dNb2RhbCgpO1xuICB9KVxuKTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubG9hZFwiLCBnYW1lTW9kZS5zaG93TW9kYWwoKSk7XG4iXSwibmFtZXMiOlsiU2hpcCIsIm4iLCJzaGlwT2JqIiwiZ2V0U2hpcCIsImhpdCIsImhpdENvdW50IiwibGVuZ3RoIiwic3VuayIsImlzU3VuayIsInJlc2V0U2hpcCIsIm9yaWVudGF0aW9uIiwiY29tcCIsImhpdENvb3IiLCJHYW1lYm9hcmQiLCJib2FyZCIsIm1pc3NlcyIsImhpdHMiLCJhbGxTaGlwcyIsImJhdHRsZXNoaXAiLCJjcnVpc2VyX0kiLCJjcnVpc2VyX0lJIiwiZGVzdHJveWVyX0kiLCJkZXN0cm95ZXJfSUkiLCJkZXN0cm95ZXJfSUlJIiwic3VibWFyaW5lX0kiLCJzdWJtYXJpbmVfSUkiLCJzdWJtYXJpbmVfSUlJIiwic3VibWFyaW5lX0lWIiwiaXNGaXQiLCJhcnIiLCJzdGF0dXMiLCJmb3JFYWNoIiwiaXRlbSIsIngiLCJ5IiwiY3JlYXRlQ29tcCIsInNoaXAiLCJ0ZW1wIiwiYSIsImIiLCJwdXNoIiwicGxhY2VTaGlwIiwiYWxlcnQiLCJjcmVhdGVCb2FyZCIsImkiLCJqIiwiZ2V0Qm9hcmQiLCJnZXRTaGlwcyIsInJlY2VpdmVBdHRhY2siLCJnZXRNaXNzZXMiLCJnZXRIaXRzIiwiaXNBbGxTdW5rIiwic2hpcHMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJwb3B1bGF0ZUJkIiwia2V5cyIsImRpcmVjdGlvbnMiLCJrZXkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ6IiwiZml0IiwicmVzZXRCb2FyZCIsIlBsYXllciIsIm51bWJlciIsIndpbiIsImlzQ29tcCIsImZpbGxTcXIiLCJwbGF5ZXIiLCJzcXIiLCJ0YWciLCJmaW5kIiwic2V0QXR0cmlidXRlIiwicmVuZGVyQm9hcmQiLCJzaGlwc09iaiIsInhDb29yIiwieUNvb3IiLCJyZW5kZXJTaGlwIiwicGxheWVyTnVtIiwiY3VycmVudEJvYXJkIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxhc3RFbGVtZW50Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInNxdWFyZSIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImhpZGVCb2FyZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZW5kZXJQbGF5QmQiLCJwT25lIiwicFR3byIsImlkIiwiY3VyckJvYXJkIiwicXVlcnlTZWxlY3RvciIsImluaXRTcXJCdG4iLCJkaWFsb2ciLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsIndpbm5lciIsImVuZE1zZyIsIndpbmRvdyIsInBsYXllck5hbWUiLCJtYWluIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInNxdWFyZUlkIiwibW9kZSIsImJvYXJkTGlzdCIsInRleHRDb250ZW50Iiwic2hvd01vZGFsIiwiZ2FtZU1vZGUiLCJwdnBCdG4iLCJwdmNCdG4iLCJyZXN0YXJ0QnRuIiwicGxheWVyT25lIiwicGxheWVyVHdvIiwidmFsdWUiLCJzaGlwTmFtZSIsIm9yaWVudCIsIk51bWJlciIsImlzTmFOIiwiYnV0dG9uIiwiZm9ybSIsImlzQWxsUGxhY2VkIiwib3B0IiwicmVtb3ZlQXR0cmlidXRlIiwiaW5pdEZpblNldHVwIiwiUE9uZSIsIlBUd28iLCJwbGF5V2luZG93Iiwic3RvcFByb3BhZ2F0aW9uIiwiY2xvc2UiLCJwbGF5T25lIiwicGxheVR3byIsImNvbnQiLCJhdXRvQXRrIiwiaW5pdHBsYXlCdG4iLCJpbml0UmFuZEJ0biIsInJlbW92ZSJdLCJzb3VyY2VSb290IjoiIn0=