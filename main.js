(()=>{"use strict";const e=(e,t)=>{let r={};return r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],{getShip:()=>r,hit:()=>{r.hitCount+=1,r.hitCount===r.length&&(r.sunk=!0)},isSunk:()=>!0===r.sunk,resetShip:()=>(r.name=t,r.length=e,r.hitCount=0,r.sunk=!1,r.orientation="horizontal",r.comp=[],r.hitCoor=[],r)}},t=()=>{let t=[],r=[],o=[],a={battleship:e(4,"battleship"),cruiser_I:e(3,"cruiser_I"),cruiser_II:e(3,"cruiser_II"),destroyer_I:e(2,"destroyer_I"),destroyer_II:e(2,"destroyer_II"),destroyer_III:e(2,"destroyer_III"),submarine_I:e(1,"submarine_I"),submarine_II:e(1,"submarine_II"),submarine_III:e(1,"submarine_III"),submarine_IV:e(1,"submarine_IV")};const n=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],a=e[1],null!==t[o][a]))return r=!1;var o,a})),r},l=(e,t,r)=>{const o=r.getShip().length;let a=[],n=e,l=t;if("horizontal"===r.getShip().orientation)for(;l!==t+o;)a.push([e,l]),l+=1;else for(;n!==e+o;)a.push([n,t]),n+=1;return a},u=(e,r,o)=>{let a=[],u=!0;return r+length-1>9||e>9||e+length-1>9||r>9?alert("Ship is out of bound"):(a=l(e,r,o),u=n(a),!1===u?(u=!0,a=[],alert("square is already occupied")):(o.getShip().comp=a,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:u,getBoard:()=>t,getShips:()=>a,receiveAttack:(e,a)=>(null===t[e][a]?r.push([e,a]):(o.push([e,a]),t[e][a].hit(),t[e][a].getShip().hitCoor.push([e,a])),t),getMisses:()=>r,getHits:()=>o,isAllSunk:()=>{const e=Object.values(a);let t=!0;return e.forEach((e=>{if(!e.isSunk())return t=!1})),t},populateBd:()=>{const e=Object.keys(a),r=["horizontal","vertical"];return e.forEach((e=>{const t=a[e],o=t.getShip().length;let c=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),i=Math.floor(2*Math.random());t.getShip().orientation=r[i];let d=l(c,s,t),m=n(d);for(;s+o-1>9||c+o-1>9||!1===m;)c=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),i=Math.floor(2*Math.random()),t.getShip().orientation=r[i],d=l(c,s,t),m=n(d);u(c,s,t)})),t},resetBoard:()=>{const e=Object.keys(a);t=[],r=[],o=[],e.forEach((e=>{a[e].resetShip()}))}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,a)=>{const n=e.board.getMisses();null===t?n.find((e=>e[0]===o&&e[1]===a))?r.setAttribute("style","background-color: #FCCD2A;"):r.setAttribute("style","background-color: #6A9AB0;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===a))?r.setAttribute("style","background-color: #D91656;"):r.setAttribute("style","background-color: #FCFAEE;")},a=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const a=o[0][0],n=o[0][1];e.board.placeShip(a,n,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let a=document.getElementById(`board${r}`);for(;a.lastElementChild;)a.removeChild(a.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const u=document.createElement("div");u.classList.add(`${r}-square`),u.setAttribute("data-x",`${n}`),u.setAttribute("data-y",`${l}`),o(e,t[n][l],u,n,l),a.appendChild(u)}return a},n=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},l=(e,t,r)=>{let o,a,n;for("player-Two"===r?(o=t.board.getBoard(),a=t.board.getMisses(),n=document.querySelector(`#board${t.number}`)):(o=e.board.getBoard(),a=e.board.getMisses(),n=document.querySelector(`#board${e.number}`));n.lastElementChild;)n.removeChild(n.lastElementChild);for(let l=0;l<o.length;l++)for(let c=0;c<o.length;c++){const s=o[l][c],i=document.createElement("button");"player-One"===r?i.classList.add(`${e.number}-square`):i.classList.add(`${t.number}-square`),i.setAttribute("data-x",`${l}`),i.setAttribute("data-y",`${c}`),u(e,t,i),null!==s&&s.getShip().hitCount>0&&s.getShip().hitCoor.find((e=>e[0]===l&&e[1]===c))&&(i.setAttribute("style","background-color: #D91656;"),i.setAttribute("disabled","")),a.find((e=>e[0]===l&&e[1]===c))&&(i.setAttribute("style","background-color: #15B392;"),i.setAttribute("disabled","")),n.appendChild(i)}},u=(e,t,r)=>{const o=document.querySelector(".dialog"),a=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y")),u=document.querySelector(".winner"),c=document.querySelector(".end-game"),i=document.querySelector("#play-window"),d=document.querySelector(".player-name"),m=document.querySelector("main");r.addEventListener("click",(h=>{h.preventDefault();const p=r.getAttribute("class"),y=i.getAttribute("data-id"),b=m.getAttribute("class");let S,g;S="One-square"===p?e.board:t.board,g=S.getBoard(),S.receiveAttack(a,l),null===g[a][l]?(n("One-square"===p?t:e),r.setAttribute("style","background-color: #FCCD2A;"),d.textContent="pvc"===b?"Computer`s turn!":"player-One"===y?"Player Two`s turn!":"Player One`s turn!",o.showModal()):(s(g[a][l],"One-square"===p?e.number:t.number),r.setAttribute("style","background-color: #D91656;"),S.isAllSunk()&&(r.setAttribute("style","background-color: #D91656;"),c.showModal(),u.textContent="player-Two"===y?"Congratulations Player Two!":"Congratulations Player One!"))}))},c=e=>{const t=e.board.getShips()[document.querySelector("#ships").value].getShip().length,r=document.querySelector(".shape");for(;r.lastElementChild;)r.removeChild(r.lastElementChild);for(let e=1;e<=t;e++){const e=document.createElement("div");e.classList.add("square"),r.appendChild(e)}},s=(e,t)=>{const r=e.getShip().name,o=document.querySelector(`.shiplist-${t}`).querySelector(`.${r}`).querySelectorAll(".square");e.isSunk()&&o.forEach((e=>{e.setAttribute("style","background-color: #D91656;")}))},i=document.querySelector(".game_mode"),d=document.querySelector("#pvp"),m=document.querySelector("#pvc"),h=document.querySelectorAll(".restart"),p=document.querySelector(".end-game"),y=document.querySelector("form"),b=document.querySelector("#ships"),S=document.querySelector("#orientation");let g=r("One"),f=r("Two");var q,v;q=g,v=f,document.querySelector("#placeShipBtn").addEventListener("click",(e=>{e.preventDefault();let t=document.querySelector("form").getAttribute("id");const r=parseInt(document.querySelector("#y-coor").value),o=parseInt(document.querySelector("#x-coor").value),n=document.querySelector("#ships").value,l=document.querySelector("#orientation").value;let u;u="playerOne-form"===t?q.board.getShips()[n]:v.board.getShips()[n],u.getShip().orientation=l,Number.isNaN(r)||Number.isNaN(o)||("playerOne-form"===t?(q.board.placeShip(r,o,u),a(q)):(v.board.placeShip(r,o,u),a(v)))})),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector("#finBtn"),a=document.querySelector("form"),l=document.querySelector(".player-name");let u=!1;o.addEventListener("click",(o=>{let s;o.preventDefault();const i=r.getAttribute("class");let d=a.getAttribute("id");if(s="playerOne-form"===d?e.board.getShips():t.board.getShips(),Object.values(s).forEach((e=>{const t=e.getShip().comp;return u=0!==t.length})),u){const r=document.querySelector(".shape"),o=document.querySelector("#ships"),u=document.querySelector("#x-coor"),s=document.querySelector("#y-coor"),m=o.querySelector(".battleship"),h=document.querySelector(".message"),p=document.querySelector("span");if(u.value="",s.value="",r.classList.remove("vertical"),m.removeAttribute("selected"),m.setAttribute("selected",""),c(t),"playerOne-form"===d&&(p.textContent="Player Two",a.setAttribute("id","playerTwo-form"),n(e)),"pvc"===i||"playerTwo-form"===d){a.setAttribute("style","display: none;"),h.setAttribute("style","display: none;"),n(t);const e=document.querySelector(".dialog");l.textContent="Player One`s turn!",e.showModal()}}else alert("Please place all the ships first")}))})(g,f),((e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),n=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(u=>{u.preventDefault();let c=n.getAttribute("data-id");if("player-Two"===c)return a(e),l(e,t,c),n.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===c){const u=r.getAttribute("class");return n.setAttribute("data-id",`player-${t.number}`),"pvc"===u?(((e,t)=>{const r=e.board,o=r.getBoard(),n=r.getMisses(),u=r.getHits(),c=document.querySelector("#play-window"),i=document.querySelector(".winner"),d=document.querySelector(".end-game");let m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()),p=!0;for(;!0===p;)if(n.find((e=>e[0]===m&&e[1]===h))||u.find((e=>e[0]===m&&e[1]===h)))m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random());else if(r.receiveAttack(m,h),null===o[m][h]){const r=`player-${t.number}`;c.setAttribute("data-id",`player-${e.number}`),a(e),l(e,t,r),p=!1}else e.board.isAllSunk()?(p=!1,d.showModal(),i.textContent="Computer won!"):(s(e.board.getBoard()[m][h],e.number),m=Math.floor(10*Math.random()),h=Math.floor(10*Math.random()))})(e,t),o.close()):(a(t),l(e,t,c),o.close())}}))})(g,f),((e,t)=>{const r=document.querySelector("form");document.querySelector("#random").addEventListener("click",(o=>{o.preventDefault(),"playerOne-form"===r.getAttribute("id")?(e.board.populateBd(),a(e)):(t.board.populateBd(),a(t))}))})(g,f),a(g),a(f),c(g),d.addEventListener("click",(e=>(e.preventDefault(),i.close()))),m.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main");var r;return(r=f).board.populateBd(),a(r),n(r),t.classList.add("pvc"),i.close()})),h.forEach((e=>e.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#play-window"),o=document.querySelector("#x-coor"),n=document.querySelector("#y-coor"),l=b.querySelector(".battleship"),u=document.querySelectorAll(".square"),s=document.querySelector(".shape"),d=document.querySelector(".message"),m=document.querySelector("span");p.close(),y.setAttribute("id","playerOne-form"),y.removeAttribute("style"),t.classList.remove("pvc"),s.classList.remove("vertical"),r.setAttribute("data-id","player-Two"),u.forEach((e=>{e.removeAttribute("style")})),o.value="",n.value="",l.removeAttribute("selected"),l.setAttribute("selected",""),m.textContent="Player One",d.removeAttribute("style"),c(g),g.board.resetBoard(),f.board.resetBoard(),a(g),a(f),i.showModal()})))),b.addEventListener("change",(()=>{c(g)})),S.addEventListener("change",(()=>{const e=document.querySelector(".shape");"vertical"===S.value?e.classList.add("vertical"):e.classList.remove("vertical")})),document.addEventListener("onload",i.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQU93QyxRQUVQLEVBQUt0RSxhQUFhLEtBQU0sa0JBQ3hCLEVBQUtpRSxnQkFBZ0IsU0FDckJoQyxFQUFLbkIsVUFBVWtELE9BQU8sT0FDdEJuQixFQUFVL0IsVUFBVWtELE9BQU8sWUFDM0JqQyxFQUFPL0IsYUFBYSxVQUFXLGNBRS9COEMsRUFBUXpGLFNBQVN1RCxJQUNmQSxFQUFPcUQsZ0JBQWdCLFFBQVEsSUFHakMxRyxFQUFFcUYsTUFBUSxHQUNWcEYsRUFBRW9GLE1BQVEsR0FDVmlCLEVBQUlJLGdCQUFnQixZQUNwQkosRUFBSTdELGFBQWEsV0FBWSxJQUU3QitELEVBQUt2QixZQUFjLGFBQ25Cc0IsRUFBUUcsZ0JBQWdCLFNBRXhCdEIsRUFBWVMsR0FDWkEsRUFBVWhILE1BQU1rRCxhQUNoQitELEVBQVVqSCxNQUFNa0QsYUFFaEJXLEVBQVltRCxHQUNabkQsRUFBWW9ELEdBQ1pOLEVBQVNOLFdBQVcsTUFJeEIsRUFBT1AsaUJBQWlCLFVBQVUsS0FDaENTLEVBQVlTLEVBQVUsSUFHeEJELEVBQVNqQixpQkFBaUIsVUFBVSxLQUNsQyxNQUFNVyxFQUFZckMsU0FBU2dCLGNBQWMsVUFFbEIsYUFBbkIyQixFQUFTUCxNQUNYQyxFQUFVL0IsVUFBVUMsSUFBSSxZQUV4QjhCLEVBQVUvQixVQUFVa0QsT0FBTyxXQUM3QixJQUdGeEQsU0FBUzBCLGlCQUFpQixTQUFVYSxFQUFTTixZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL0RPTS5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaGlwID0gKG4sIG5hbWUpID0+IHtcbiAgbGV0IHNoaXBPYmogPSB7fTtcblxuICBzaGlwT2JqW1wibmFtZVwiXSA9IG5hbWU7XG4gIHNoaXBPYmpbXCJsZW5ndGhcIl0gPSBuO1xuICBzaGlwT2JqW1wiaGl0Q291bnRcIl0gPSAwO1xuICBzaGlwT2JqW1wic3Vua1wiXSA9IGZhbHNlO1xuICBzaGlwT2JqW1wib3JpZW50YXRpb25cIl0gPSBcImhvcml6b250YWxcIjtcbiAgc2hpcE9ialtcImNvbXBcIl0gPSBbXTtcbiAgc2hpcE9ialtcImhpdENvb3JcIl0gPSBbXTtcblxuICBjb25zdCBnZXRTaGlwID0gKCkgPT4gc2hpcE9iajtcblxuICBjb25zdCBoaXQgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5oaXRDb3VudCArPSAxO1xuICAgIGlmIChzaGlwT2JqLmhpdENvdW50ID09PSBzaGlwT2JqLmxlbmd0aCkgc2hpcE9iai5zdW5rID0gdHJ1ZTtcbiAgfTtcblxuICBjb25zdCBpc1N1bmsgPSAoKSA9PiB7XG4gICAgcmV0dXJuIHNoaXBPYmouc3VuayA9PT0gdHJ1ZSA/IHRydWUgOiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCByZXNldFNoaXAgPSAoKSA9PiB7XG4gICAgc2hpcE9iai5uYW1lID0gbmFtZTtcbiAgICBzaGlwT2JqLmxlbmd0aCA9IG47XG4gICAgc2hpcE9iai5oaXRDb3VudCA9IDA7XG4gICAgc2hpcE9iai5zdW5rID0gZmFsc2U7XG4gICAgc2hpcE9iai5vcmllbnRhdGlvbiA9IFwiaG9yaXpvbnRhbFwiO1xuICAgIHNoaXBPYmouY29tcCA9IFtdO1xuICAgIHNoaXBPYmouaGl0Q29vciA9IFtdO1xuXG4gICAgcmV0dXJuIHNoaXBPYmo7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRTaGlwLFxuICAgIGhpdCxcbiAgICBpc1N1bmssXG4gICAgcmVzZXRTaGlwLFxuICB9O1xufTtcblxuZXhwb3J0IHsgU2hpcCB9O1xuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcblxuY29uc3QgR2FtZWJvYXJkID0gKCkgPT4ge1xuICBsZXQgYm9hcmQgPSBbXTtcbiAgbGV0IG1pc3NlcyA9IFtdO1xuICBsZXQgaGl0cyA9IFtdO1xuXG4gIGxldCBhbGxTaGlwcyA9IHtcbiAgICBiYXR0bGVzaGlwOiBTaGlwKDQsIFwiYmF0dGxlc2hpcFwiKSxcbiAgICBjcnVpc2VyX0k6IFNoaXAoMywgXCJjcnVpc2VyX0lcIiksXG4gICAgY3J1aXNlcl9JSTogU2hpcCgzLCBcImNydWlzZXJfSUlcIiksXG4gICAgZGVzdHJveWVyX0k6IFNoaXAoMiwgXCJkZXN0cm95ZXJfSVwiKSxcbiAgICBkZXN0cm95ZXJfSUk6IFNoaXAoMiwgXCJkZXN0cm95ZXJfSUlcIiksXG4gICAgZGVzdHJveWVyX0lJSTogU2hpcCgyLCBcImRlc3Ryb3llcl9JSUlcIiksXG4gICAgc3VibWFyaW5lX0k6IFNoaXAoMSwgXCJzdWJtYXJpbmVfSVwiKSxcbiAgICBzdWJtYXJpbmVfSUk6IFNoaXAoMSwgXCJzdWJtYXJpbmVfSUlcIiksXG4gICAgc3VibWFyaW5lX0lJSTogU2hpcCgxLCBcInN1Ym1hcmluZV9JSUlcIiksXG4gICAgc3VibWFyaW5lX0lWOiBTaGlwKDEsIFwic3VibWFyaW5lX0lWXCIpLFxuICB9O1xuXG4gIGNvbnN0IGdldEJvYXJkID0gKCkgPT4gYm9hcmQ7XG4gIGNvbnN0IGdldE1pc3NlcyA9ICgpID0+IG1pc3NlcztcbiAgY29uc3QgZ2V0U2hpcHMgPSAoKSA9PiBhbGxTaGlwcztcbiAgY29uc3QgZ2V0SGl0cyA9ICgpID0+IGhpdHM7XG5cbiAgY29uc3QgY3JlYXRlQm9hcmQgPSAoKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBib2FyZFtpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGJvYXJkW2ldW2pdID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgaXNFbXB0eSA9ICh4LCB5KSA9PiB7XG4gICAgcmV0dXJuIGJvYXJkW3hdW3ldID09PSBudWxsID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGlzRml0ID0gKGFycikgPT4ge1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgYXJyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGlmIChpdGVtWzBdID4gOSB8fCBpdGVtWzFdID4gOSB8fCAhaXNFbXB0eShpdGVtWzBdLCBpdGVtWzFdKSlcbiAgICAgICAgcmV0dXJuIChzdGF0dXMgPSBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhdHVzO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZUNvbXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcbiAgICBjb25zdCBvcmllbnRhdGlvbiA9IHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uO1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IGEgPSB4O1xuICAgIGxldCBiID0geTtcblxuICAgIGlmIChvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgIHdoaWxlIChiICE9PSB5ICsgbGVuZ3RoKSB7XG4gICAgICAgIHRlbXAucHVzaChbeCwgYl0pO1xuICAgICAgICBiICs9IDE7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChhICE9PSB4ICsgbGVuZ3RoKSB7XG4gICAgICAgIHRlbXAucHVzaChbYSwgeV0pO1xuICAgICAgICBhICs9IDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRlbXA7XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKHgsIHksIHNoaXApID0+IHtcbiAgICBsZXQgdGVtcCA9IFtdO1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgaWYgKHkgKyBsZW5ndGggLSAxID4gOSB8fCB4ID4gOSB8fCB4ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeSA+IDkpIHtcbiAgICAgIHJldHVybiBhbGVydChcIlNoaXAgaXMgb3V0IG9mIGJvdW5kXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgIHN0YXR1cyA9IGlzRml0KHRlbXApO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXMgPT09IGZhbHNlKSB7XG4gICAgICBzdGF0dXMgPSB0cnVlO1xuICAgICAgdGVtcCA9IFtdO1xuICAgICAgcmV0dXJuIGFsZXJ0KFwic3F1YXJlIGlzIGFscmVhZHkgb2NjdXBpZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAgPSB0ZW1wO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5jb21wLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgYm9hcmRbaXRlbVswXV1baXRlbVsxXV0gPSBzaGlwO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHBvcHVsYXRlQmQgPSAoKSA9PiB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFsbFNoaXBzKTtcbiAgICBjb25zdCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xuXG4gICAga2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IHNoaXAgPSBhbGxTaGlwc1trZXldO1xuICAgICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuXG4gICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBkaXJlY3Rpb25zW3pdO1xuICAgICAgbGV0IHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgbGV0IGZpdCA9IGlzRml0KHRlbXApO1xuXG4gICAgICB3aGlsZSAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCBmaXQgPT09IGZhbHNlKSB7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgICBmaXQgPSBpc0ZpdCh0ZW1wKTtcbiAgICAgIH1cblxuICAgICAgcGxhY2VTaGlwKHgsIHksIHNoaXApO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoeCwgeSkgPT4ge1xuICAgIGlmIChib2FyZFt4XVt5XSA9PT0gbnVsbCkgbWlzc2VzLnB1c2goW3gsIHldKTtcbiAgICBlbHNlIHtcbiAgICAgIGhpdHMucHVzaChbeCwgeV0pO1xuICAgICAgYm9hcmRbeF1beV0uaGl0KCk7XG4gICAgICBib2FyZFt4XVt5XS5nZXRTaGlwKCkuaGl0Q29vci5wdXNoKFt4LCB5XSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IGlzQWxsU3VuayA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoYWxsU2hpcHMpO1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgaWYgKCFzaGlwLmlzU3VuaygpKSB7XG4gICAgICAgIHJldHVybiAoc3RhdHVzID0gZmFsc2UpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXR1cztcbiAgfTtcblxuICBjb25zdCByZXNldEJvYXJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhbGxTaGlwcyk7XG4gICAgYm9hcmQgPSBbXTtcbiAgICBtaXNzZXMgPSBbXTtcbiAgICBoaXRzID0gW107XG5cbiAgICBrZXlzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGFsbFNoaXBzW3NoaXBdLnJlc2V0U2hpcCgpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgY3JlYXRlQm9hcmQsXG4gICAgcGxhY2VTaGlwLFxuICAgIGdldEJvYXJkLFxuICAgIGdldFNoaXBzLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgZ2V0TWlzc2VzLFxuICAgIGdldEhpdHMsXG4gICAgaXNBbGxTdW5rLFxuICAgIHBvcHVsYXRlQmQsXG4gICAgcmVzZXRCb2FyZCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IEdhbWVib2FyZCB9O1xuIiwiaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmNvbnN0IFBsYXllciA9IChudW1iZXIpID0+IHtcbiAgbGV0IHdpbiA9IGZhbHNlO1xuICBsZXQgYm9hcmQgPSBHYW1lYm9hcmQoKTtcbiAgbGV0IGlzQ29tcCA9IGZhbHNlO1xuXG4gIHJldHVybiB7XG4gICAgbnVtYmVyLFxuICAgIHdpbixcbiAgICBib2FyZCxcbiAgICBpc0NvbXAsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImNvbnN0IGZpbGxTcXIgPSAocGxheWVyLCBzcXIsIHRhZywgeCwgeSkgPT4ge1xuICBjb25zdCBtaXNzZXMgPSBwbGF5ZXIuYm9hcmQuZ2V0TWlzc2VzKCk7XG5cbiAgaWYgKHNxciA9PT0gbnVsbCkge1xuICAgIGlmIChcbiAgICAgIG1pc3Nlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KVxuICAgICkge1xuICAgICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogI0ZDQ0QyQTtcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhZy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6ICM2QTlBQjA7XCIpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChcbiAgICBzcXIuZ2V0U2hpcCgpLmhpdENvb3IuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICB9KVxuICApIHtcbiAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiAjRDkxNjU2O1wiKTtcbiAgfSBlbHNlIHtcbiAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiAjRkNGQUVFO1wiKTtcbiAgfVxufTtcblxuY29uc3QgcmVuZGVyU2hpcCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzTGlzdCA9IE9iamVjdC5rZXlzKHNoaXBzT2JqKTtcblxuICBzaGlwc0xpc3QuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IGNvbXAgPSBzaGlwc09ialtzaGlwXS5nZXRTaGlwKCkuY29tcDtcblxuICAgIGlmIChjb21wLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29uc3QgeENvb3IgPSBjb21wWzBdWzBdO1xuICAgICAgY29uc3QgeUNvb3IgPSBjb21wWzBdWzFdO1xuICAgICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXBzT2JqW3NoaXBdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn07XG5cbmNvbnN0IHJlbmRlckJvYXJkID0gKHBsYXllcikgPT4ge1xuICBwbGF5ZXIuYm9hcmQuY3JlYXRlQm9hcmQoKTtcblxuICByZW5kZXJTaGlwKHBsYXllcik7XG5cbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgcGxheWVyTnVtID0gcGxheWVyLm51bWJlcjtcbiAgbGV0IGN1cnJlbnRCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBib2FyZCR7cGxheWVyTnVtfWApO1xuXG4gIHdoaWxlIChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyZW50Qm9hcmQucmVtb3ZlQ2hpbGQoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyTnVtfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBmaWxsU3FyKHBsYXllciwgYm9hcmRbaV1bal0sIHNxdWFyZSwgaSwgaik7XG5cbiAgICAgIGN1cnJlbnRCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50Qm9hcmQ7XG59O1xuXG5jb25zdCBpbml0UGxhY2VTaGlwID0gKHBPbmUsIHBUd28pID0+IHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYWNlU2hpcEJ0bmApO1xuXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gICAgbGV0IGlkID0gZm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcblxuICAgIGNvbnN0IHhDb29yID0gcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3ktY29vcmApLnZhbHVlKTtcbiAgICBjb25zdCB5Q29vciA9IHBhcnNlSW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCN4LWNvb3JgKS52YWx1ZSk7XG4gICAgY29uc3Qgc2hpcE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjc2hpcHNgKS52YWx1ZTtcblxuICAgIGNvbnN0IG9yaWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNvcmllbnRhdGlvbmApLnZhbHVlO1xuXG4gICAgbGV0IHNoaXA7XG4gICAgaWQgPT09IFwicGxheWVyT25lLWZvcm1cIlxuICAgICAgPyAoc2hpcCA9IHBPbmUuYm9hcmQuZ2V0U2hpcHMoKVtzaGlwTmFtZV0pXG4gICAgICA6IChzaGlwID0gcFR3by5ib2FyZC5nZXRTaGlwcygpW3NoaXBOYW1lXSk7XG5cbiAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IG9yaWVudDtcblxuICAgIGlmIChOdW1iZXIuaXNOYU4oeENvb3IpIHx8IE51bWJlci5pc05hTih5Q29vcikpIHJldHVybjtcbiAgICBlbHNlIHtcbiAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiKSB7XG4gICAgICAgIHBPbmUuYm9hcmQucGxhY2VTaGlwKHhDb29yLCB5Q29vciwgc2hpcCk7XG4gICAgICAgIHJlbmRlckJvYXJkKHBPbmUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcFR3by5ib2FyZC5wbGFjZVNoaXAoeENvb3IsIHlDb29yLCBzaGlwKTtcbiAgICAgICAgcmVuZGVyQm9hcmQocFR3byk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmNvbnN0IGluaXRGaW5TZXR1cCA9IChwT25lLCBwVHdvKSA9PiB7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2ZpbkJ0bmApO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgZm9ybWApO1xuICBjb25zdCBwbGF5ZXJOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItbmFtZVwiKTtcblxuICBsZXQgaXNBbGxQbGFjZWQgPSBmYWxzZTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgbGV0IHNoaXBzT2JqO1xuICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgIGxldCBpZCA9IGZvcm0uZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICBpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiXG4gICAgICA/IChzaGlwc09iaiA9IHBPbmUuYm9hcmQuZ2V0U2hpcHMoKSlcbiAgICAgIDogKHNoaXBzT2JqID0gcFR3by5ib2FyZC5nZXRTaGlwcygpKTtcblxuICAgIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhzaGlwc09iaik7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBjb25zdCBjb21wID0gc2hpcC5nZXRTaGlwKCkuY29tcDtcbiAgICAgIGlmIChjb21wLmxlbmd0aCA9PT0gMCkgcmV0dXJuIChpc0FsbFBsYWNlZCA9IGZhbHNlKTtcbiAgICAgIGVsc2UgcmV0dXJuIChpc0FsbFBsYWNlZCA9IHRydWUpO1xuICAgIH0pO1xuXG4gICAgaWYgKGlzQWxsUGxhY2VkKSB7XG4gICAgICBjb25zdCBzaGFwZUNvbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNoYXBlXCIpO1xuICAgICAgY29uc3Qgc2hpcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NoaXBzXCIpO1xuICAgICAgY29uc3QgeCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeC1jb29yXCIpO1xuICAgICAgY29uc3QgeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeS1jb29yXCIpO1xuICAgICAgY29uc3Qgb3B0ID0gc2hpcHMucXVlcnlTZWxlY3RvcihcIi5iYXR0bGVzaGlwXCIpO1xuICAgICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcbiAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwic3BhblwiKTtcblxuICAgICAgeC52YWx1ZSA9IFwiXCI7XG4gICAgICB5LnZhbHVlID0gXCJcIjtcbiAgICAgIHNoYXBlQ29udC5jbGFzc0xpc3QucmVtb3ZlKFwidmVydGljYWxcIik7XG4gICAgICBvcHQucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgICBvcHQuc2V0QXR0cmlidXRlKFwic2VsZWN0ZWRcIiwgXCJcIik7XG4gICAgICByZW5kZXJTaGFwZShwVHdvKTtcblxuICAgICAgaWYgKGlkID09PSBcInBsYXllck9uZS1mb3JtXCIpIHtcbiAgICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IFwiUGxheWVyIFR3b1wiO1xuICAgICAgICBmb3JtLnNldEF0dHJpYnV0ZShcImlkXCIsIFwicGxheWVyVHdvLWZvcm1cIik7XG4gICAgICAgIGhpZGVCb2FyZChwT25lKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIgfHwgaWQgPT09IFwicGxheWVyVHdvLWZvcm1cIikge1xuICAgICAgICBmb3JtLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZGlzcGxheTogbm9uZTtcIik7XG4gICAgICAgIG1lc3NhZ2Uuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lO1wiKTtcbiAgICAgICAgaGlkZUJvYXJkKHBUd28pO1xuICAgICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgICAgICAgcGxheWVyTmFtZS50ZXh0Q29udGVudCA9IFwiUGxheWVyIE9uZWBzIHR1cm4hXCI7XG4gICAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoXCJQbGVhc2UgcGxhY2UgYWxsIHRoZSBzaGlwcyBmaXJzdFwiKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgaGlkZUJvYXJkID0gKHBsYXllcikgPT4ge1xuICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke3BsYXllci5udW1iZXJ9LXNxdWFyZWApO1xuXG4gIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyYXk7XCIpO1xuICB9KTtcbn07XG5cbmNvbnN0IGluaXRwbGF5QnRuID0gKFBPbmUsIFBUd28pID0+IHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXlcIik7XG5cbiAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IHBsYXllciA9IHBsYXlXaW5kb3cuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcblxuICAgIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgICByZW5kZXJCb2FyZChQT25lKTtcbiAgICAgIHJlbmRlclBsYXlCZChQT25lLCBQVHdvLCBwbGF5ZXIpO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtQT25lLm51bWJlcn1gKTtcbiAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICB9IGVsc2UgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItT25lXCIpIHtcbiAgICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtQVHdvLm51bWJlcn1gKTtcbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICAgIGF1dG9BdGsoUE9uZSwgUFR3byk7XG4gICAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlbmRlckJvYXJkKFBUd28pO1xuICAgICAgICByZW5kZXJQbGF5QmQoUE9uZSwgUFR3bywgcGxheWVyKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCByZW5kZXJQbGF5QmQgPSAocE9uZSwgcFR3bywgaWQpID0+IHtcbiAgbGV0IGJvYXJkO1xuICBsZXQgbWlzc2VzO1xuICBsZXQgY3VyckJvYXJkO1xuXG4gIGlmIChpZCA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICBib2FyZCA9IHBUd28uYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgICBtaXNzZXMgPSBwVHdvLmJvYXJkLmdldE1pc3NlcygpO1xuICAgIGN1cnJCb2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNib2FyZCR7cFR3by5udW1iZXJ9YCk7XG4gIH0gZWxzZSB7XG4gICAgYm9hcmQgPSBwT25lLmJvYXJkLmdldEJvYXJkKCk7XG4gICAgbWlzc2VzID0gcE9uZS5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgICBjdXJyQm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjYm9hcmQke3BPbmUubnVtYmVyfWApO1xuICB9XG5cbiAgd2hpbGUgKGN1cnJCb2FyZC5sYXN0RWxlbWVudENoaWxkKVxuICAgIGN1cnJCb2FyZC5yZW1vdmVDaGlsZChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZCk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmQubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBib2FyZFtpXVtqXTtcblxuICAgICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXItT25lXCIpIHtcbiAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cE9uZS5udW1iZXJ9LXNxdWFyZWApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cFR3by5udW1iZXJ9LXNxdWFyZWApO1xuICAgICAgfVxuXG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGF0YS14XCIsIGAke2l9YCk7XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGF0YS15XCIsIGAke2p9YCk7XG5cbiAgICAgIGluaXRTcXJCdG4ocE9uZSwgcFR3bywgc3F1YXJlKTtcblxuICAgICAgaWYgKFxuICAgICAgICBpdGVtICE9PSBudWxsICYmXG4gICAgICAgIGl0ZW0uZ2V0U2hpcCgpLmhpdENvdW50ID4gMCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6ICNEOTE2NTY7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6ICMxNUIzOTI7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGN1cnJCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgaW5pdFNxckJ0biA9IChwT25lLCBwVHdvLCBzcXVhcmUpID0+IHtcbiAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gIGNvbnN0IHggPSBwYXJzZUludChzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS14XCIpKTtcbiAgY29uc3QgeSA9IHBhcnNlSW50KHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIikpO1xuICBjb25zdCB3aW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndpbm5lclwiKTtcbiAgY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbiAgY29uc3Qgd2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgY29uc3QgcGxheWVyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLW5hbWVcIik7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcblxuICBzcXVhcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IHNxdWFyZUlkID0gc3F1YXJlLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgIGNvbnN0IGlkID0gd2luZG93LmdldEF0dHJpYnV0ZShcImRhdGEtaWRcIik7XG4gICAgY29uc3QgbW9kZSA9IG1haW4uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG4gICAgbGV0IGJvYXJkO1xuICAgIGxldCBib2FyZExpc3Q7XG5cbiAgICBpZiAoc3F1YXJlSWQgPT09IFwiT25lLXNxdWFyZVwiKSB7XG4gICAgICBib2FyZCA9IHBPbmUuYm9hcmQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJvYXJkID0gcFR3by5ib2FyZDtcbiAgICB9XG5cbiAgICBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpO1xuXG4gICAgYm9hcmQucmVjZWl2ZUF0dGFjayh4LCB5KTtcbiAgICBpZiAoYm9hcmRMaXN0W3hdW3ldID09PSBudWxsKSB7XG4gICAgICBpZiAoc3F1YXJlSWQgPT09IFwiT25lLXNxdWFyZVwiKSB7XG4gICAgICAgIGhpZGVCb2FyZChwVHdvKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGhpZGVCb2FyZChwT25lKTtcbiAgICAgIH1cblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogI0ZDQ0QyQTtcIik7XG5cbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICAgIHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyYHMgdHVybiFcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlkID09PSBcInBsYXllci1PbmVcIlxuICAgICAgICAgID8gKHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBUd29gcyB0dXJuIVwiKVxuICAgICAgICAgIDogKHBsYXllck5hbWUudGV4dENvbnRlbnQgPSBcIlBsYXllciBPbmVgcyB0dXJuIVwiKTtcbiAgICAgIH1cblxuICAgICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc3F1YXJlSWQgPT09IFwiT25lLXNxdWFyZVwiKSB7XG4gICAgICAgIHVwZGF0ZVNoaXBsaXN0KGJvYXJkTGlzdFt4XVt5XSwgcE9uZS5udW1iZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXBkYXRlU2hpcGxpc3QoYm9hcmRMaXN0W3hdW3ldLCBwVHdvLm51bWJlcik7XG4gICAgICB9XG4gICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiAjRDkxNjU2O1wiKTtcblxuICAgICAgaWYgKGJvYXJkLmlzQWxsU3VuaygpKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6ICNEOTE2NTY7XCIpO1xuICAgICAgICBlbmRNc2cuc2hvd01vZGFsKCk7XG4gICAgICAgIGlmIChpZCA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBgQ29uZ3JhdHVsYXRpb25zIFBsYXllciBUd28hYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBgQ29uZ3JhdHVsYXRpb25zIFBsYXllciBPbmUhYDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBjb21wTW9kZSA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyKTtcbiAgaGlkZUJvYXJkKHBsYXllcik7XG59O1xuXG5jb25zdCBhdXRvQXRrID0gKHBsYXlPbmUsIHBsYXlUd28pID0+IHtcbiAgY29uc3QgYm9hcmQgPSBwbGF5T25lLmJvYXJkO1xuICBjb25zdCBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBtaXNzZXMgPSBib2FyZC5nZXRNaXNzZXMoKTtcbiAgY29uc3QgaGl0cyA9IGJvYXJkLmdldEhpdHMoKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHdpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud2lubmVyXCIpO1xuICBjb25zdCBlbmRNc2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVuZC1nYW1lXCIpO1xuICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCBjb250ID0gdHJ1ZTtcblxuICB3aGlsZSAoY29udCA9PT0gdHJ1ZSkge1xuICAgIGlmIChcbiAgICAgIG1pc3Nlcy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KSB8fFxuICAgICAgaGl0cy5maW5kKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgICB9KVxuICAgICkge1xuICAgICAgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuXG4gICAgaWYgKGJvYXJkTGlzdFt4XVt5XSA9PT0gbnVsbCkge1xuICAgICAgY29uc3QgaWQgPSBgcGxheWVyLSR7cGxheVR3by5udW1iZXJ9YDtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7cGxheU9uZS5udW1iZXJ9YCk7XG4gICAgICByZW5kZXJCb2FyZChwbGF5T25lKTtcbiAgICAgIHJlbmRlclBsYXlCZChwbGF5T25lLCBwbGF5VHdvLCBpZCk7XG4gICAgICBjb250ID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChwbGF5T25lLmJvYXJkLmlzQWxsU3VuaygpKSB7XG4gICAgICAgIGNvbnQgPSBmYWxzZTtcbiAgICAgICAgZW5kTXNnLnNob3dNb2RhbCgpO1xuICAgICAgICB3aW5uZXIudGV4dENvbnRlbnQgPSBcIkNvbXB1dGVyIHdvbiFcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVwZGF0ZVNoaXBsaXN0KHBsYXlPbmUuYm9hcmQuZ2V0Qm9hcmQoKVt4XVt5XSwgcGxheU9uZS5udW1iZXIpO1xuICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuY29uc3QgaW5pdFJhbmRCdG4gPSAocE9uZSwgcFR3bykgPT4ge1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gIGNvbnN0IHJhbmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JhbmRvbVwiKTtcblxuICByYW5kQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IGlkID0gZm9ybS5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcblxuICAgIGlmIChpZCA9PT0gXCJwbGF5ZXJPbmUtZm9ybVwiKSB7XG4gICAgICBwT25lLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgICAgIHJlbmRlckJvYXJkKHBPbmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwVHdvLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgICAgIHJlbmRlckJvYXJkKHBUd28pO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCByZW5kZXJTaGFwZSA9IChwbGF5ZXIpID0+IHtcbiAgY29uc3Qgc2hpcHNPYmogPSBwbGF5ZXIuYm9hcmQuZ2V0U2hpcHMoKTtcbiAgY29uc3Qgc2VsZWN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NoaXBzXCIpO1xuICBjb25zdCBuYW1lID0gc2VsZWN0ZWQudmFsdWU7XG4gIGNvbnN0IHNoaXAgPSBzaGlwc09ialtuYW1lXTtcbiAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuICBjb25zdCBzaGFwZUNvbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNoYXBlXCIpO1xuXG4gIHdoaWxlIChzaGFwZUNvbnQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBzaGFwZUNvbnQucmVtb3ZlQ2hpbGQoc2hhcGVDb250Lmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAxOyBpIDw9IGxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc3F1YXJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChcInNxdWFyZVwiKTtcbiAgICBzaGFwZUNvbnQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgfVxufTtcblxuY29uc3QgdXBkYXRlU2hpcGxpc3QgPSAoc2hpcCwgbnVtYmVyKSA9PiB7XG4gIGNvbnN0IG5hbWUgPSBzaGlwLmdldFNoaXAoKS5uYW1lO1xuICBjb25zdCBzaGlwc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuc2hpcGxpc3QtJHtudW1iZXJ9YCk7XG4gIGNvbnN0IHNoaXBDb250ID0gc2hpcHNMaXN0LnF1ZXJ5U2VsZWN0b3IoYC4ke25hbWV9YCk7XG4gIGNvbnN0IHNxdWFyZXMgPSBzaGlwQ29udC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNxdWFyZVwiKTtcbiAgY29uc3QgdGVtcCA9IFtdO1xuXG4gIGlmIChzaGlwLmlzU3VuaygpKSB7XG4gICAgc3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6ICNEOTE2NTY7XCIpO1xuICAgIH0pO1xuICB9XG59O1xuXG5leHBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG4gIGluaXRSYW5kQnRuLFxuICByZW5kZXJTaGFwZSxcbn07XG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7XG4gIHJlbmRlckJvYXJkLFxuICBpbml0UGxhY2VTaGlwLFxuICBpbml0RmluU2V0dXAsXG4gIGluaXRwbGF5QnRuLFxuICBjb21wTW9kZSxcbiAgaW5pdFJhbmRCdG4sXG4gIHJlbmRlclNoYXBlLFxufSBmcm9tIFwiLi9ET01cIjtcblxuY29uc3QgZ2FtZU1vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbWVfbW9kZVwiKTtcbmNvbnN0IHB2cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZwXCIpO1xuY29uc3QgcHZjQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwdmNcIik7XG5jb25zdCByZXN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZXN0YXJ0XCIpO1xuY29uc3QgZW5kTXNnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbmQtZ2FtZVwiKTtcbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcbmNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2hpcHNcIik7XG5jb25zdCBzZWxlY3RPciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjb3JpZW50YXRpb25cIik7XG5sZXQgcGxheWVyT25lID0gUGxheWVyKFwiT25lXCIpO1xubGV0IHBsYXllclR3byA9IFBsYXllcihcIlR3b1wiKTtcblxuaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5pbml0RmluU2V0dXAocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdHBsYXlCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuaW5pdFJhbmRCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xucmVuZGVyQm9hcmQocGxheWVyT25lKTtcbnJlbmRlckJvYXJkKHBsYXllclR3byk7XG5yZW5kZXJTaGFwZShwbGF5ZXJPbmUpO1xuXG5wdnBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucHZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibWFpblwiKTtcblxuICBjb21wTW9kZShwbGF5ZXJUd28pO1xuXG4gIG1haW4uY2xhc3NMaXN0LmFkZChcInB2Y1wiKTtcblxuICByZXR1cm4gZ2FtZU1vZGUuY2xvc2UoKTtcbn0pO1xuXG5yZXN0YXJ0QnRuLmZvckVhY2goKGJ1dHRvbikgPT5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gICAgY29uc3Qgd2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgICBjb25zdCB4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN4LWNvb3JcIik7XG4gICAgY29uc3QgeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjeS1jb29yXCIpO1xuICAgIGNvbnN0IG9wdCA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKFwiLmJhdHRsZXNoaXBcIik7XG4gICAgY29uc3Qgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3F1YXJlXCIpO1xuICAgIGNvbnN0IHNoYXBlQ29udCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2hhcGVcIik7XG4gICAgY29uc3QgbWVzc2FnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVzc2FnZVwiKTtcbiAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInNwYW5cIik7XG5cbiAgICBlbmRNc2cuY2xvc2UoKTtcblxuICAgIGZvcm0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwbGF5ZXJPbmUtZm9ybVwiKTtcbiAgICBmb3JtLnJlbW92ZUF0dHJpYnV0ZShcInN0eWxlXCIpO1xuICAgIG1haW4uY2xhc3NMaXN0LnJlbW92ZShcInB2Y1wiKTtcbiAgICBzaGFwZUNvbnQuY2xhc3NMaXN0LnJlbW92ZShcInZlcnRpY2FsXCIpO1xuICAgIHdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIFwicGxheWVyLVR3b1wiKTtcblxuICAgIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgICBzcXVhcmUucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG4gICAgfSk7XG5cbiAgICB4LnZhbHVlID0gXCJcIjtcbiAgICB5LnZhbHVlID0gXCJcIjtcbiAgICBvcHQucmVtb3ZlQXR0cmlidXRlKFwic2VsZWN0ZWRcIik7XG4gICAgb3B0LnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsIFwiXCIpO1xuXG4gICAgc3Bhbi50ZXh0Q29udGVudCA9IFwiUGxheWVyIE9uZVwiO1xuICAgIG1lc3NhZ2UucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIik7XG5cbiAgICByZW5kZXJTaGFwZShwbGF5ZXJPbmUpO1xuICAgIHBsYXllck9uZS5ib2FyZC5yZXNldEJvYXJkKCk7XG4gICAgcGxheWVyVHdvLmJvYXJkLnJlc2V0Qm9hcmQoKTtcblxuICAgIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gICAgcmVuZGVyQm9hcmQocGxheWVyVHdvKTtcbiAgICBnYW1lTW9kZS5zaG93TW9kYWwoKTtcbiAgfSlcbik7XG5cbnNlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgcmVuZGVyU2hhcGUocGxheWVyT25lKTtcbn0pO1xuXG5zZWxlY3RPci5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsICgpID0+IHtcbiAgY29uc3Qgc2hhcGVDb250ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zaGFwZVwiKTtcblxuICBpZiAoc2VsZWN0T3IudmFsdWUgPT09IFwidmVydGljYWxcIikge1xuICAgIHNoYXBlQ29udC5jbGFzc0xpc3QuYWRkKFwidmVydGljYWxcIik7XG4gIH0gZWxzZSB7XG4gICAgc2hhcGVDb250LmNsYXNzTGlzdC5yZW1vdmUoXCJ2ZXJ0aWNhbFwiKTtcbiAgfVxufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxvYWRcIiwgZ2FtZU1vZGUuc2hvd01vZGFsKCkpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJuIiwibmFtZSIsInNoaXBPYmoiLCJnZXRTaGlwIiwiaGl0IiwiaGl0Q291bnQiLCJsZW5ndGgiLCJzdW5rIiwiaXNTdW5rIiwicmVzZXRTaGlwIiwib3JpZW50YXRpb24iLCJjb21wIiwiaGl0Q29vciIsIkdhbWVib2FyZCIsImJvYXJkIiwibWlzc2VzIiwiaGl0cyIsImFsbFNoaXBzIiwiYmF0dGxlc2hpcCIsImNydWlzZXJfSSIsImNydWlzZXJfSUkiLCJkZXN0cm95ZXJfSSIsImRlc3Ryb3llcl9JSSIsImRlc3Ryb3llcl9JSUkiLCJzdWJtYXJpbmVfSSIsInN1Ym1hcmluZV9JSSIsInN1Ym1hcmluZV9JSUkiLCJzdWJtYXJpbmVfSVYiLCJpc0ZpdCIsImFyciIsInN0YXR1cyIsImZvckVhY2giLCJpdGVtIiwieCIsInkiLCJjcmVhdGVDb21wIiwic2hpcCIsInRlbXAiLCJhIiwiYiIsInB1c2giLCJwbGFjZVNoaXAiLCJhbGVydCIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJnZXRCb2FyZCIsImdldFNoaXBzIiwicmVjZWl2ZUF0dGFjayIsImdldE1pc3NlcyIsImdldEhpdHMiLCJpc0FsbFN1bmsiLCJzaGlwcyIsIk9iamVjdCIsInZhbHVlcyIsInBvcHVsYXRlQmQiLCJrZXlzIiwiZGlyZWN0aW9ucyIsImtleSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInoiLCJmaXQiLCJyZXNldEJvYXJkIiwiUGxheWVyIiwibnVtYmVyIiwid2luIiwiaXNDb21wIiwiZmlsbFNxciIsInBsYXllciIsInNxciIsInRhZyIsImZpbmQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJCb2FyZCIsInNoaXBzT2JqIiwieENvb3IiLCJ5Q29vciIsInJlbmRlclNoaXAiLCJwbGF5ZXJOdW0iLCJjdXJyZW50Qm9hcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibGFzdEVsZW1lbnRDaGlsZCIsInJlbW92ZUNoaWxkIiwic3F1YXJlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiaGlkZUJvYXJkIiwicXVlcnlTZWxlY3RvckFsbCIsInJlbmRlclBsYXlCZCIsInBPbmUiLCJwVHdvIiwiaWQiLCJjdXJyQm9hcmQiLCJxdWVyeVNlbGVjdG9yIiwiaW5pdFNxckJ0biIsImRpYWxvZyIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwid2lubmVyIiwiZW5kTXNnIiwid2luZG93IiwicGxheWVyTmFtZSIsIm1haW4iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic3F1YXJlSWQiLCJtb2RlIiwiYm9hcmRMaXN0IiwidGV4dENvbnRlbnQiLCJzaG93TW9kYWwiLCJ1cGRhdGVTaGlwbGlzdCIsInJlbmRlclNoYXBlIiwidmFsdWUiLCJzaGFwZUNvbnQiLCJzcXVhcmVzIiwiZ2FtZU1vZGUiLCJwdnBCdG4iLCJwdmNCdG4iLCJyZXN0YXJ0QnRuIiwic2VsZWN0T3IiLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iLCJzaGlwTmFtZSIsIm9yaWVudCIsIk51bWJlciIsImlzTmFOIiwiYnV0dG9uIiwiZm9ybSIsImlzQWxsUGxhY2VkIiwib3B0IiwibWVzc2FnZSIsInNwYW4iLCJyZW1vdmUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbml0RmluU2V0dXAiLCJQT25lIiwiUFR3byIsInBsYXlXaW5kb3ciLCJjbG9zZSIsInBsYXlPbmUiLCJwbGF5VHdvIiwiY29udCIsImF1dG9BdGsiLCJpbml0cGxheUJ0biIsImluaXRSYW5kQnRuIl0sInNvdXJjZVJvb3QiOiIifQ==