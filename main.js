(()=>{"use strict";const e=e=>{let t={};return t.length=e,t.hitCount=0,t.sunk=!1,t.orientation="horizontal",t.comp=[],t.hitCoor=[],{getShip:()=>t,hit:()=>{t.hitCount+=1,t.hitCount===t.length&&(t.sunk=!0)},isSunk:()=>!0===t.sunk}},t=()=>{let t=[],r=[],o=[],n={l_ship:e(4),m_ship_I:e(3),m_ship_II:e(3),s_ship_I:e(2),s_ship_II:e(2),s_ship_III:e(2),xs_ship_I:e(1),xs_ship_II:e(1),xs_ship_III:e(1),xs_ship_IV:e(1)};const l=e=>{let r=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(o=e[0],n=e[1],null!==t[o][n]))return r=!1;var o,n})),r},a=(e,t,r)=>{const o=r.getShip().length;let n=[],l=e,a=t;if("horizontal"===r.getShip().orientation)for(;a!==t+o;)n.push([e,a]),a+=1;else for(;l!==e+o;)n.push([l,t]),l+=1;return n},s=(e,r,o)=>{let n=[],s=!0;return r+length-1>9||e>9||e+length-1>9||r>9?console.log("error"):(n=a(e,r,o),s=l(n),!1===s?(s=!0,n=[],console.log("not empty")):(o.getShip().comp=n,o.getShip().comp.forEach((e=>{t[e[0]][e[1]]=o})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let r=0;r<10;r++)t[e][r]=null}return t},placeShip:s,getBoard:()=>t,getShips:()=>n,receiveAttack:(e,n)=>(null===t[e][n]?r.push([e,n]):(o.push([e,n]),t[e][n].hit(),t[e][n].getShip().hitCoor.push([e,n])),t),getMisses:()=>r,getHits:()=>o,isAllSunk:()=>{const e=Object.values(n);let t=!1;return e.forEach((e=>{if(!1===e.getShip().sunk)return t=!1;t=!0})),t},populateBd:()=>{const e=Object.keys(n),r=["horizontal","vertical"];return e.forEach((e=>{const t=n[e],o=t.getShip().length;let i=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),c=Math.floor(2*Math.random());t.getShip().orientation=r[c];let d=a(i,u,t),h=l(d);for(;u+o-1>9||i+o-1>9||!1===h;)i=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),c=Math.floor(2*Math.random()),t.getShip().orientation=r[c],d=a(i,u,t),h=l(d);s(i,u,t)})),t}}},r=e=>({number:e,win:!1,board:t(),isComp:!1}),o=(e,t,r,o,n)=>{const l=e.board.getMisses();null===t?l.find((e=>e[0]===o&&e[1]===n))?r.setAttribute("style","background-color: yellow;"):r.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===o&&e[1]===n))&&r.setAttribute("style","background-color: red;")},n=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((r=>{const o=t[r].getShip().comp;if(0!==o.length){const n=o[0][0],l=o[0][1];e.board.placeShip(n,l,t[r])}}))})(e);const t=e.board.getBoard(),r=e.number;let n=document.getElementById(`board${r}`);for(;n.lastElementChild;)n.removeChild(n.lastElementChild);for(let l=0;l<t.length;l++)for(let a=0;a<t.length;a++){const s=document.createElement("div");s.classList.add(`${r}-square`),s.setAttribute("data-x",`${l}`),s.setAttribute("data-y",`${a}`),o(e,t[l][a],s,l,a),n.appendChild(s)}return n},l=e=>{const t=e.board.getShips(),r=Object.keys(t),o=document.querySelector(`#player${e.number}-ships`);return r.forEach((e=>{const t=document.createElement("option");t.textContent=e,o.appendChild(t)})),o},a=e=>{document.querySelector(`#placeShipBtn-${e.number}`).addEventListener("click",(t=>{t.preventDefault();const r=parseInt(document.querySelector(`#player${e.number}-y`).value),o=parseInt(document.querySelector(`#player${e.number}-x`).value),l=document.querySelector(`#player${e.number}-ships`).value,a=document.querySelector(`#player${e.number}-orient`).value,s=e.board.getShips()[l];s.getShip().orientation=a,Number.isNaN(r)||Number.isNaN(o)||(e.board.placeShip(r,o,s),n(e))}))},s=e=>{const t=document.querySelector("main"),r=document.querySelector(`#player${e.number}-finBtn`),o=document.querySelector(`#player${e.number}-form`),n=e.board.getShips(),l=Object.values(n);let a=!1;r.addEventListener("click",(r=>{r.preventDefault();const n=t.getAttribute("class");l.forEach((e=>{const t=e.getShip().comp;return a=0!==t.length})),a?(o.setAttribute("style","display: none;"),i(e),("pvc"===n||"Two"===e.number)&&document.querySelector(".dialog").showModal()):alert("Please place all the ships first")}))},i=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},u=(e,t)=>{const r=document.querySelector("main"),o=document.querySelector(".dialog"),l=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(a=>{a.preventDefault();let s=l.getAttribute("data-id");if("player-Two"===s)return n(e),c(t),l.setAttribute("data-id",`player-${e.number}`),o.close();if("player-One"===s){const a=r.getAttribute("class");return l.setAttribute("data-id",`player-${t.number}`),console.log(a),"pvc"===a?(h(e,t),o.close()):(n(t),c(e),o.close())}}))},c=e=>{const t=e.board.getBoard(),r=e.board.getMisses(),o=document.querySelector(`#board${e.number}`);for(;o.lastElementChild;)o.removeChild(o.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const a=t[n][l],s=document.createElement("button");s.classList.add(`${e.number}-square`),s.setAttribute("data-x",`${n}`),s.setAttribute("data-y",`${l}`),d(e,s),null!==a&&a.getShip().hitCount>0&&a.getShip().hitCoor.find((e=>e[0]===n&&e[1]===l))&&(s.setAttribute("style","background-color: red;"),s.setAttribute("disabled","")),r.find((e=>e[0]===n&&e[1]===l))&&(s.setAttribute("style","background-color: green;"),s.setAttribute("disabled","")),o.appendChild(s)}},d=(e,t)=>{const r=e.board,o=r.getBoard(),n=document.querySelector(".dialog"),l=parseInt(t.getAttribute("data-x")),a=parseInt(t.getAttribute("data-y"));t.addEventListener("click",(s=>{s.preventDefault(),r.receiveAttack(l,a),null===o[l][a]?(i(e),t.setAttribute("style","background-color: red;"),n.showModal()):t.setAttribute("style","background-color: green;")}))},h=(e,t)=>{const r=e.board,o=r.getBoard(),l=r.getMisses(),a=r.getHits(),s=document.querySelector("#play-window");let i=Math.floor(10*Math.random()),u=Math.floor(10*Math.random()),d=!0;for(;!0===d;)l.find((e=>e[0]===i&&e[1]===u))||a.find((e=>e[0]===i&&e[1]===u))?(i=Math.floor(10*Math.random()),u=Math.floor(10*Math.random())):(r.receiveAttack(i,u),null===o[i][u]?(s.setAttribute("data-id",`player-${e.number}`),n(e),c(t),d=!1):(console.log("continuing"),i=Math.floor(10*Math.random()),u=Math.floor(10*Math.random())))},p=document.querySelector(".game_mode"),m=document.querySelector("#pvp"),b=document.querySelector("#pvc"),g=r("One"),y=r("Two");m.addEventListener("click",(e=>(e.preventDefault(),n(g),n(y),l(g),l(y),a(g),a(y),s(g),s(y),u(g,y),p.close()))),b.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),r=document.querySelector("#playerTwo-form");var o;return n(g),n(y),l(g),a(g),s(g),s(y),u(g,y),(o=y).board.populateBd(),n(o),i(o),r.setAttribute("style","display: none;"),t.classList.add("pvc"),p.close()})),document.addEventListener("onload",p.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPLElBR3pCekMsU0FBU2UsaUJBQWlCLFNBQVVrQyxFQUFTakIsWSIsInNvdXJjZXMiOlsid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9ET00uanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IChuKSA9PiB7XG4gIGxldCBzaGlwT2JqID0ge307XG5cbiAgc2hpcE9ialtcImxlbmd0aFwiXSA9IG47XG4gIHNoaXBPYmpbXCJoaXRDb3VudFwiXSA9IDA7XG4gIHNoaXBPYmpbXCJzdW5rXCJdID0gZmFsc2U7XG4gIHNoaXBPYmpbXCJvcmllbnRhdGlvblwiXSA9IFwiaG9yaXpvbnRhbFwiO1xuICBzaGlwT2JqW1wiY29tcFwiXSA9IFtdO1xuICBzaGlwT2JqW1wiaGl0Q29vclwiXSA9IFtdO1xuXG4gIGNvbnN0IGdldFNoaXAgPSAoKSA9PiBzaGlwT2JqO1xuXG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBzaGlwT2JqLmhpdENvdW50ICs9IDE7XG4gICAgaWYgKHNoaXBPYmouaGl0Q291bnQgPT09IHNoaXBPYmoubGVuZ3RoKSBzaGlwT2JqLnN1bmsgPSB0cnVlO1xuICB9O1xuXG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHtcbiAgICByZXR1cm4gc2hpcE9iai5zdW5rID09PSB0cnVlID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgZ2V0U2hpcCxcbiAgICBoaXQsXG4gICAgaXNTdW5rLFxuICB9O1xufTtcblxuZXhwb3J0IHsgU2hpcCB9O1xuIiwiaW1wb3J0IHsgU2hpcCB9IGZyb20gXCIuL3NoaXBcIjtcblxuY29uc3QgR2FtZWJvYXJkID0gKCkgPT4ge1xuICBsZXQgYm9hcmQgPSBbXTtcbiAgbGV0IG1pc3NlcyA9IFtdO1xuICBsZXQgaGl0cyA9IFtdO1xuXG4gIGxldCBhbGxTaGlwcyA9IHtcbiAgICBsX3NoaXA6IFNoaXAoNCksXG4gICAgbV9zaGlwX0k6IFNoaXAoMyksXG4gICAgbV9zaGlwX0lJOiBTaGlwKDMpLFxuICAgIHNfc2hpcF9JOiBTaGlwKDIpLFxuICAgIHNfc2hpcF9JSTogU2hpcCgyKSxcbiAgICBzX3NoaXBfSUlJOiBTaGlwKDIpLFxuICAgIHhzX3NoaXBfSTogU2hpcCgxKSxcbiAgICB4c19zaGlwX0lJOiBTaGlwKDEpLFxuICAgIHhzX3NoaXBfSUlJOiBTaGlwKDEpLFxuICAgIHhzX3NoaXBfSVY6IFNoaXAoMSksXG4gIH07XG5cbiAgY29uc3QgZ2V0Qm9hcmQgPSAoKSA9PiBib2FyZDtcbiAgY29uc3QgZ2V0TWlzc2VzID0gKCkgPT4gbWlzc2VzO1xuICBjb25zdCBnZXRTaGlwcyA9ICgpID0+IGFsbFNoaXBzO1xuICBjb25zdCBnZXRIaXRzID0gKCkgPT4gaGl0cztcblxuICBjb25zdCBjcmVhdGVCb2FyZCA9ICgpID0+IHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGJvYXJkW2ldID0gW107XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgYm9hcmRbaV1bal0gPSBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBpc0VtcHR5ID0gKHgsIHkpID0+IHtcbiAgICByZXR1cm4gYm9hcmRbeF1beV0gPT09IG51bGwgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgY29uc3QgaXNGaXQgPSAoYXJyKSA9PiB7XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBhcnIuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgaWYgKGl0ZW1bMF0gPiA5IHx8IGl0ZW1bMV0gPiA5IHx8ICFpc0VtcHR5KGl0ZW1bMF0sIGl0ZW1bMV0pKVxuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBzdGF0dXM7XG4gIH07XG5cbiAgY29uc3QgY3JlYXRlQ29tcCA9ICh4LCB5LCBzaGlwKSA9PiB7XG4gICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb247XG4gICAgbGV0IHRlbXAgPSBbXTtcbiAgICBsZXQgYSA9IHg7XG4gICAgbGV0IGIgPSB5O1xuXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSBcImhvcml6b250YWxcIikge1xuICAgICAgd2hpbGUgKGIgIT09IHkgKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFt4LCBiXSk7XG4gICAgICAgIGIgKz0gMTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKGEgIT09IHggKyBsZW5ndGgpIHtcbiAgICAgICAgdGVtcC5wdXNoKFthLCB5XSk7XG4gICAgICAgIGEgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGVtcDtcbiAgfTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IHN0YXR1cyA9IHRydWU7XG5cbiAgICBpZiAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCB5ID4gOSkge1xuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgc3RhdHVzID0gaXNGaXQodGVtcCk7XG4gICAgfVxuXG4gICAgaWYgKHN0YXR1cyA9PT0gZmFsc2UpIHtcbiAgICAgIHN0YXR1cyA9IHRydWU7XG4gICAgICB0ZW1wID0gW107XG4gICAgICByZXR1cm4gY29uc29sZS5sb2coXCJub3QgZW1wdHlcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNoaXAuZ2V0U2hpcCgpLmNvbXAgPSB0ZW1wO1xuXG4gICAgICBzaGlwLmdldFNoaXAoKS5jb21wLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgYm9hcmRbaXRlbVswXV1baXRlbVsxXV0gPSBzaGlwO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHBvcHVsYXRlQmQgPSAoKSA9PiB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGFsbFNoaXBzKTtcbiAgICBjb25zdCBkaXJlY3Rpb25zID0gW1wiaG9yaXpvbnRhbFwiLCBcInZlcnRpY2FsXCJdO1xuXG4gICAga2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGNvbnN0IHNoaXAgPSBhbGxTaGlwc1trZXldO1xuICAgICAgY29uc3QgbGVuZ3RoID0gc2hpcC5nZXRTaGlwKCkubGVuZ3RoO1xuXG4gICAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgbGV0IHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBkaXJlY3Rpb25zW3pdO1xuICAgICAgbGV0IHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgbGV0IGZpdCA9IGlzRml0KHRlbXApO1xuXG4gICAgICB3aGlsZSAoeSArIGxlbmd0aCAtIDEgPiA5IHx8IHggKyBsZW5ndGggLSAxID4gOSB8fCBmaXQgPT09IGZhbHNlKSB7XG4gICAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICAgIHogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgICAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IGRpcmVjdGlvbnNbel07XG4gICAgICAgIHRlbXAgPSBjcmVhdGVDb21wKHgsIHksIHNoaXApO1xuICAgICAgICBmaXQgPSBpc0ZpdCh0ZW1wKTtcbiAgICAgIH1cblxuICAgICAgcGxhY2VTaGlwKHgsIHksIHNoaXApO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoeCwgeSkgPT4ge1xuICAgIGlmIChib2FyZFt4XVt5XSA9PT0gbnVsbCkgbWlzc2VzLnB1c2goW3gsIHldKTtcbiAgICBlbHNlIHtcbiAgICAgIGhpdHMucHVzaChbeCwgeV0pO1xuICAgICAgYm9hcmRbeF1beV0uaGl0KCk7XG4gICAgICBib2FyZFt4XVt5XS5nZXRTaGlwKCkuaGl0Q29vci5wdXNoKFt4LCB5XSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuXG4gIGNvbnN0IGlzQWxsU3VuayA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoYWxsU2hpcHMpO1xuICAgIGxldCBzdGF0dXMgPSBmYWxzZTtcblxuICAgIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICAgIGlmIChzaGlwLmdldFNoaXAoKS5zdW5rID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gKHN0YXR1cyA9IGZhbHNlKTtcbiAgICAgIH0gZWxzZSBzdGF0dXMgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0YXR1cztcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGNyZWF0ZUJvYXJkLFxuICAgIHBsYWNlU2hpcCxcbiAgICBnZXRCb2FyZCxcbiAgICBnZXRTaGlwcyxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGdldE1pc3NlcyxcbiAgICBnZXRIaXRzLFxuICAgIGlzQWxsU3VuayxcbiAgICBwb3B1bGF0ZUJkLFxuICB9O1xufTtcblxuZXhwb3J0IHsgR2FtZWJvYXJkIH07XG4iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gKG51bWJlcikgPT4ge1xuICBsZXQgd2luID0gZmFsc2U7XG4gIGxldCBib2FyZCA9IEdhbWVib2FyZCgpO1xuICBsZXQgaXNDb21wID0gZmFsc2U7XG5cbiAgcmV0dXJuIHtcbiAgICBudW1iZXIsXG4gICAgd2luLFxuICAgIGJvYXJkLFxuICAgIGlzQ29tcCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFBsYXllciB9O1xuIiwiY29uc3QgZmlsbFNxciA9IChwbGF5ZXIsIHNxciwgdGFnLCB4LCB5KSA9PiB7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcblxuICBpZiAoc3FyID09PSBudWxsKSB7XG4gICAgaWYgKFxuICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pXG4gICAgKSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBibHVlO1wiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXG4gICAgc3FyLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgfSlcbiAgKSB7XG4gICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgfVxufTtcblxuY29uc3QgcmVuZGVyU2hpcCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzTGlzdCA9IE9iamVjdC5rZXlzKHNoaXBzT2JqKTtcblxuICBzaGlwc0xpc3QuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IGNvbXAgPSBzaGlwc09ialtzaGlwXS5nZXRTaGlwKCkuY29tcDtcblxuICAgIGlmIChjb21wLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29uc3QgeENvb3IgPSBjb21wWzBdWzBdO1xuICAgICAgY29uc3QgeUNvb3IgPSBjb21wWzBdWzFdO1xuICAgICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXBzT2JqW3NoaXBdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn07XG5cbmNvbnN0IHJlbmRlckJvYXJkID0gKHBsYXllcikgPT4ge1xuICBwbGF5ZXIuYm9hcmQuY3JlYXRlQm9hcmQoKTtcblxuICByZW5kZXJTaGlwKHBsYXllcik7XG5cbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgcGxheWVyTnVtID0gcGxheWVyLm51bWJlcjtcbiAgbGV0IGN1cnJlbnRCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBib2FyZCR7cGxheWVyTnVtfWApO1xuXG4gIHdoaWxlIChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyZW50Qm9hcmQucmVtb3ZlQ2hpbGQoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyTnVtfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBmaWxsU3FyKHBsYXllciwgYm9hcmRbaV1bal0sIHNxdWFyZSwgaSwgaik7XG5cbiAgICAgIGN1cnJlbnRCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjdXJyZW50Qm9hcmQ7XG59O1xuXG5jb25zdCBncmFiUGxheWVyU2hpcHMgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzID0gT2JqZWN0LmtleXMoc2hpcHNPYmopO1xuICBjb25zdCBzZWxlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS1zaGlwc2ApO1xuXG4gIHNoaXBzLmZvckVhY2goKHNoaXApID0+IHtcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xuICAgIG9wdGlvbi50ZXh0Q29udGVudCA9IHNoaXA7XG4gICAgc2VsZWN0aW9uLmFwcGVuZENoaWxkKG9wdGlvbik7XG4gIH0pO1xuXG4gIHJldHVybiBzZWxlY3Rpb247XG59O1xuXG5jb25zdCBpbml0UGxhY2VTaGlwID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxhY2VTaGlwQnRuLSR7cGxheWVyLm51bWJlcn1gKTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgeENvb3IgPSBwYXJzZUludChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXlgKS52YWx1ZVxuICAgICk7XG4gICAgY29uc3QgeUNvb3IgPSBwYXJzZUludChcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXhgKS52YWx1ZVxuICAgICk7XG4gICAgY29uc3Qgc2hpcE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LXNoaXBzYFxuICAgICkudmFsdWU7XG5cbiAgICBjb25zdCBvcmllbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LW9yaWVudGBcbiAgICApLnZhbHVlO1xuXG4gICAgY29uc3Qgc2hpcCA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpW3NoaXBOYW1lXTtcblxuICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gb3JpZW50O1xuXG4gICAgaWYgKE51bWJlci5pc05hTih4Q29vcikgfHwgTnVtYmVyLmlzTmFOKHlDb29yKSkgcmV0dXJuO1xuICAgIGVsc2Uge1xuICAgICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXApO1xuICAgICAgcmVuZGVyQm9hcmQocGxheWVyKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgaW5pdEZpblNldHVwID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LWZpbkJ0bmApO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllciR7cGxheWVyLm51bWJlcn0tZm9ybWApO1xuICBjb25zdCBzaGlwc09iaiA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpO1xuICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoc2hpcHNPYmopO1xuICBsZXQgaXNBbGxQbGFjZWQgPSBmYWxzZTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgbW9kZSA9IG1haW4uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBjb25zdCBjb21wID0gc2hpcC5nZXRTaGlwKCkuY29tcDtcbiAgICAgIGlmIChjb21wLmxlbmd0aCA9PT0gMCkgcmV0dXJuIChpc0FsbFBsYWNlZCA9IGZhbHNlKTtcbiAgICAgIGVsc2UgcmV0dXJuIChpc0FsbFBsYWNlZCA9IHRydWUpO1xuICAgIH0pO1xuXG4gICAgaWYgKGlzQWxsUGxhY2VkKSB7XG4gICAgICBmb3JtLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiZGlzcGxheTogbm9uZTtcIik7XG4gICAgICBoaWRlQm9hcmQocGxheWVyKTtcblxuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIgfHwgcGxheWVyLm51bWJlciA9PT0gXCJUd29cIikge1xuICAgICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgICAgICAgZGlhbG9nLnNob3dNb2RhbCgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydChcIlBsZWFzZSBwbGFjZSBhbGwgdGhlIHNoaXBzIGZpcnN0XCIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBoaWRlQm9hcmQgPSAocGxheWVyKSA9PiB7XG4gIGxldCBzcXVhcmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7cGxheWVyLm51bWJlcn0tc3F1YXJlYCk7XG5cbiAgc3F1YXJlcy5mb3JFYWNoKChzcXVhcmUpID0+IHtcbiAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JheTtcIik7XG4gIH0pO1xufTtcblxuY29uc3QgaW5pdHBsYXlCdG4gPSAoUE9uZSwgUFR3bykgPT4ge1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGRpYWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlhbG9nXCIpO1xuICBjb25zdCBwbGF5V2luZG93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5LXdpbmRvd1wiKTtcbiAgY29uc3QgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheVwiKTtcblxuICBwbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBsZXQgcGxheWVyID0gcGxheVdpbmRvdy5nZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIpO1xuXG4gICAgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItVHdvXCIpIHtcbiAgICAgIHJlbmRlckJvYXJkKFBPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKFBUd28pO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtQT25lLm51bWJlcn1gKTtcbiAgICAgIHJldHVybiBkaWFsb2cuY2xvc2UoKTtcbiAgICB9IGVsc2UgaWYgKHBsYXllciA9PT0gXCJwbGF5ZXItT25lXCIpIHtcbiAgICAgIGNvbnN0IG1vZGUgPSBtYWluLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xuICAgICAgcGxheVdpbmRvdy5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIGBwbGF5ZXItJHtQVHdvLm51bWJlcn1gKTtcbiAgICAgIGNvbnNvbGUubG9nKG1vZGUpO1xuICAgICAgaWYgKG1vZGUgPT09IFwicHZjXCIpIHtcbiAgICAgICAgYXV0b0F0ayhQT25lLCBQVHdvKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVuZGVyQm9hcmQoUFR3byk7XG4gICAgICAgIHJlbmRlclBsYXlCZChQT25lKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCByZW5kZXJQbGF5QmQgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgY29uc3QgY3VyckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2JvYXJkJHtwbGF5ZXIubnVtYmVyfWApO1xuXG4gIHdoaWxlIChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyQm9hcmQucmVtb3ZlQ2hpbGQoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBpdGVtID0gYm9hcmRbaV1bal07XG5cbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwbGF5ZXIubnVtYmVyfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBpbml0U3FyQnRuKHBsYXllciwgc3F1YXJlKTtcblxuICAgICAgaWYgKFxuICAgICAgICBpdGVtICE9PSBudWxsICYmXG4gICAgICAgIGl0ZW0uZ2V0U2hpcCgpLmhpdENvdW50ID4gMCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gaSAmJiBpdGVtWzFdID09PSBqO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJlZDtcIik7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBtaXNzZXMuZmluZCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHJldHVybiBpdGVtWzBdID09PSBpICYmIGl0ZW1bMV0gPT09IGo7XG4gICAgICAgIH0pXG4gICAgICApIHtcbiAgICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGN1cnJCb2FyZC5hcHBlbmRDaGlsZChzcXVhcmUpO1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgaW5pdFNxckJ0biA9IChwbGF5ZXIsIHNxdWFyZSkgPT4ge1xuICBjb25zdCBib2FyZCA9IHBsYXllci5ib2FyZDtcbiAgY29uc3QgYm9hcmRMaXN0ID0gYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgZGlhbG9nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaWFsb2dcIik7XG4gIGNvbnN0IHggPSBwYXJzZUludChzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS14XCIpKTtcbiAgY29uc3QgeSA9IHBhcnNlSW50KHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXlcIikpO1xuXG4gIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIGhpZGVCb2FyZChwbGF5ZXIpO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XCIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBjb21wTW9kZSA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyKTtcbiAgaGlkZUJvYXJkKHBsYXllcik7XG59O1xuXG5jb25zdCBhdXRvQXRrID0gKHBsYXlPbmUsIHBsYXlUd28pID0+IHtcbiAgY29uc3QgYm9hcmQgPSBwbGF5T25lLmJvYXJkO1xuICBjb25zdCBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBtaXNzZXMgPSBib2FyZC5nZXRNaXNzZXMoKTtcbiAgY29uc3QgaGl0cyA9IGJvYXJkLmdldEhpdHMoKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICBsZXQgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgbGV0IGNvbnQgPSB0cnVlO1xuXG4gIHdoaWxlIChjb250ID09PSB0cnVlKSB7XG4gICAgaWYgKFxuICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pIHx8XG4gICAgICBoaXRzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pXG4gICAgKSB7XG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG5cbiAgICBpZiAoYm9hcmRMaXN0W3hdW3ldID09PSBudWxsKSB7XG4gICAgICBwbGF5V2luZG93LnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIiwgYHBsYXllci0ke3BsYXlPbmUubnVtYmVyfWApO1xuICAgICAgcmVuZGVyQm9hcmQocGxheU9uZSk7XG4gICAgICByZW5kZXJQbGF5QmQocGxheVR3byk7XG4gICAgICBjb250ID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiY29udGludWluZ1wiKTtcbiAgICAgIHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IHtcbiAgcmVuZGVyQm9hcmQsXG4gIGdyYWJQbGF5ZXJTaGlwcyxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG59O1xuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQge1xuICByZW5kZXJCb2FyZCxcbiAgZ3JhYlBsYXllclNoaXBzLFxuICBpbml0UGxhY2VTaGlwLFxuICBpbml0RmluU2V0dXAsXG4gIGluaXRwbGF5QnRuLFxuICBjb21wTW9kZSxcbn0gZnJvbSBcIi4vRE9NXCI7XG5cbmNvbnN0IGdhbWVNb2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lX21vZGVcIik7XG5jb25zdCBwdnBCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3B2cFwiKTtcbmNvbnN0IHB2Y0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHZjXCIpO1xuY29uc3QgcGxheWVyT25lID0gUGxheWVyKFwiT25lXCIpO1xuY29uc3QgcGxheWVyVHdvID0gUGxheWVyKFwiVHdvXCIpO1xuXG5wdnBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyT25lKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyVHdvKTtcblxuICBncmFiUGxheWVyU2hpcHMocGxheWVyT25lKTtcbiAgZ3JhYlBsYXllclNoaXBzKHBsYXllclR3byk7XG5cbiAgaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUpO1xuICBpbml0UGxhY2VTaGlwKHBsYXllclR3byk7XG5cbiAgaW5pdEZpblNldHVwKHBsYXllck9uZSk7XG4gIGluaXRGaW5TZXR1cChwbGF5ZXJUd28pO1xuXG4gIGluaXRwbGF5QnRuKHBsYXllck9uZSwgcGxheWVyVHdvKTtcblxuICByZXR1cm4gZ2FtZU1vZGUuY2xvc2UoKTtcbn0pO1xuXG5wdmNCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXllclR3by1mb3JtXCIpO1xuXG4gIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gIHJlbmRlckJvYXJkKHBsYXllclR3byk7XG4gIGdyYWJQbGF5ZXJTaGlwcyhwbGF5ZXJPbmUpO1xuICBpbml0UGxhY2VTaGlwKHBsYXllck9uZSk7XG4gIGluaXRGaW5TZXR1cChwbGF5ZXJPbmUpO1xuICBpbml0RmluU2V0dXAocGxheWVyVHdvKTtcbiAgaW5pdHBsYXlCdG4ocGxheWVyT25lLCBwbGF5ZXJUd28pO1xuXG4gIGNvbXBNb2RlKHBsYXllclR3byk7XG5cbiAgZm9ybS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmU7XCIpO1xuICBtYWluLmNsYXNzTGlzdC5hZGQoXCJwdmNcIik7XG5cbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm9ubG9hZFwiLCBnYW1lTW9kZS5zaG93TW9kYWwoKSk7XG4iXSwibmFtZXMiOlsiU2hpcCIsIm4iLCJzaGlwT2JqIiwiZ2V0U2hpcCIsImhpdCIsImhpdENvdW50IiwibGVuZ3RoIiwic3VuayIsImlzU3VuayIsIkdhbWVib2FyZCIsImJvYXJkIiwibWlzc2VzIiwiaGl0cyIsImFsbFNoaXBzIiwibF9zaGlwIiwibV9zaGlwX0kiLCJtX3NoaXBfSUkiLCJzX3NoaXBfSSIsInNfc2hpcF9JSSIsInNfc2hpcF9JSUkiLCJ4c19zaGlwX0kiLCJ4c19zaGlwX0lJIiwieHNfc2hpcF9JSUkiLCJ4c19zaGlwX0lWIiwiaXNGaXQiLCJhcnIiLCJzdGF0dXMiLCJmb3JFYWNoIiwiaXRlbSIsIngiLCJ5IiwiY3JlYXRlQ29tcCIsInNoaXAiLCJ0ZW1wIiwiYSIsImIiLCJvcmllbnRhdGlvbiIsInB1c2giLCJwbGFjZVNoaXAiLCJjb25zb2xlIiwibG9nIiwiY29tcCIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJnZXRCb2FyZCIsImdldFNoaXBzIiwicmVjZWl2ZUF0dGFjayIsImhpdENvb3IiLCJnZXRNaXNzZXMiLCJnZXRIaXRzIiwiaXNBbGxTdW5rIiwic2hpcHMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJwb3B1bGF0ZUJkIiwia2V5cyIsImRpcmVjdGlvbnMiLCJrZXkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ6IiwiZml0IiwiUGxheWVyIiwibnVtYmVyIiwid2luIiwiaXNDb21wIiwiZmlsbFNxciIsInBsYXllciIsInNxciIsInRhZyIsImZpbmQiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJCb2FyZCIsInNoaXBzT2JqIiwieENvb3IiLCJ5Q29vciIsInJlbmRlclNoaXAiLCJwbGF5ZXJOdW0iLCJjdXJyZW50Qm9hcmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibGFzdEVsZW1lbnRDaGlsZCIsInJlbW92ZUNoaWxkIiwic3F1YXJlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImFwcGVuZENoaWxkIiwiZ3JhYlBsYXllclNoaXBzIiwic2VsZWN0aW9uIiwicXVlcnlTZWxlY3RvciIsIm9wdGlvbiIsInRleHRDb250ZW50IiwiaW5pdFBsYWNlU2hpcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJwYXJzZUludCIsInZhbHVlIiwic2hpcE5hbWUiLCJvcmllbnQiLCJOdW1iZXIiLCJpc05hTiIsImluaXRGaW5TZXR1cCIsIm1haW4iLCJidXR0b24iLCJmb3JtIiwiaXNBbGxQbGFjZWQiLCJtb2RlIiwiZ2V0QXR0cmlidXRlIiwiaGlkZUJvYXJkIiwic2hvd01vZGFsIiwiYWxlcnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5pdHBsYXlCdG4iLCJQT25lIiwiUFR3byIsImRpYWxvZyIsInBsYXlXaW5kb3ciLCJyZW5kZXJQbGF5QmQiLCJjbG9zZSIsImF1dG9BdGsiLCJjdXJyQm9hcmQiLCJpbml0U3FyQnRuIiwiYm9hcmRMaXN0IiwicGxheU9uZSIsInBsYXlUd28iLCJjb250IiwiZ2FtZU1vZGUiLCJwdnBCdG4iLCJwdmNCdG4iLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iXSwic291cmNlUm9vdCI6IiJ9