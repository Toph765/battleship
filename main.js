(()=>{"use strict";const e=e=>{let t={};return t.length=e,t.hitCount=0,t.sunk=!1,t.orientation="horizontal",t.comp=[],t.hitCoor=[],{getShip:()=>t,hit:()=>{t.hitCount+=1,t.hitCount===t.length&&(t.sunk=!0)},isSunk:()=>!0===t.sunk}},t=()=>{let t=[],o=[],r={l_ship:e(4),m_ship_I:e(3),m_ship_II:e(3),s_ship_I:e(2),s_ship_II:e(2),s_ship_III:e(2),xs_ship_I:e(1),xs_ship_II:e(1),xs_ship_III:e(1),xs_ship_IV:e(1)};const n=e=>{let o=!0;return e.forEach((e=>{if(e[0]>9||e[1]>9||(r=e[0],n=e[1],null!==t[r][n]))return o=!1;var r,n})),o},l=(e,t,o)=>{const r=o.getShip().length;let n=[],l=e,a=t;if("horizontal"===o.getShip().orientation)for(;a!==t+r;)n.push([e,a]),a+=1;else for(;l!==e+r;)n.push([l,t]),l+=1;return n},a=(e,o,r)=>{let a=[],s=!0;return o+length-1>9||e>9||e+length-1>9||o>9?console.log("error"):(a=l(e,o,r),s=n(a),!1===s?(s=!0,a=[],console.log("not empty")):(r.getShip().comp=a,r.getShip().comp.forEach((e=>{t[e[0]][e[1]]=r})),t))};return{createBoard:()=>{for(let e=0;e<10;e++){t[e]=[];for(let o=0;o<10;o++)t[e][o]=null}return t},placeShip:a,getBoard:()=>t,getShips:()=>r,receiveAttack:(e,r)=>(null===t[e][r]?o.push([e,r]):(t[e][r].hit(),t[e][r].getShip().hitCoor.push([e,r])),t),getMisses:()=>o,isAllSunk:()=>{const e=Object.values(r);let t=!1;return e.forEach((e=>{if(!1===e.getShip().sunk)return t=!1;t=!0})),t},populateBd:()=>{const e=Object.keys(r),o=["horizontal","vertical"];return e.forEach((e=>{const t=r[e],s=t.getShip().length;let c=Math.floor(10*Math.random()),i=Math.floor(10*Math.random()),u=Math.floor(2*Math.random());t.getShip().orientation=o[u];let d=l(c,i,t),h=n(d);for(;i+s-1>9||c+s-1>9||!1===h;)c=Math.floor(10*Math.random()),i=Math.floor(10*Math.random()),u=Math.floor(2*Math.random()),t.getShip().orientation=o[u],d=l(c,i,t),h=n(d);a(c,i,t)})),t}}},o=e=>({number:e,win:!1,board:t(),isComp:!1}),r=(e,t,o,r,n)=>{const l=e.board.getMisses();null===t?l.find((e=>e[0]===r&&e[1]===n))?o.setAttribute("style","background-color: yellow;"):o.setAttribute("style","background-color: blue;"):t.getShip().hitCoor.find((e=>e[0]===r&&e[1]===n))&&o.setAttribute("style","background-color: red;")},n=e=>{e.board.createBoard(),(e=>{e.board.getBoard();const t=e.board.getShips();Object.keys(t).forEach((o=>{const r=t[o].getShip().comp;if(0!==r.length){const n=r[0][0],l=r[0][1];e.board.placeShip(n,l,t[o])}}))})(e);const t=e.board.getBoard(),o=e.number;let n=document.getElementById(`board${o}`);for(;n.lastElementChild;)n.removeChild(n.lastElementChild);for(let e=0;e<t.length;e++)for(let l=0;l<t.length;l++){const a=document.createElement("div");a.classList.add(`${o}-square`),a.setAttribute("data-x",`${e}`),a.setAttribute("data-y",`${l}`),r(t[e][l],a),n.appendChild(a)}return n},l=e=>{const t=e.board.getShips(),o=Object.keys(t),r=document.querySelector(`#player${e.number}-ships`);return o.forEach((e=>{const t=document.createElement("option");t.textContent=e,r.appendChild(t)})),r},a=e=>{document.querySelector(`#placeShipBtn-${e.number}`).addEventListener("click",(t=>{t.preventDefault();const o=parseInt(document.querySelector(`#player${e.number}-y`).value),r=parseInt(document.querySelector(`#player${e.number}-x`).value),l=document.querySelector(`#player${e.number}-ships`).value,a=document.querySelector(`#player${e.number}-orient`).value,s=e.board.getShips()[l];s.getShip().orientation=a,console.log(a),e.board.placeShip(o,r,s),n(e)}))},s=e=>{const t=document.querySelector("main"),o=document.querySelector(`#player${e.number}-finBtn`),r=document.querySelector(`#player${e.number}-form`),n=e.board.getShips(),l=Object.values(n);let a=!1;o.addEventListener("click",(o=>{o.preventDefault();const n=t.getAttribute("class");l.forEach((e=>{const t=e.getShip().comp;return a=0!==t.length})),a?r.setAttribute("style","display: none;"):console.log("Please place all the ships first"),c(e),"pvc"===n&&document.querySelector(".dialog").showModal()}))},c=e=>{document.querySelectorAll(`.${e.number}-square`).forEach((e=>{e.setAttribute("disabled",""),e.setAttribute("style","background-color: gray;")}))},i=(e,t)=>{const o=document.querySelector("main"),r=document.querySelector(".dialog"),l=document.querySelector("#play-window");document.querySelector("#play").addEventListener("click",(a=>{a.preventDefault();let s=l.getAttribute("data-id");if("player-Two"===s)return n(e),u(t),l.setAttribute("data-id",`player-${e.number}`),r.close();if("player-One"===s){const a=o.getAttribute("class");return l.setAttribute("data-id",`player-${t.number}`),console.log(a),"pvc"===a?(console.log("werk"),n(t),u(e),h(e,t),r.close()):(n(t),u(e),r.close())}}))},u=e=>{const t=e.board.getBoard(),o=e.board.getMisses(),r=document.querySelector(`#board${e.number}`);for(;r.lastElementChild;)r.removeChild(r.lastElementChild);for(let n=0;n<t.length;n++)for(let l=0;l<t.length;l++){const a=t[n][l],s=document.createElement("button");s.classList.add(`${e.number}-square`),s.setAttribute("data-x",`${n}`),s.setAttribute("data-y",`${l}`),d(e,s),null!==a&&a.getShip().hitCount>0&&a.getShip().hitCoor.find((e=>e[0]===`${n}`&&e[1]===`${l}`))&&(s.setAttribute("style","background-color: red;"),s.setAttribute("disabled","")),o.find((e=>e[0]===`${n}`&&e[1]===`${l}`))&&(s.setAttribute("style","background-color: green;"),s.setAttribute("disabled","")),r.appendChild(s)}},d=(e,t)=>{const o=e.board,r=o.getBoard(),n=document.querySelector(".dialog"),l=t.getAttribute("data-x"),a=t.getAttribute("data-y");t.addEventListener("click",(s=>{s.preventDefault(),o.receiveAttack(l,a),null===r[l][a]?(c(e),t.setAttribute("style","background-color: red;"),n.showModal()):t.setAttribute("style","background-color: green;")}))},h=(e,t)=>{const o=e.board,r=o.getBoard(),l=document.querySelector("#play-window");let a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),c=!0;for(;!0===c;)o.receiveAttack(a,s),null===r[a][s]?(console.log(a,s),l.setAttribute("data-id",`player-${e.number}`),console.log(e.board.getMisses()),n(e),u(t),c=!1):(console.log("continuing"),a=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()))},p=document.querySelector(".game_mode"),m=document.querySelector("#pvp"),b=document.querySelector("#pvc"),g=o("One"),y=o("Two");m.addEventListener("click",(e=>(e.preventDefault(),n(g),n(y),l(g),l(y),a(g),a(y),s(g),s(y),i(g,y),p.close()))),b.addEventListener("click",(e=>{e.preventDefault();const t=document.querySelector("main"),o=document.querySelector("#playerTwo-form");var r;return n(g),n(y),l(g),a(g),s(g),s(y),i(g,y),(r=y).board.populateBd(),n(r),o.setAttribute("style","display: none;"),t.classList.add("pvc"),p.close()})),document.addEventListener("onload",p.showModal())})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0UsVUFFeEIsRUNoUklrRSxFQUFXOUMsU0FBU1csY0FBYyxjQUNsQ29DLEVBQVMvQyxTQUFTVyxjQUFjLFFBQ2hDcUMsRUFBU2hELFNBQVNXLGNBQWMsUUFDaENzQyxFQUFZbEUsRUFBTyxPQUNuQm1FLEVBQVluRSxFQUFPLE9BRXpCZ0UsRUFBT2hDLGlCQUFpQixTQUFVQyxJQUNoQ0EsRUFBRUMsaUJBQ0Z4QixFQUFZd0QsR0FDWnhELEVBQVl5RCxHQUVaekMsRUFBZ0J3QyxHQUNoQnhDLEVBQWdCeUMsR0FFaEJwQyxFQUFjbUMsR0FDZG5DLEVBQWNvQyxHQUVkNUIsRUFBYTJCLEdBQ2IzQixFQUFhNEIsR0FFYmxCLEVBQVlpQixFQUFXQyxHQUVoQkosRUFBU1IsV0FHbEJVLEVBQU9qQyxpQkFBaUIsU0FBVUMsSUFDaENBLEVBQUVDLGlCQUVGLE1BQU1NLEVBQU92QixTQUFTVyxjQUFjLFFBQzlCYyxFQUFPekIsU0FBU1csY0FBYyxtQkR1TnJCLElBQUN2QixFQ3hNaEIsT0FiQUssRUFBWXdELEdBQ1p4RCxFQUFZeUQsR0FDWnpDLEVBQWdCd0MsR0FDaEJuQyxFQUFjbUMsR0FDZDNCLEVBQWEyQixHQUNiM0IsRUFBYTRCLEdBQ2JsQixFQUFZaUIsRUFBV0MsSUQrTVA5RCxFQzdNUDhELEdEOE1GdkgsTUFBTTJDLGFBQ2JtQixFQUFZTCxHQzdNWnFDLEVBQUtqQyxhQUFhLFFBQVMsa0JBQzNCK0IsRUFBS2pCLFVBQVVDLElBQUksT0FFWnVDLEVBQVNSLE9BQU8sSUFHekJ0QyxTQUFTZSxpQkFBaUIsU0FBVStCLEVBQVNoQixZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdGVtcGxhdGUvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL3RlbXBsYXRlLy4vc3JjL0RPTS5qcyIsIndlYnBhY2s6Ly90ZW1wbGF0ZS8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaGlwID0gKG4pID0+IHtcbiAgbGV0IHNoaXBPYmogPSB7fTtcblxuICBzaGlwT2JqW1wibGVuZ3RoXCJdID0gbjtcbiAgc2hpcE9ialtcImhpdENvdW50XCJdID0gMDtcbiAgc2hpcE9ialtcInN1bmtcIl0gPSBmYWxzZTtcbiAgc2hpcE9ialtcIm9yaWVudGF0aW9uXCJdID0gXCJob3Jpem9udGFsXCI7XG4gIHNoaXBPYmpbXCJjb21wXCJdID0gW107XG4gIHNoaXBPYmpbXCJoaXRDb29yXCJdID0gW107XG5cbiAgY29uc3QgZ2V0U2hpcCA9ICgpID0+IHNoaXBPYmo7XG5cbiAgY29uc3QgaGl0ID0gKCkgPT4ge1xuICAgIHNoaXBPYmouaGl0Q291bnQgKz0gMTtcbiAgICBpZiAoc2hpcE9iai5oaXRDb3VudCA9PT0gc2hpcE9iai5sZW5ndGgpIHNoaXBPYmouc3VuayA9IHRydWU7XG4gIH07XG5cbiAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgIHJldHVybiBzaGlwT2JqLnN1bmsgPT09IHRydWUgPyB0cnVlIDogZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRTaGlwLFxuICAgIGhpdCxcbiAgICBpc1N1bmssXG4gIH07XG59O1xuXG5leHBvcnQgeyBTaGlwIH07XG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuXG5jb25zdCBHYW1lYm9hcmQgPSAoKSA9PiB7XG4gIGxldCBib2FyZCA9IFtdO1xuICBsZXQgbWlzc2VzID0gW107XG5cbiAgbGV0IGFsbFNoaXBzID0ge1xuICAgIGxfc2hpcDogU2hpcCg0KSxcbiAgICBtX3NoaXBfSTogU2hpcCgzKSxcbiAgICBtX3NoaXBfSUk6IFNoaXAoMyksXG4gICAgc19zaGlwX0k6IFNoaXAoMiksXG4gICAgc19zaGlwX0lJOiBTaGlwKDIpLFxuICAgIHNfc2hpcF9JSUk6IFNoaXAoMiksXG4gICAgeHNfc2hpcF9JOiBTaGlwKDEpLFxuICAgIHhzX3NoaXBfSUk6IFNoaXAoMSksXG4gICAgeHNfc2hpcF9JSUk6IFNoaXAoMSksXG4gICAgeHNfc2hpcF9JVjogU2hpcCgxKSxcbiAgfTtcblxuICBjb25zdCBnZXRCb2FyZCA9ICgpID0+IGJvYXJkO1xuICBjb25zdCBnZXRNaXNzZXMgPSAoKSA9PiBtaXNzZXM7XG4gIGNvbnN0IGdldFNoaXBzID0gKCkgPT4gYWxsU2hpcHM7XG5cbiAgY29uc3QgY3JlYXRlQm9hcmQgPSAoKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBib2FyZFtpXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGJvYXJkW2ldW2pdID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgaXNFbXB0eSA9ICh4LCB5KSA9PiB7XG4gICAgcmV0dXJuIGJvYXJkW3hdW3ldID09PSBudWxsID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGlzRml0ID0gKGFycikgPT4ge1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgYXJyLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIGlmIChpdGVtWzBdID4gOSB8fCBpdGVtWzFdID4gOSB8fCAhaXNFbXB0eShpdGVtWzBdLCBpdGVtWzFdKSlcbiAgICAgICAgcmV0dXJuIChzdGF0dXMgPSBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhdHVzO1xuICB9O1xuXG4gIGNvbnN0IGNyZWF0ZUNvbXAgPSAoeCwgeSwgc2hpcCkgPT4ge1xuICAgIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcbiAgICBjb25zdCBvcmllbnRhdGlvbiA9IHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uO1xuICAgIGxldCB0ZW1wID0gW107XG4gICAgbGV0IGEgPSB4O1xuICAgIGxldCBiID0geTtcblxuICAgIGlmIChvcmllbnRhdGlvbiA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgIHdoaWxlIChiICE9PSB5ICsgbGVuZ3RoKSB7XG4gICAgICAgIHRlbXAucHVzaChbeCwgYl0pO1xuICAgICAgICBiICs9IDE7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChhICE9PSB4ICsgbGVuZ3RoKSB7XG4gICAgICAgIHRlbXAucHVzaChbYSwgeV0pO1xuICAgICAgICBhICs9IDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRlbXA7XG4gIH07XG5cbiAgY29uc3QgcGxhY2VTaGlwID0gKHgsIHksIHNoaXApID0+IHtcbiAgICBsZXQgdGVtcCA9IFtdO1xuICAgIGxldCBzdGF0dXMgPSB0cnVlO1xuXG4gICAgaWYgKHkgKyBsZW5ndGggLSAxID4gOSB8fCB4ID4gOSB8fCB4ICsgbGVuZ3RoIC0gMSA+IDkgfHwgeSA+IDkpIHtcbiAgICAgIHJldHVybiBjb25zb2xlLmxvZyhcImVycm9yXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgIHN0YXR1cyA9IGlzRml0KHRlbXApO1xuICAgIH1cblxuICAgIGlmIChzdGF0dXMgPT09IGZhbHNlKSB7XG4gICAgICBzdGF0dXMgPSB0cnVlO1xuICAgICAgdGVtcCA9IFtdO1xuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKFwibm90IGVtcHR5XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaGlwLmdldFNoaXAoKS5jb21wID0gdGVtcDtcblxuICAgICAgc2hpcC5nZXRTaGlwKCkuY29tcC5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIGJvYXJkW2l0ZW1bMF1dW2l0ZW1bMV1dID0gc2hpcDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCBwb3B1bGF0ZUJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhhbGxTaGlwcyk7XG4gICAgY29uc3QgZGlyZWN0aW9ucyA9IFtcImhvcml6b250YWxcIiwgXCJ2ZXJ0aWNhbFwiXTtcblxuICAgIGtleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBjb25zdCBzaGlwID0gYWxsU2hpcHNba2V5XTtcbiAgICAgIGNvbnN0IGxlbmd0aCA9IHNoaXAuZ2V0U2hpcCgpLmxlbmd0aDtcblxuICAgICAgbGV0IHggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgICBsZXQgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICAgIGxldCB6ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XG5cbiAgICAgIHNoaXAuZ2V0U2hpcCgpLm9yaWVudGF0aW9uID0gZGlyZWN0aW9uc1t6XTtcbiAgICAgIGxldCB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgIGxldCBmaXQgPSBpc0ZpdCh0ZW1wKTtcblxuICAgICAgd2hpbGUgKHkgKyBsZW5ndGggLSAxID4gOSB8fCB4ICsgbGVuZ3RoIC0gMSA+IDkgfHwgZml0ID09PSBmYWxzZSkge1xuICAgICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgICB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgICB6ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMik7XG5cbiAgICAgICAgc2hpcC5nZXRTaGlwKCkub3JpZW50YXRpb24gPSBkaXJlY3Rpb25zW3pdO1xuICAgICAgICB0ZW1wID0gY3JlYXRlQ29tcCh4LCB5LCBzaGlwKTtcbiAgICAgICAgZml0ID0gaXNGaXQodGVtcCk7XG4gICAgICB9XG5cbiAgICAgIHBsYWNlU2hpcCh4LCB5LCBzaGlwKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHgsIHkpID0+IHtcbiAgICBpZiAoYm9hcmRbeF1beV0gPT09IG51bGwpIG1pc3Nlcy5wdXNoKFt4LCB5XSk7XG4gICAgZWxzZSB7XG4gICAgICBib2FyZFt4XVt5XS5oaXQoKTtcbiAgICAgIGJvYXJkW3hdW3ldLmdldFNoaXAoKS5oaXRDb29yLnB1c2goW3gsIHldKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYm9hcmQ7XG4gIH07XG5cbiAgY29uc3QgaXNBbGxTdW5rID0gKCkgPT4ge1xuICAgIGNvbnN0IHNoaXBzID0gT2JqZWN0LnZhbHVlcyhhbGxTaGlwcyk7XG4gICAgbGV0IHN0YXR1cyA9IGZhbHNlO1xuXG4gICAgc2hpcHMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgaWYgKHNoaXAuZ2V0U2hpcCgpLnN1bmsgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybiAoc3RhdHVzID0gZmFsc2UpO1xuICAgICAgfSBlbHNlIHN0YXR1cyA9IHRydWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3RhdHVzO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgY3JlYXRlQm9hcmQsXG4gICAgcGxhY2VTaGlwLFxuICAgIGdldEJvYXJkLFxuICAgIGdldFNoaXBzLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgZ2V0TWlzc2VzLFxuICAgIGlzQWxsU3VuayxcbiAgICBwb3B1bGF0ZUJkLFxuICB9O1xufTtcblxuZXhwb3J0IHsgR2FtZWJvYXJkIH07XG4iLCJpbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgUGxheWVyID0gKG51bWJlcikgPT4ge1xuICBsZXQgd2luID0gZmFsc2U7XG4gIGxldCBib2FyZCA9IEdhbWVib2FyZCgpO1xuICBsZXQgaXNDb21wID0gZmFsc2U7XG5cbiAgcmV0dXJuIHtcbiAgICBudW1iZXIsXG4gICAgd2luLFxuICAgIGJvYXJkLFxuICAgIGlzQ29tcCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFBsYXllciB9O1xuIiwiY29uc3QgZmlsbFNxciA9IChwbGF5ZXIsIHNxciwgdGFnLCB4LCB5KSA9PiB7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcblxuICBpZiAoc3FyID09PSBudWxsKSB7XG4gICAgaWYgKFxuICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW1bMF0gPT09IHggJiYgaXRlbVsxXSA9PT0geTtcbiAgICAgIH0pXG4gICAgKSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiB5ZWxsb3c7XCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0YWcuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBibHVlO1wiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXG4gICAgc3FyLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgIHJldHVybiBpdGVtWzBdID09PSB4ICYmIGl0ZW1bMV0gPT09IHk7XG4gICAgfSlcbiAgKSB7XG4gICAgdGFnLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgfVxufTtcblxuY29uc3QgcmVuZGVyU2hpcCA9IChwbGF5ZXIpID0+IHtcbiAgbGV0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHNoaXBzT2JqID0gcGxheWVyLmJvYXJkLmdldFNoaXBzKCk7XG4gIGNvbnN0IHNoaXBzTGlzdCA9IE9iamVjdC5rZXlzKHNoaXBzT2JqKTtcblxuICBzaGlwc0xpc3QuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgIGNvbnN0IGNvbXAgPSBzaGlwc09ialtzaGlwXS5nZXRTaGlwKCkuY29tcDtcblxuICAgIGlmIChjb21wLmxlbmd0aCAhPT0gMCkge1xuICAgICAgY29uc3QgeENvb3IgPSBjb21wWzBdWzBdO1xuICAgICAgY29uc3QgeUNvb3IgPSBjb21wWzBdWzFdO1xuICAgICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXBzT2JqW3NoaXBdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn07XG5cbmNvbnN0IHJlbmRlckJvYXJkID0gKHBsYXllcikgPT4ge1xuICBwbGF5ZXIuYm9hcmQuY3JlYXRlQm9hcmQoKTtcblxuICByZW5kZXJTaGlwKHBsYXllcik7XG5cbiAgY29uc3QgYm9hcmQgPSBwbGF5ZXIuYm9hcmQuZ2V0Qm9hcmQoKTtcbiAgY29uc3QgcGxheWVyTnVtID0gcGxheWVyLm51bWJlcjtcbiAgbGV0IGN1cnJlbnRCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBib2FyZCR7cGxheWVyTnVtfWApO1xuXG4gIHdoaWxlIChjdXJyZW50Qm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyZW50Qm9hcmQucmVtb3ZlQ2hpbGQoY3VycmVudEJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBzcXVhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgc3F1YXJlLmNsYXNzTGlzdC5hZGQoYCR7cGxheWVyTnVtfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBmaWxsU3FyKGJvYXJkW2ldW2pdLCBzcXVhcmUpO1xuXG4gICAgICBjdXJyZW50Qm9hcmQuYXBwZW5kQ2hpbGQoc3F1YXJlKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gY3VycmVudEJvYXJkO1xufTtcblxuY29uc3QgZ3JhYlBsYXllclNoaXBzID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBzaGlwc09iaiA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpO1xuICBjb25zdCBzaGlwcyA9IE9iamVjdC5rZXlzKHNoaXBzT2JqKTtcbiAgY29uc3Qgc2VsZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllciR7cGxheWVyLm51bWJlcn0tc2hpcHNgKTtcblxuICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb24udGV4dENvbnRlbnQgPSBzaGlwO1xuICAgIHNlbGVjdGlvbi5hcHBlbmRDaGlsZChvcHRpb24pO1xuICB9KTtcblxuICByZXR1cm4gc2VsZWN0aW9uO1xufTtcblxuY29uc3QgaW5pdFBsYWNlU2hpcCA9IChwbGF5ZXIpID0+IHtcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYWNlU2hpcEJ0bi0ke3BsYXllci5udW1iZXJ9YCk7XG5cbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IHhDb29yID0gcGFyc2VJbnQoXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS15YCkudmFsdWVcbiAgICApO1xuICAgIGNvbnN0IHlDb29yID0gcGFyc2VJbnQoXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS14YCkudmFsdWVcbiAgICApO1xuICAgIGNvbnN0IHNoaXBOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS1zaGlwc2BcbiAgICApLnZhbHVlO1xuXG4gICAgY29uc3Qgb3JpZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjcGxheWVyJHtwbGF5ZXIubnVtYmVyfS1vcmllbnRgXG4gICAgKS52YWx1ZTtcblxuICAgIGNvbnN0IHNoaXAgPSBwbGF5ZXIuYm9hcmQuZ2V0U2hpcHMoKVtzaGlwTmFtZV07XG5cbiAgICBzaGlwLmdldFNoaXAoKS5vcmllbnRhdGlvbiA9IG9yaWVudDtcbiAgICBjb25zb2xlLmxvZyhvcmllbnQpO1xuXG4gICAgcGxheWVyLmJvYXJkLnBsYWNlU2hpcCh4Q29vciwgeUNvb3IsIHNoaXApO1xuICAgIHJlbmRlckJvYXJkKHBsYXllcik7XG4gIH0pO1xufTtcblxuY29uc3QgaW5pdEZpblNldHVwID0gKHBsYXllcikgPT4ge1xuICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIm1haW5cIik7XG4gIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNwbGF5ZXIke3BsYXllci5udW1iZXJ9LWZpbkJ0bmApO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllciR7cGxheWVyLm51bWJlcn0tZm9ybWApO1xuICBjb25zdCBzaGlwc09iaiA9IHBsYXllci5ib2FyZC5nZXRTaGlwcygpO1xuICBjb25zdCBzaGlwcyA9IE9iamVjdC52YWx1ZXMoc2hpcHNPYmopO1xuICBsZXQgaXNBbGxQbGFjZWQgPSBmYWxzZTtcblxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgbW9kZSA9IG1haW4uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIik7XG5cbiAgICBzaGlwcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBjb25zdCBjb21wID0gc2hpcC5nZXRTaGlwKCkuY29tcDtcbiAgICAgIGlmIChjb21wLmxlbmd0aCA9PT0gMCkgcmV0dXJuIChpc0FsbFBsYWNlZCA9IGZhbHNlKTtcbiAgICAgIGVsc2UgcmV0dXJuIChpc0FsbFBsYWNlZCA9IHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXNBbGxQbGFjZWRcbiAgICAgID8gZm9ybS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImRpc3BsYXk6IG5vbmU7XCIpXG4gICAgICA6IGNvbnNvbGUubG9nKFwiUGxlYXNlIHBsYWNlIGFsbCB0aGUgc2hpcHMgZmlyc3RcIik7XG5cbiAgICBoaWRlQm9hcmQocGxheWVyKTtcblxuICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgaGlkZUJvYXJkID0gKHBsYXllcikgPT4ge1xuICBsZXQgc3F1YXJlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYC4ke3BsYXllci5udW1iZXJ9LXNxdWFyZWApO1xuXG4gIHNxdWFyZXMuZm9yRWFjaCgoc3F1YXJlKSA9PiB7XG4gICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IGdyYXk7XCIpO1xuICB9KTtcbn07XG5cbmNvbnN0IGluaXRwbGF5QnRuID0gKFBPbmUsIFBUd28pID0+IHtcbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgcGxheVdpbmRvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcGxheS13aW5kb3dcIik7XG4gIGNvbnN0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXlcIik7XG5cbiAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgbGV0IHBsYXllciA9IHBsYXlXaW5kb3cuZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcblxuICAgIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLVR3b1wiKSB7XG4gICAgICByZW5kZXJCb2FyZChQT25lKTtcbiAgICAgIHJlbmRlclBsYXlCZChQVHdvKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UE9uZS5udW1iZXJ9YCk7XG4gICAgICByZXR1cm4gZGlhbG9nLmNsb3NlKCk7XG4gICAgfSBlbHNlIGlmIChwbGF5ZXIgPT09IFwicGxheWVyLU9uZVwiKSB7XG4gICAgICBjb25zdCBtb2RlID0gbWFpbi5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7UFR3by5udW1iZXJ9YCk7XG4gICAgICBjb25zb2xlLmxvZyhtb2RlKTtcbiAgICAgIGlmIChtb2RlID09PSBcInB2Y1wiKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwid2Vya1wiKTtcbiAgICAgICAgcmVuZGVyQm9hcmQoUFR3byk7XG4gICAgICAgIHJlbmRlclBsYXlCZChQT25lKTtcbiAgICAgICAgYXV0b0F0ayhQT25lLCBQVHdvKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVuZGVyQm9hcmQoUFR3byk7XG4gICAgICAgIHJlbmRlclBsYXlCZChQT25lKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCByZW5kZXJQbGF5QmQgPSAocGxheWVyKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IG1pc3NlcyA9IHBsYXllci5ib2FyZC5nZXRNaXNzZXMoKTtcbiAgY29uc3QgY3VyckJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2JvYXJkJHtwbGF5ZXIubnVtYmVyfWApO1xuXG4gIHdoaWxlIChjdXJyQm9hcmQubGFzdEVsZW1lbnRDaGlsZClcbiAgICBjdXJyQm9hcmQucmVtb3ZlQ2hpbGQoY3VyckJvYXJkLmxhc3RFbGVtZW50Q2hpbGQpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGJvYXJkLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBpdGVtID0gYm9hcmRbaV1bal07XG5cbiAgICAgIGNvbnN0IHNxdWFyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICBzcXVhcmUuY2xhc3NMaXN0LmFkZChgJHtwbGF5ZXIubnVtYmVyfS1zcXVhcmVgKTtcblxuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteFwiLCBgJHtpfWApO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcImRhdGEteVwiLCBgJHtqfWApO1xuXG4gICAgICBpbml0U3FyQnRuKHBsYXllciwgc3F1YXJlKTtcblxuICAgICAgaWYgKFxuICAgICAgICBpdGVtICE9PSBudWxsICYmXG4gICAgICAgIGl0ZW0uZ2V0U2hpcCgpLmhpdENvdW50ID4gMCAmJlxuICAgICAgICBpdGVtLmdldFNoaXAoKS5oaXRDb29yLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gYCR7aX1gICYmIGl0ZW1bMV0gPT09IGAke2p9YDtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XCIpO1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgbWlzc2VzLmZpbmQoKGl0ZW0pID0+IHtcbiAgICAgICAgICByZXR1cm4gaXRlbVswXSA9PT0gYCR7aX1gICYmIGl0ZW1bMV0gPT09IGAke2p9YDtcbiAgICAgICAgfSlcbiAgICAgICkge1xuICAgICAgICBzcXVhcmUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiBncmVlbjtcIik7XG4gICAgICAgIHNxdWFyZS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcIlwiKTtcbiAgICAgIH1cblxuICAgICAgY3VyckJvYXJkLmFwcGVuZENoaWxkKHNxdWFyZSk7XG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBpbml0U3FyQnRuID0gKHBsYXllciwgc3F1YXJlKSA9PiB7XG4gIGNvbnN0IGJvYXJkID0gcGxheWVyLmJvYXJkO1xuICBjb25zdCBib2FyZExpc3QgPSBib2FyZC5nZXRCb2FyZCgpO1xuICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpYWxvZ1wiKTtcbiAgY29uc3QgeCA9IHNxdWFyZS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXhcIik7XG4gIGNvbnN0IHkgPSBzcXVhcmUuZ2V0QXR0cmlidXRlKFwiZGF0YS15XCIpO1xuXG4gIHNxdWFyZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBib2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgIGlmIChib2FyZExpc3RbeF1beV0gPT09IG51bGwpIHtcbiAgICAgIGhpZGVCb2FyZChwbGF5ZXIpO1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmVkO1wiKTtcbiAgICAgIGRpYWxvZy5zaG93TW9kYWwoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3F1YXJlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XCIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5jb25zdCBjb21wTW9kZSA9IChwbGF5ZXIpID0+IHtcbiAgcGxheWVyLmJvYXJkLnBvcHVsYXRlQmQoKTtcbiAgcmVuZGVyQm9hcmQocGxheWVyKTtcbn07XG5cbmNvbnN0IGF1dG9BdGsgPSAocGxheU9uZSwgcGxheVR3bykgPT4ge1xuICBjb25zdCBib2FyZCA9IHBsYXlPbmUuYm9hcmQ7XG4gIGNvbnN0IGJvYXJkTGlzdCA9IGJvYXJkLmdldEJvYXJkKCk7XG4gIGNvbnN0IHBsYXlXaW5kb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYXktd2luZG93XCIpO1xuICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgbGV0IHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIGxldCBjb250ID0gdHJ1ZTtcblxuICB3aGlsZSAoY29udCA9PT0gdHJ1ZSkge1xuICAgIGJvYXJkLnJlY2VpdmVBdHRhY2soeCwgeSk7XG5cbiAgICBpZiAoYm9hcmRMaXN0W3hdW3ldID09PSBudWxsKSB7XG4gICAgICBjb25zb2xlLmxvZyh4LCB5KTtcbiAgICAgIHBsYXlXaW5kb3cuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCBgcGxheWVyLSR7cGxheU9uZS5udW1iZXJ9YCk7XG4gICAgICBjb25zb2xlLmxvZyhwbGF5T25lLmJvYXJkLmdldE1pc3NlcygpKTtcbiAgICAgIHJlbmRlckJvYXJkKHBsYXlPbmUpO1xuICAgICAgcmVuZGVyUGxheUJkKHBsYXlUd28pO1xuICAgICAgY29udCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcImNvbnRpbnVpbmdcIik7XG4gICAgICB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgICAgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCB7XG4gIHJlbmRlckJvYXJkLFxuICBncmFiUGxheWVyU2hpcHMsXG4gIGluaXRQbGFjZVNoaXAsXG4gIGluaXRGaW5TZXR1cCxcbiAgaW5pdHBsYXlCdG4sXG4gIGNvbXBNb2RlLFxufTtcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IHtcbiAgcmVuZGVyQm9hcmQsXG4gIGdyYWJQbGF5ZXJTaGlwcyxcbiAgaW5pdFBsYWNlU2hpcCxcbiAgaW5pdEZpblNldHVwLFxuICBpbml0cGxheUJ0bixcbiAgY29tcE1vZGUsXG59IGZyb20gXCIuL0RPTVwiO1xuXG5jb25zdCBnYW1lTW9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FtZV9tb2RlXCIpO1xuY29uc3QgcHZwQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwdnBcIik7XG5jb25zdCBwdmNCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3B2Y1wiKTtcbmNvbnN0IHBsYXllck9uZSA9IFBsYXllcihcIk9uZVwiKTtcbmNvbnN0IHBsYXllclR3byA9IFBsYXllcihcIlR3b1wiKTtcblxucHZwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHJlbmRlckJvYXJkKHBsYXllck9uZSk7XG4gIHJlbmRlckJvYXJkKHBsYXllclR3byk7XG5cbiAgZ3JhYlBsYXllclNoaXBzKHBsYXllck9uZSk7XG4gIGdyYWJQbGF5ZXJTaGlwcyhwbGF5ZXJUd28pO1xuXG4gIGluaXRQbGFjZVNoaXAocGxheWVyT25lKTtcbiAgaW5pdFBsYWNlU2hpcChwbGF5ZXJUd28pO1xuXG4gIGluaXRGaW5TZXR1cChwbGF5ZXJPbmUpO1xuICBpbml0RmluU2V0dXAocGxheWVyVHdvKTtcblxuICBpbml0cGxheUJ0bihwbGF5ZXJPbmUsIHBsYXllclR3byk7XG5cbiAgcmV0dXJuIGdhbWVNb2RlLmNsb3NlKCk7XG59KTtcblxucHZjQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpO1xuICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGF5ZXJUd28tZm9ybVwiKTtcblxuICByZW5kZXJCb2FyZChwbGF5ZXJPbmUpO1xuICByZW5kZXJCb2FyZChwbGF5ZXJUd28pO1xuICBncmFiUGxheWVyU2hpcHMocGxheWVyT25lKTtcbiAgaW5pdFBsYWNlU2hpcChwbGF5ZXJPbmUpO1xuICBpbml0RmluU2V0dXAocGxheWVyT25lKTtcbiAgaW5pdEZpblNldHVwKHBsYXllclR3byk7XG4gIGluaXRwbGF5QnRuKHBsYXllck9uZSwgcGxheWVyVHdvKTtcblxuICBjb21wTW9kZShwbGF5ZXJUd28pO1xuXG4gIGZvcm0uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lO1wiKTtcbiAgbWFpbi5jbGFzc0xpc3QuYWRkKFwicHZjXCIpO1xuXG4gIHJldHVybiBnYW1lTW9kZS5jbG9zZSgpO1xufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJvbmxvYWRcIiwgZ2FtZU1vZGUuc2hvd01vZGFsKCkpO1xuIl0sIm5hbWVzIjpbIlNoaXAiLCJuIiwic2hpcE9iaiIsImdldFNoaXAiLCJoaXQiLCJoaXRDb3VudCIsImxlbmd0aCIsInN1bmsiLCJpc1N1bmsiLCJHYW1lYm9hcmQiLCJib2FyZCIsIm1pc3NlcyIsImFsbFNoaXBzIiwibF9zaGlwIiwibV9zaGlwX0kiLCJtX3NoaXBfSUkiLCJzX3NoaXBfSSIsInNfc2hpcF9JSSIsInNfc2hpcF9JSUkiLCJ4c19zaGlwX0kiLCJ4c19zaGlwX0lJIiwieHNfc2hpcF9JSUkiLCJ4c19zaGlwX0lWIiwiaXNGaXQiLCJhcnIiLCJzdGF0dXMiLCJmb3JFYWNoIiwiaXRlbSIsIngiLCJ5IiwiY3JlYXRlQ29tcCIsInNoaXAiLCJ0ZW1wIiwiYSIsImIiLCJvcmllbnRhdGlvbiIsInB1c2giLCJwbGFjZVNoaXAiLCJjb25zb2xlIiwibG9nIiwiY29tcCIsImNyZWF0ZUJvYXJkIiwiaSIsImoiLCJnZXRCb2FyZCIsImdldFNoaXBzIiwicmVjZWl2ZUF0dGFjayIsImhpdENvb3IiLCJnZXRNaXNzZXMiLCJpc0FsbFN1bmsiLCJzaGlwcyIsIk9iamVjdCIsInZhbHVlcyIsInBvcHVsYXRlQmQiLCJrZXlzIiwiZGlyZWN0aW9ucyIsImtleSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInoiLCJmaXQiLCJQbGF5ZXIiLCJudW1iZXIiLCJ3aW4iLCJpc0NvbXAiLCJmaWxsU3FyIiwicGxheWVyIiwic3FyIiwidGFnIiwiZmluZCIsInNldEF0dHJpYnV0ZSIsInJlbmRlckJvYXJkIiwic2hpcHNPYmoiLCJ4Q29vciIsInlDb29yIiwicmVuZGVyU2hpcCIsInBsYXllck51bSIsImN1cnJlbnRCb2FyZCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJsYXN0RWxlbWVudENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJzcXVhcmUiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwiYXBwZW5kQ2hpbGQiLCJncmFiUGxheWVyU2hpcHMiLCJzZWxlY3Rpb24iLCJxdWVyeVNlbGVjdG9yIiwib3B0aW9uIiwidGV4dENvbnRlbnQiLCJpbml0UGxhY2VTaGlwIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInBhcnNlSW50IiwidmFsdWUiLCJzaGlwTmFtZSIsIm9yaWVudCIsImluaXRGaW5TZXR1cCIsIm1haW4iLCJidXR0b24iLCJmb3JtIiwiaXNBbGxQbGFjZWQiLCJtb2RlIiwiZ2V0QXR0cmlidXRlIiwiaGlkZUJvYXJkIiwic2hvd01vZGFsIiwicXVlcnlTZWxlY3RvckFsbCIsImluaXRwbGF5QnRuIiwiUE9uZSIsIlBUd28iLCJkaWFsb2ciLCJwbGF5V2luZG93IiwicmVuZGVyUGxheUJkIiwiY2xvc2UiLCJhdXRvQXRrIiwiY3VyckJvYXJkIiwiaW5pdFNxckJ0biIsImJvYXJkTGlzdCIsInBsYXlPbmUiLCJwbGF5VHdvIiwiY29udCIsImdhbWVNb2RlIiwicHZwQnRuIiwicHZjQnRuIiwicGxheWVyT25lIiwicGxheWVyVHdvIl0sInNvdXJjZVJvb3QiOiIifQ==